Ext.onReady(function(){function V(){C.removeAll();for(var a=v.getCount(),d=[],b=[],c=[],e=[],f=[],g=[],m=[],u=[],k=0;k<=a-1;k++){var l=v.data.items[k].data.either,G=Q.getAt(Q.find("either_type_id",l)).data.either_type;d.push(l);b.push(G);l=v.data.items[k].data.dataindex;e.push(v.data.items[k].data.filter_field);c.push(l);l=v.data.items[k].data.filter_type;G=R.getAt(R.find("math_type_id",l)).data.math_type;f.push(l);g.push(G);m.push(v.data.items[k].data.contents);u.push(v.data.items[k].data.sort_flag)}for(k=
0;k<=a-1;k++){var G=l=" ",r=countInArray(e[k],e);if(1<r){if(k==a-1||c[k]!=c[k+1]){for(r=k-r+1;r<=k;r++){if(11<=fun_gridcolumnindex(c[k],h)){if(isNaN(m[k])){Ext.Msg.alert("\u9519\u8bef","\u8bf7\u8f93\u5165\u6570\u5b57!");break}l=l+d[r]+" "+c[r]+" "+f[r]+" "+m[r]+" "}else l="\u5305\u542b"==g[k]||"\u4e0d\u5305\u542b"==g[k]?l+d[r]+" "+c[r]+" "+f[r]+" '%"+m[r]+"%' ":"\u5f00\u5934\u662f"==g[k]||"\u5f00\u5934\u4e0d\u662f"==g[k]?l+d[r]+" "+c[r]+" "+f[r].substring(1,f[r].length)+" '"+m[r]+"%' ":"\u7ed3\u5c3e\u662f"==
g[k]||"\u7ed3\u5c3e\u4e0d\u662f"==g[k]?l+d[r]+" "+c[r]+" "+f[r].substring(1,f[r].length)+" '%"+m[r]+"' ":l+d[r]+" "+c[r]+" "+f[r]+" '"+m[r]+"' ";G=G+b[r]+e[r]+g[r]+"'"+m[r]+"'"}for(var l=l.substring(4,l.length),G=G.substring(2,G.length),r=C.getCount(),L=0;L<=r-1;L++)C.getAt(L).get("sort_flag")==u[k]&&C.removeAt(L);l=new Ext.data.Record({filter_field:e[k],CH_conditions:G,EN_conditions:l,sort_flag:u[k]});S.stopEditing();C.insert(r,l);S.startEditing(0,1);C.commitChanges();C.sort("sort_flag","ASC")}}else{if(11<=
fun_gridcolumnindex(c[k],h)){if(isNaN(m[k])){Ext.Msg.alert("\u9519\u8bef","\u8bf7\u8f93\u5165\u6570\u5b57!");break}l=c[k]+" "+f[k]+" "+m[k]}else l="\u5305\u542b"==g[k]||"\u4e0d\u5305\u542b"==g[k]?c[k]+" "+f[k]+" '%"+m[k]+"%' ":"\u5f00\u5934\u662f"==g[k]||"\u5f00\u5934\u4e0d\u662f"==g[k]?c[k]+" "+f[k].substring(1,f[k].length)+" '"+m[k]+"%' ":"\u7ed3\u5c3e\u662f"==g[k]||"\u7ed3\u5c3e\u4e0d\u662f"==g[k]?c[k]+" "+f[k].substring(1,f[k].length)+" '%"+m[k]+"' ":c[k]+" "+f[k]+" '"+m[k]+"' ";G=e[k]+g[k]+"'"+
m[k]+"'";r=C.getCount();for(L=0;L<=r-1;L++)C.getAt(L).get("sort_flag")==u[k]&&C.removeAt(L);l=new Ext.data.Record({filter_field:e[k],CH_conditions:G,EN_conditions:l,sort_flag:u[k]});S.stopEditing();C.insert(r,l);S.startEditing(0,1);C.commitChanges();C.sort("sort_flag","ASC")}}}function Ta(){var a=I.getCount();if(0!=a){for(var d=" ",b=0;b<=a-1;b++){var c=I.data.items[b].data,e=c.new_field,c=c.EN_formula,d=b==a-1?d+"("+c+") as "+e+"":d+"("+c+") as "+e+", ";fun_gridfieldname_exists(trim(e),h)||h.addColumn(eval("("+
("{header:'"+e+"',align:'right',width: 100,xtype:'numbercolumn',format : '0,00.00',sortable:false,hideable:false,dataIndex:'"+e+"'}")+")"))}B=d;grid_store_reload(M,F,O,"moh",z+"@"+A+"@"+w+"@"+x+"@"+B,q)}else Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u65b0\u589e\u7684\u5b57\u6bb5!")}function Ua(a,d,b,c){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel_store")&&Ext.getCmp("large_summary_panel_showresult_gridpanel_store").remove();void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")&&
Ext.getCmp("large_summary_panel_showresult_gridpanel").destroy();void 0!=Ext.getCmp("GroupBy_PagingToolbar")&&Ext.getCmp("GroupBy_PagingToolbar").destroy();void 0!=Ext.getCmp("summary_rightMenu")&&Ext.getCmp("summary_rightMenu").destroy();var e=new Ext.data.Store({id:"large_summary_panel_showresult_gridpanel_store",autoLoad:{params:{start:0,limit:b}},reader:new Ext.data.JsonReader,proxy:new Ext.data.HttpProxy({url:"GetAllGridstoreGroupByPage"})});e.on("beforeload",function(d,b){Ext.apply(b.params,
{sql:c,dbname:a,rights:q})});b=new Ext.PagingToolbar({id:"GroupBy_PagingToolbar",store:e,pageSize:b,displayInfo:!0,displayMsg:"\u7b2c{0}\u6761-{1}\u6761\uff0c\u4e00\u5171{2}\u6761",onFirstLayout:function(){this.dsLoaded&&this.onLoad.apply(this,this.dsLoaded);this.rendered&&this.refresh&&this.refresh.hide()}});var f=new Ext.grid.GridPanel({id:"large_summary_panel_showresult_gridpanel",autoScroll:!0,border:!0,bbar:b,loadMask:!0,stripeRows:!0,containerScroll:!0,trackMouseOver:!0,cm:new Ext.grid.ColumnModel(eval("("+
d+")")),store:e});Ext.getCmp("dynamic_panel").add(f);Ext.getCmp("dynamic_panel").doLayout();var g=new Ext.menu.Menu({id:"summary_rightMenu",items:[{text:"\u5355\u5143\u683c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"cellcopy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",handler:function(){la(f,"summary_copybutton")}},"-",{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"copy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",
handler:function(){ma(f,"summary_copybutton")}},{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236(\u5305\u62ec\u8868\u5934)\u5185\u5bb9",iconCls:"copy_header",handler:function(){na(f,"summary_copybutton")}}]});f.addListener("rowcontextmenu",function(a,d,c){c.preventDefault();g.showAt(c.getXY())});f.addListener("cellcontextmenu",function(a,d,c,b){columnindex=c})}function oa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u67f1\u5f62\u56fe",
"column2d"],["\u4e09\u7ef4\u67f1\u5f62\u56fe","column3d"],["\u4e8c\u7ef4\u5e15\u7d2f\u6258\u67f1\u5f62\u56fe","pareto2d"],["\u4e09\u7ef4\u5e15\u7d2f\u6258\u67f1\u5f62\u56fe","pareto3d"]]}),c=new Ext.data.SimpleStore({id:"singlebarchart_haxis_store",fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({id:"singlebarchart_vaxis_store",fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlebarchart_form",labelAlign:"right",
border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlebarchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlebarchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",
typeAhead:!0,triggerAction:"all",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlebarchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,
d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebarchart_vaxis",editable:!0,store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",
collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlebarchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlebarchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singlebarchart_vaxisname"}]}]})}function Va(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type",
"fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u67f1\u5f62\u56fe","mscolumn2d"],["\u4e09\u7ef4\u67f1\u5f62\u56fe","mscolumn3d"],["\u4e8c\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe","stackedcolumn2d"],["\u4e09\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe","stackedcolumn3d"],["\u4e8c\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)","stackedcolumn2d@1"],["\u4e09\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)","stackedcolumn3d@1"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),
e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multibarchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multibarchart_majortitle"},
{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,listWidth:150,id:"multibarchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all",listeners:{select:function(a,d,c){},afterRender:function(a,d,c){}}},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multibarchart_haxis",store:c,mode:"local",
emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multibarchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",
displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multibarchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",
id:"multibarchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multibarchart_vaxisname"}]}]})}function pa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u6761\u5f62\u56fe","bar2d"],["\u4e09\u7ef4\u6761\u5f62\u56fe","bar3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,
data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlecolumnchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",
id:"singlecolumnchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlecolumnchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlecolumnchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",
typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlecolumnchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,
lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlecolumnchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlecolumnchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},
{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singlecolumnchart_vaxisname"}]}]})}function Wa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u6761\u5f62\u56fe","msbar2d"],["\u4e09\u7ef4\u6761\u5f62\u56fe","msbar3d"],["\u4e8c\u7ef4\u5806\u79ef\u6761\u5f62\u56fe","stackedbar2d"],["\u4e09\u7ef4\u5806\u79ef\u6761\u5f62\u56fe","stackedbar3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name",
"category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multicolumnchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",
id:"multicolumnchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"multicolumnchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all",listeners:{select:function(a,d,c){},afterRender:function(a,d,c){}}},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multicolumnchart_haxis",
store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multicolumnchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,
triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multicolumnchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",
id:"multicolumnchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multicolumnchart_vaxisname"}]}]})}function qa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6298\u7ebf\u56fe","line"],["\u5e73\u6ed1\u6298\u7ebf\u56fe","spline"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),
e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlelinechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlelinechart_majortitle"},
{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlelinechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlelinechart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,
triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlelinechart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,
resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlelinechart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlelinechart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},
{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singlelinechart_vaxisname"}]}]})}function Xa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6298\u7ebf\u56fe","msline"],["\u5e73\u6ed1\u6298\u7ebf\u56fe","msspline"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});
new Ext.FormPanel({labelWidth:55,id:"multilinechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multilinechart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,
id:"multilinechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multilinechart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",
forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multilinechart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,
d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multilinechart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"multilinechart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",
id:"multilinechart_vaxisname"}]}]})}function ra(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u9762\u79ef\u56fe","area2d"],["\u5e73\u6ed1\u9762\u79ef\u56fe","splinearea"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singleareachart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",
forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singleareachart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singleareachart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",
valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singleareachart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},
{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singleareachart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,
defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singleareachart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singleareachart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singleareachart_vaxisname"}]}]})}function Ya(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type",
"fusion_chart_type_id"],autoLoad:!0,data:[["\u9762\u79ef\u56fe","MSArea"],["\u5e73\u6ed1\u9762\u79ef\u56fe","mssplinearea"],["\u5806\u79ef\u9762\u79ef\u56fe","stackedarea2d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multiareachart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",
items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multiareachart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"multiareachart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",
forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multiareachart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",
fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multiareachart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},
defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multiareachart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"multiareachart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multiareachart_vaxisname"}]}]})}function sa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,
data:[["\u4e8c\u7ef4\u997c\u56fe","pie2d"],["\u4e09\u7ef4\u997c\u56fe","pie3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlepiechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",
autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlepiechart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlepiechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},
{xtype:"combo",fieldLabel:"\u6807\u7b7e",selectOnFocus:!0,id:"singlepiechart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlepiechart_vaxis",store:e,mode:"local",
emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",
id:"singlepiechart_subtitle"}]}]})}function ta(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6563\u70b9\u56fe","scatter"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlescatterchart_form",
labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlescatterchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlescatterchart_charttype",store:b,mode:"local",
emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6807\u7b7e",selectOnFocus:!0,id:"singlescatterchart_label",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,
e,u){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"X\u6307\u6807\u9879",selectOnFocus:!0,id:"singlescatterchart_haxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165X\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,u){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}},{xtype:"combo",fieldLabel:"Y\u6307\u6807\u9879",
selectOnFocus:!0,id:"singlescatterchart_vaxis",store:f,mode:"local",emptyText:"\u8bf7\u8f93\u5165Y\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,e){f.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",
items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlescatterchart_subtitle"},{fieldLabel:"X\u8f74\u540d\u79f0",id:"singlescatterchart_haxisname",emptyText:"\u8bf7\u8f93\u5165X\u8f74\u540d\u79f0"},{fieldLabel:"Y\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165Y\u8f74\u540d\u79f0",id:"singlescatterchart_vaxisname"}]}]})}function ua(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u5706\u73af\u56fe",
"doughnut2d"],["\u4e09\u7ef4\u5706\u73af\u56fe","doughnut3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singledoughnutchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,
defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singledoughnutchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singledoughnutchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},
{xtype:"combo",fieldLabel:"\u6807\u7b7e",selectOnFocus:!0,id:"singledoughnutchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singledoughnutchart_vaxis",
store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",
emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singledoughnutchart_subtitle"}]}]})}function va(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6c14\u6ce1\u56fe","bubble"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]}),
g=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlebubblechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlebubblechart_majortitle"},
{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlebubblechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_label",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u9879",typeAhead:!0,
triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,k){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"X\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_haxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165X\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,
resizable:!0,listeners:{afterRender:function(c,b,k){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}},{xtype:"combo",fieldLabel:"Y\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_vaxis",store:f,mode:"local",emptyText:"\u8bf7\u8f93\u5165Y\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,e){f.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}},
{xtype:"combo",fieldLabel:"Z\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_zaxis",store:g,mode:"local",emptyText:"\u8bf7\u8f93\u5165Z\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,e){g.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,
defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlebubblechart_subtitle"},{fieldLabel:"X\u8f74\u540d\u79f0",id:"singlebubblechart_haxisname",emptyText:"\u8bf7\u8f93\u5165X\u8f74\u540d\u79f0"},{fieldLabel:"Y\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165Y\u8f74\u540d\u79f0",id:"singlebubblechart_vaxisname"}]}]})}function wa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],
autoLoad:!0,data:[["\u96f7\u8fbe\u56fe","radar"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multiradarchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},
defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multiradarchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"multiradarchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all",listeners:{select:function(a,
d,c){},afterRender:function(a,d,c){}}},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multiradarchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,
id:"multiradarchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",
emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multiradarchart_subtitle"}]}]})}function xa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["2D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09","mscombi2d"],["3D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09","mscombi3d"],["2D\u5806\u79ef\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09",
"stackedcolumn2dline"],["3D\u5806\u79ef\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09","stackedcolumn3dline"]]}),c=new Ext.data.SimpleStore({id:"singlecombinedchart_haxis_store",fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({id:"singlecombinedchart_vaxis_store",fields:["value_name","value_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({id:"singlecombinedchart_vtyle_store",fields:["charttype_name","charttype_id"],
autoLoad:!0,data:[]}),g=new Ext.data.SimpleStore({id:"singlecombinedchart_showlabel_store",fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlecombinedchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",
width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlecombinedchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",listWidth:240,selectOnFocus:!0,id:"singlecombinedchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",typeAhead:!0,triggerAction:"all",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlecombinedchart_haxis",
store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,k){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlecombinedchart_vaxis",editable:!0,store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",
typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,k){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))},blur:function(a,d,c){Ext.getCmp("singlecombinedchart_vtyle").reset();Ext.getCmp("singlecombinedchart_showlabel").reset();c=this.getValue();var b=this.getRawValue();d=a="";if(0>b.indexOf(","))a=a+"['"+b+"-\u7ebf\u5f62\u56fe','"+c+"-line'],['"+b+"-\u9762\u79ef\u56fe','"+c+"-area']",
0<trim(a).length&&(a="["+a+"]",f.loadData(eval(a)),d="["+("['"+b+"','"+c+"']")+"]",g.loadData(eval(d)));else{c=c.split(",");for(var b=b.split(","),e=0;e<b.length;e++)a=a+"['"+trim(b[e])+"-\u7ebf\u5f62\u56fe','"+trim(c[e])+"-line'],",a=a+"['"+trim(b[e])+"-\u9762\u79ef\u56fe','"+trim(c[e])+"-area'],",d=d+"['"+trim(b[e])+"','"+trim(c[e])+"'],";0<trim(a).length&&(a=a.substring(0,a.length-1),a="["+a+"]",f.loadData(eval(a)),d=d.substring(0,d.length-1),d="["+d+"]",g.loadData(eval(d)))}}}},{xtype:"multiSelect",
fieldLabel:"\u6307\u6807\u56fe\u5f62",selectOnFocus:!0,id:"singlecombinedchart_vtyle",store:f,mode:"local",emptyText:"\u9ed8\u8ba4\u67f1\u5f62\u56fe",typeAhead:!0,triggerAction:"all",displayField:"charttype_name",valueField:"charttype_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{blur:function(a,d,c){a=this.getRawValue().split(",");d=Ext.getCmp("singlecombinedchart_vaxis").getRawValue();if(0<=d.indexOf(","))for(d=d.split(/[,-]/),c=0;c<d.length;c++)if(1<countInArray_adv(trim(d[c]),a)){Ext.Msg.alert("\u9519\u8bef",
"\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!");T=1;break}else T=0;else 1<countInArray_adv(d,a)?(Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!"),T=1):T=0}}},{xtype:"multiSelect",fieldLabel:"\u663e\u793a\u503c",selectOnFocus:!0,id:"singlecombinedchart_showlabel",editable:!0,store:g,mode:"local",emptyText:"\u9ed8\u8ba4\u4e0d\u663e\u793a",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",
forceSelection:!0,lazyRender:!0,resizable:!0}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlecombinedchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlecombinedchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",
id:"singlecombinedchart_vaxisname"}]}]})}function Za(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["2D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74\uff09","mscombidy2d"],["3D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74\uff09","mscolumn3dlinedy"],["3D\u5806\u79ef\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74\uff09","stackedcolumn3dlinedy"]]}),
c=new Ext.data.SimpleStore({id:"multicombinedchart_haxis_store",fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({id:"multicombinedchart_vaxis_store",fields:["value_name","value_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({id:"multicombinedchart_vtyle_store",fields:["charttype_name","charttype_id"],autoLoad:!0,data:[]}),g=new Ext.data.SimpleStore({id:"multicombinedchart_showlabel_store",fields:["value_name","value_id"],autoLoad:!0,data:[]}),m=new Ext.data.SimpleStore({id:"multicombinedchart_secondaxis_store",
fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multicombinedchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multicombinedchart_majortitle"},{xtype:"combo",
fieldLabel:"\u56fe\u8868\u7c7b\u578b",listWidth:240,selectOnFocus:!0,id:"multicombinedchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",typeAhead:!0,triggerAction:"all",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multicombinedchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,
triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,m){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multicombinedchart_vaxis",editable:!0,store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,
lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,m){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))},blur:function(a,d,c){Ext.getCmp("multicombinedchart_vtyle").reset();Ext.getCmp("multicombinedchart_showlabel").reset();Ext.getCmp("multicombinedchart_secondaxis").reset();var b=this.getValue(),e=this.getRawValue();c=d=a="";if(0>e.indexOf(","))a=a+"['"+e+"-\u7ebf\u5f62\u56fe','"+b+"-line'],['"+e+"-\u9762\u79ef\u56fe','"+b+"-area']",0<trim(a).length&&(a="["+a+"]",f.loadData(eval(a)),
d="["+("['"+e+"','"+b+"']")+"]",g.loadData(eval(d)),c="["+("['"+e+"','"+b+"']")+"]",m.loadData(eval(c)));else{for(var b=b.split(","),e=e.split(","),h=0;h<e.length;h++)a=a+"['"+trim(e[h])+"-\u7ebf\u5f62\u56fe','"+trim(b[h])+"-line'],",a=a+"['"+trim(e[h])+"-\u9762\u79ef\u56fe','"+trim(b[h])+"-area'],",d=d+"['"+trim(e[h])+"','"+trim(b[h])+"'],",c=c+"['"+trim(e[h])+"','"+trim(b[h])+"'],";0<trim(a).length&&(a=a.substring(0,a.length-1),a="["+a+"]",f.loadData(eval(a)),d=d.substring(0,d.length-1),d="["+d+
"]",g.loadData(eval(d)),c=c.substring(0,c.length-1),c="["+c+"]",m.loadData(eval(c)))}}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u56fe\u5f62",selectOnFocus:!0,id:"multicombinedchart_vtyle",store:f,mode:"local",emptyText:"\u9ed8\u8ba4\u67f1\u5f62\u56fe",typeAhead:!0,triggerAction:"all",displayField:"charttype_name",valueField:"charttype_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{blur:function(a,d,c){a=this.getRawValue().split(",");d=Ext.getCmp("multicombinedchart_vaxis").getRawValue();
if(0<=d.indexOf(","))for(d=d.split(/[,-]/),c=0;c<d.length;c++)if(1<countInArray_adv(trim(d[c]),a)){Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!");multi_index=1;break}else multi_index=0;else 1<countInArray_adv(d,a)?(Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!"),multi_index=1):multi_index=0}}},{xtype:"multiSelect",fieldLabel:"\u663e\u793a\u503c",selectOnFocus:!0,id:"multicombinedchart_showlabel",
editable:!0,store:g,mode:"local",emptyText:"\u9ed8\u8ba4\u4e0d\u663e\u793a",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"multiSelect",fieldLabel:"\u6b21\u8f74",selectOnFocus:!0,id:"multicombinedchart_secondaxis",editable:!0,store:m,mode:"local",emptyText:"\u81f3\u5c11\u4e00\u6839\u6b21\u8f74",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,
listeners:{blur:function(a,d,c){this.getValue()==Ext.getCmp("multicombinedchart_vaxis").getValue()&&Ext.Msg.alert("\u9519\u8bef","\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u4e3b\u8f74!")}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multicombinedchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",
id:"multicombinedchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multicombinedchart_vaxisname"}]}]})}function la(a,d){var b=a.getSelectionModel(),c=b.getCount();if(void 0==b.getSelected())Ext.Msg.alert("\u63d0\u793a","\u672a\u9009\u62e9\u4efb\u4f55\u6570\u636e!");else if(1==c){var e=b.getSelected();t=1;Ext.Ajax.request({url:"GetcopyRows",params:{rights:q},callback:function(c,
b,f){b?(t=1,c=trim(f.responseText),y=parseInt(trim(c.split("@")[0])),b=trim(c.split("@")[1]),f=parseInt(trim(c.split("@")[2])),""==b?t>y?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!"):(c=a.getColumnModel().getDataIndex(columnindex),c=e.get(c),Ext.getCmp(d).setValue(c)):(b=parseInt(trim(c.split("@")[1])),t>y?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!"):b+t>f?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!"):
(c=a.getColumnModel().getDataIndex(columnindex),c=e.get(c),Ext.getCmp(d).setValue(c)))):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else{var f="",g=b.getSelections();Ext.Ajax.request({url:"GetcopyRows",params:{rights:q},callback:function(c,b,e){if(b)if(t=g.length,c=trim(e.responseText),y=parseInt(trim(c.split("@")[0])),b=trim(c.split("@")[1]),e=parseInt(trim(c.split("@")[2])),""==b)if(t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+
y+"\u6761!");else{c=a.getColumnModel().getDataIndex(columnindex);for(b=0;b<=g.length-1;b++)f=f+g[b].get(c)+"\n";Ext.getCmp(d).setValue(f)}else if(b=parseInt(trim(c.split("@")[1])),t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else if(b+t>e)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{c=a.getColumnModel().getDataIndex(columnindex);for(b=0;b<=g.length-1;b++)f=
f+g[b].get(c)+"\n";Ext.getCmp(d).setValue(f)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}function ma(a,d){var b=a.getSelectionModel(),c=a.getColumnModel(),e=b.getCount();if(void 0==b.getSelected())Ext.Msg.alert("\u63d0\u793a","\u672a\u9009\u62e9\u4efb\u4f55\u6570\u636e!");else if(1==e)b.getSelected(),t=1,Ext.Ajax.request({url:"GetcopyRows",params:{rights:q},callback:function(a,e,f){if(e)if(t=1,a=trim(f.responseText),y=parseInt(trim(a.split("@")[0])),
e=trim(a.split("@")[1]),f=parseInt(trim(a.split("@")[2])),""==e)if(t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else{a="";e=b.getSelected();f=c.getColumnCount();for(var g=1;g<f;g++)c.isHidden(g)||(a=a+e.get(c.getDataIndex(g))+"\t");Ext.getCmp(d).setValue(a)}else if(e=parseInt(trim(a.split("@")[1])),t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else if(e+t>f)Ext.Msg.alert("\u63d0\u793a",
"\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{a="";e=b.getSelected();f=c.getColumnCount();for(g=1;g<f;g++)c.isHidden(g)||(a=a+e.get(c.getDataIndex(g))+"\t");Ext.getCmp(d).setValue(a)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}});else{var f="",g=b.getSelections();Ext.Ajax.request({url:"GetcopyRows",params:{rights:q},callback:function(a,b,e){if(b)if(t=g.length,a=trim(e.responseText),
y=parseInt(trim(a.split("@")[0])),b=trim(a.split("@")[1]),e=parseInt(trim(a.split("@")[2])),""==b)if(t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else{a=c.getColumnCount();for(b=0;b<g.length;b++){e="";for(var l=1;l<a;l++)c.isHidden(l)||(e=e+g[b].get(c.getDataIndex(l))+"\t");f=f+e+"\n"}Ext.getCmp(d).setValue(f)}else if(b=parseInt(trim(a.split("@")[1])),t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+
y+"\u6761!");else if(b+t>e)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{a=c.getColumnCount();for(b=0;b<g.length;b++){e="";for(l=1;l<a;l++)c.isHidden(l)||(e=e+g[b].get(c.getDataIndex(l))+"\t");f=f+e+"\n"}Ext.getCmp(d).setValue(f)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}function na(a,d){var b=a.getSelectionModel(),c=a.getColumnModel(),e=c.config,
f=b.getCount();if(void 0==b.getSelected())Ext.Msg.alert("\u63d0\u793a","\u672a\u9009\u62e9\u4efb\u4f55\u6570\u636e!");else if(1==f){var g="",m="",u=b.getSelected();t=1;Ext.Ajax.request({url:"GetcopyRows",params:{rights:q},callback:function(a,b,f){if(b)if(t=1,a=trim(f.responseText),y=parseInt(trim(a.split("@")[0])),b=trim(a.split("@")[1]),f=parseInt(trim(a.split("@")[2])),""==b)if(t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else{a=c.getColumnCount();
for(b=1;b<a;b++)c.isHidden(b)||(g=g+e[b].header+"\t",m=m+u.get(c.getDataIndex(b))+"\t");a=g+"\n"+m;Ext.getCmp(d).setValue(a)}else if(b=parseInt(trim(a.split("@")[1])),t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else if(b+t>f)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{a=c.getColumnCount();for(b=1;b<a;b++)c.isHidden(b)||(g=g+e[b].header+"\t",m=m+u.get(c.getDataIndex(b))+
"\t");a=g+"\n"+m;Ext.getCmp(d).setValue(a)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else{var k="",l=b.getSelections();Ext.Ajax.request({url:"GetcopyRows",params:{rights:q},callback:function(a,b,f){if(b)if(t=l.length,a=trim(f.responseText),y=parseInt(trim(a.split("@")[0])),b=trim(a.split("@")[1]),f=parseInt(trim(a.split("@")[2])),""==b)if(t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+
"\u6761!");else{a=c.getColumnCount();for(b=0;b<l.length;b++){var g="";f="";for(var m=1;m<a;m++)c.isHidden(m)||(g=g+e[m].header+"\t",f=f+l[b].get(c.getDataIndex(m))+"\t");k=k+f+"\n"}k=g+"\n"+k;Ext.getCmp(d).setValue(k)}else if(b=parseInt(trim(a.split("@")[1])),t>y)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+y+"\u6761!");else if(b+t>f)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");
else{a=c.getColumnCount();for(b=0;b<l.length;b++){f=g="";for(m=1;m<a;m++)c.isHidden(m)||(g=g+e[m].header+"\t",f=f+l[b].get(c.getDataIndex(m))+"\t");k=k+f+"\n"}k=g+"\n"+k;Ext.getCmp(d).setValue(k)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}Ext.QuickTips.init();Ext.form.Field.prototype.msgTarget="qtip";Ext.BLANK_IMAGE_URL="../EXT/extjs3.3.1/images/s.gif";var q=document.getElementById("rightspk").value,F=PAGESIZE,K,y,z=" ",A=" ",x=" ",
w=" ",B=" ",P=" ",H=" ",E=" ",N=0,p=0,T=0,t=0,$a=new Ext.data.SimpleStore({fields:["province_id"],proxy:new Ext.data.HttpProxy({url:"GetComboxSelections?id=province&rights="+q})}),fa=new Ext.data.SimpleStore({fields:["city_id"],proxy:new Ext.data.HttpProxy({url:"GetComboxSelections?id=city&rights="+q}),baseParams:{province_id:""},remoteSort:!0}),W=new Ext.data.SimpleStore({fields:["district_id"],proxy:new Ext.data.HttpProxy({url:"GetComboxSelections?id=district&rights="+q}),baseParams:{province_id:"",
city_id:""},remoteSort:!0}),ab=new Ext.data.SimpleStore({fields:["hos_level_id","hos_level"],data:[[0,"\u4e09\u7ea7"],[1,"\u4e09\u7ea7\u7532\u7b49"],[2,"\u4e09\u7ea7\u5176\u4ed6"],[3,"\u4e8c\u7ea7"],[4,"\u4e00\u7ea7"],[5,"\u672a\u8bc4"]]}),bb=new Ext.data.SimpleStore({fields:["hos_type_id","hos_type"],data:[[3,"\u7efc\u5408\u533b\u9662"],[4,"\u4e2d\u533b\u533b\u9662"],[5,"\u4e2d\u897f\u533b\u7ed3\u5408\u533b\u9662"],[6,"\u6c11\u65cf\u533b\u9662"],[8,"\u53e3\u8154\u533b\u9662"],[9,"\u773c\u79d1\u533b\u9662"],
[10,"\u8033\u9f3b\u5589\u79d1\u533b\u9662"],[11,"\u80bf\u7624\u533b\u9662"],[12,"\u5fc3\u8840\u7ba1\u75c5\u533b\u9662"],[13,"\u80f8\u79d1\u533b\u9662"],[14,"\u8840\u6db2\u75c5\u533b\u9662"],[15,"\u5987\u4ea7\uff08\u79d1\uff09\u533b\u9662"],[16,"\u513f\u7ae5\u533b\u9662"],[17,"\u7cbe\u795e\u75c5\u533b\u9662"],[18,"\u4f20\u67d3\u75c5\u533b\u9662"],[19,"\u76ae\u80a4\u75c5\u533b\u9662"],[20,"\u7ed3\u6838\u75c5\u533b\u9662"],[21,"\u9ebb\u98ce\u75c5\u533b\u9662"],[22,"\u804c\u4e1a\u75c5\u533b\u9662"],[23,
"\u9aa8\u79d1\u533b\u9662"],[24,"\u5eb7\u590d\u533b\u9662"],[25,"\u6574\u5f62\u5916\u79d1\u533b\u9662"],[26,"\u7f8e\u5bb9\u533b\u9662"],[27,"\u5176\u4ed6\u4e13\u79d1\u533b\u9662"],[28,"\u62a4\u7406\u9662"]]});new Ext.data.SimpleStore({fields:["hos_property_id","hos_property"],data:[[1,"\u516c\u7acb"],[2,"\u6c11\u8425"]]});var M=new Ext.data.Store({autoLoad:{params:{start:0,limit:F}},reader:new Ext.data.JsonReader,proxy:new Ext.data.HttpProxy({url:"GetAllGridstorePage"})});M.on("beforeload",function(a,
d){Ext.apply(d.params,{sql:z,dbname:"moh",numcolumnpoint:23,rights:q})});var ya=new Ext.grid.CheckboxSelectionModel,cb=new Ext.grid.ColumnModel(fun_grid_colModel_config("MOH",ya)),O=new Ext.PagingToolbar({store:M,pageSize:F,displayInfo:!0,displayMsg:"\u7b2c{0}\u6761\u5230{1}\u6761\uff0c\u4e00\u5171{2}\u6761",onFirstLayout:function(){this.dsLoaded&&this.onLoad.apply(this,this.dsLoaded);this.rendered&&this.refresh&&this.refresh.hide()}}),h=new Ext.grid.GridPanel({renderTo:"grid_div",id:"grid",frame:!1,
sm:ya,cm:cb,border:!0,loadMask:!0,tbar:[{xtype:"buttongroup",title:"<b>\u5feb\u901f\u7b5b\u9009</b>",columns:5,defaults:{scale:"small"},items:[{xtype:"multiSelect",width:85,listWidth:100,selectOnFocus:!0,id:"combo_province",store:$a,mode:"remote",blankText:"\u8bf7\u9009\u62e9\u7701\u4efd",emptyText:"\u9009\u62e9\u7701\u4efd",triggerAction:"all",allowBlank:!0,displayField:"province_id",valueField:"province_id",forceSelection:!1,resizable:!0,style:"margin-left : 3px",listeners:{scope:this,change:function(){province_field=
Ext.getCmp("combo_province");if(province_field.isValid()){city_field=Ext.getCmp("combo_city");city_field.clearValue();district_field=Ext.getCmp("combo_district");district_field.clearValue();var a=province_field.getValue();0<=a.length&&(Ext.getCmp("combo_province").setValue(a),fa.baseParams.province_id=a,W.baseParams.province_id=a,fa.load())}}}},{xtype:"multiSelect",width:85,blankText:"\u9009\u62e9\u5730\u7ea7\u5e02",emptyText:"\u9009\u62e9\u5730\u7ea7\u5e02",triggerAction:"all",allowBlank:!0,displayField:"city_id",
valueField:"city_id",forceSelection:!1,resizable:!0,id:"combo_city",store:fa,selectOnFocus:!0,loadText:"\u6b63\u5728\u52a0\u8f7d...",style:"margin-left : 6px",listeners:{scope:this,change:function(){city_field=Ext.getCmp("combo_city");if(city_field.isValid()){district_field=Ext.getCmp("combo_district");district_field.clearValue();var a=city_field.getValue();0<=a.length&&(Ext.getCmp("combo_city").setValue(a),W.baseParams.city_id=a,W.load())}}}},{xtype:"multiSelect",width:85,blankText:"\u9009\u62e9\u533a\u53bf\u5e02",
emptyText:"\u9009\u62e9\u533a\u53bf\u5e02",triggerAction:"all",allowBlank:!0,displayField:"district_id",valueField:"district_id",forceSelection:!1,resizable:!0,id:"combo_district",store:W,selectOnFocus:!0,loadText:"\u6b63\u5728\u52a0\u8f7d...",style:"margin-left : 9px",listeners:{}},{text:"",disabled:!0},{text:"",disabled:!0},{xtype:"multiSelect",selectOnFocus:!0,id:"hoplevel_combox",width:85,name:"hos_level",blankText:"\u8bf7\u9009\u62e9\u7b49\u7ea7",emptyText:"\u9009\u62e9\u7b49\u7ea7",allowBlank:!0,
store:ab,mode:"local",triggerAction:"all",displayField:"hos_level",valueField:"hos_level_id",forceSelection:!1,resizable:!0,style:"margin-left : 3px",listeners:{}},{xtype:"multiSelect",selectOnFocus:!0,id:"hoptype_combox",width:85,listWidth:120,name:"hos_type",blankText:"\u8bf7\u9009\u62e9\u7c7b\u578b",emptyText:"\u9009\u62e9\u7c7b\u578b",allowBlank:!0,store:bb,mode:"local",triggerAction:"all",displayField:"hos_type",valueField:"hos_type_id",forceSelection:!1,resizable:!0,style:"margin-left : 6px"},
{text:"\u641c\u7d22",width:30,id:"combox_search",iconCls:"search",style:"margin-left : 30px",handler:function(){var a=Ext.getCmp("combo_province").getRawValue(),d=Ext.getCmp("combo_city").getRawValue(),b=Ext.getCmp("combo_district").getRawValue(),c=Ext.getCmp("hoplevel_combox").getRawValue(),e=Ext.getCmp("hoptype_combox").getRawValue(),f="",g=f="",m="",u="",k="";if(""==a&&""==c&&""==e)Ext.Msg.alert("\u63d0\u793a","\u8bf7\u8f93\u5165\u6761\u4ef6!");else{if(0<=a.indexOf("(\u5168\u56fd)")||0<=d.indexOf("(\u5168\u56fd)")||
0<=b.indexOf("(\u5168\u56fd)"))m=g=f=" ";else{if(""!=a){if(0<a.indexOf(","))for(var a=a.split(","),l=0;l<=a.length-1;l++)f=l<a.length-1?f+"province = '"+a[l].replace(" ","")+"' or ":f+"province = '"+a[l].replace(" ","")+"' ";else f="province = '"+a+"' ";f=" ( "+f+" ) and "}if(""!=d){if(0<d.indexOf(","))for(a=d.split(","),l=0;l<=a.length-1;l++)g=l<a.length-1?g+"city = '"+a[l].replace(" ","")+"' or ":g+"city = '"+a[l].replace(" ","")+"' ";else g="city = '"+d+"' ";g=" ( "+g+" ) and "}if(""!=b){if(0<
b.indexOf(","))for(a=b.split(","),l=0;l<=a.length-1;l++)m=l<a.length-1?m+"district = '"+a[l].replace(" ","")+"' or ":m+"district = '"+a[l].replace(" ","")+"' ";else m="district = '"+b+"' ";m=" ( "+m+" ) and "}}if(""!=c){if(0<c.indexOf(","))for(a=c.split(","),l=0;l<=a.length-1;l++)switch(a[l].replace(" ","")){case "\u4e09\u7ea7":u+="(Grade_Level_Link = '\u4e09\u7ea7') or ";break;case "\u4e09\u7ea7\u7532\u7b49":u+="(Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u7532\u7b49') or ";break;case "\u4e09\u7ea7\u5176\u4ed6":u+=
"(Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u4e59\u3001\u4e19\u6216\u672a\u8bc4\u7b49') or ";break;case "\u4e8c\u7ea7":u+="(Grade_Level_Link = '\u4e8c\u7ea7' and Grade_Link = '\u5168\u90e8') or ";break;case "\u4e00\u7ea7":u+="(Grade_Level_Link = '\u4e00\u7ea7' and Grade_Link = '\u5168\u90e8') or ";break;case "\u672a\u8bc4":u+="(Grade_Level_Link = '\u672a\u8bc4' and Grade_Link = '\u5168\u90e8') or "}else{switch(c){case "\u4e09\u7ea7":u="Grade_Level_Link = '\u4e09\u7ea7' ";break;case "\u4e09\u7ea7\u7532\u7b49":u=
"Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u7532\u7b49' ";break;case "\u4e09\u7ea7\u5176\u4ed6":u="Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u4e59\u3001\u4e19\u6216\u672a\u8bc4\u7b49' ";break;case "\u4e8c\u7ea7":u="Grade_Level_Link = '\u4e8c\u7ea7' and Grade_Link = '\u5168\u90e8' ";break;case "\u4e00\u7ea7":u="Grade_Level_Link = '\u4e00\u7ea7' and Grade_Link = '\u5168\u90e8' ";break;case "\u672a\u8bc4":u="Grade_Level_Link = '\u672a\u8bc4' and Grade_Link = '\u5168\u90e8'"}u+=
" or "}u=" ( "+u.substring(0,u.length-3)+" ) and "}if(""!=e){if(0<e.indexOf(","))for(a=e.split(","),l=0;l<=a.length-1;l++)k=l<a.length-1?k+"Hop_Type = '"+a[l].replace(" ","")+"' or ":k+"Hop_Type = '"+a[l].replace(" ","")+"' ";else k="Hop_Type = '"+e+"' ";k=" ( "+k+" ) and "}f=f+g+m+u+k;A=f=f.substring(0,f.length-4);grid_store_reload(M,F,O,"moh",z+"@"+A+"@"+w+"@"+x+"@"+B,q)}}}]},{xtype:"buttongroup",columns:4,title:"<b>\u7b5b\u9009\u4e0e\u6392\u5e8f</b>",items:[{text:"\u6392\u5e8f",scale:"large",tooltip:"\u663e\u793a\u6392\u5e8f\u5bf9\u8bdd\u6846\uff0c\u4e00\u6b21\u6027\u6839\u636e\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u6392\u5e8f",
rowspan:2,iconCls:"large_sort",iconAlign:"left",handler:function(){var a=fun_combox_listname(h);X.loadData(eval(a));Y.show()}},{text:"\u7b5b\u9009",scale:"large",tooltip:"\u663e\u793a\u7b5b\u9009\u5bf9\u8bdd\u6846,\u5bf9\u6307\u6807\u8fdb\u884c\u81ea\u5b9a\u4e49\u7b5b\u9009",rowspan:2,iconCls:"large_filter",iconAlign:"left",handler:function(){var a=new Ext.tree.AsyncTreeNode({id:"root",expanded:!0,text:"\u6307\u6807",children:eval(fun_tree_listname(h))});za.setRootNode(a);U.show()}},{text:"\u6307\u6807\u9009\u62e9",
scale:"large",tooltip:"\u663e\u793a\u6307\u6807\u9009\u62e9\u5bf9\u8bdd\u6846,\u6709\u9009\u62e9\u6027\u7684\u663e\u793a\u6307\u6807\u5217",rowspan:2,iconCls:"large_showcolumn",iconAlign:"left",handler:function(){var a=new Ext.tree.AsyncTreeNode({id:"root",expanded:!0,text:"\u6307\u6807",children:eval(fun_tree_listname(h))});Aa.setRootNode(a);Z.show()}},{text:"\u663e\u793a\u6307\u6807",tooltip:"\u663e\u793a\u6240\u6709\u7684\u6307\u6807\u5217",iconCls:"small_showcolumn",handler:function(){for(var a=
Ext.getCmp("grid").getColumnModel().getColumnCount(),d=1;d<=a-1;d++)Ext.getCmp("grid").getColumnModel().setHidden(d,!1)}},{text:"\u53d6\u6d88\u7b5b\u9009",tooltip:"\u53d6\u6d88\u5feb\u901f\u7b5b\u9009\u548c\u7b5b\u9009\u7684\u6240\u6709\u6761\u4ef6",iconCls:"clear_filter",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u53d6\u6d88\u7b5b\u9009\u5417?",function(a){"yes"==a&&(Ext.getCmp("combo_city").reset(),Ext.getCmp("combo_province").reset(),Ext.getCmp("combo_district").reset(),
Ext.getCmp("hoptype_combox").reset(),Ext.getCmp("hoplevel_combox").reset(),w=A=z=" ",grid_store_reload(M,F,O,"moh",z+"@"+A+"@"+w+"@"+x+"@"+B,q),0<C.getCount()&&C.removeAll(),0<v.getCount()&&v.removeAll())})}}]},{xtype:"buttongroup",columns:4,title:"<b>\u56fe\u8868</b>",defaults:{scale:"small"},items:[{text:"\u67f1\u5f62\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u67f1\u5f62\u56fe",iconCls:"bar_chart",handler:function(){db.show();0==p?(Ext.getCmp("singlebarchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,
11,"\u5c0f\u4e8e"))),Ext.getCmp("singlebarchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e")))):.1==p&&(Ext.getCmp("multibarchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("multibarchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u6298\u7ebf\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u6298\u7ebf\u56fe\u548c\u5e73\u6ed1\u6298\u7ebf\u56fe",iconCls:"line_chart",handler:function(){eb.show();
2==p?(Ext.getCmp("singlelinechart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("singlelinechart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e")))):2.1==p&&(Ext.getCmp("multilinechart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("multilinechart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u997c\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u997c\u56fe",
iconCls:"pie_chart",handler:function(){fb.show();4==p&&(Ext.getCmp("singlepiechart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("singlepiechart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u7ed3\u5408\u56fe",tooltip:"\u521b\u5efa\u5355\u8f74\u6216\u4e3b\u6b21\u8f74\u7ebf\u6027\uff0c\u67f1\u5f62\uff0c\u9762\u79ef\u56fe\u7684\u7ec4\u5408",iconCls:" combined_chart",handler:function(){gb.show();9==p?(Ext.getCmp("singlecombinedchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,
11,"\u5c0f\u4e8e"))),Ext.getCmp("singlecombinedchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e")))):9.1==p&&(Ext.getCmp("multicombinedchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("multicombinedchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u6761\u5f62\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u6761\u5f62\u56fe",iconCls:"column_chart",handler:function(){hb.show();
1==p?(Ext.getCmp("singlecolumnchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("singlecolumnchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e")))):1.1==p&&(Ext.getCmp("multicolumnchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("multicolumnchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u9762\u79ef\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u9762\u79ef\u56fe\u548c\u5e73\u6ed1\u9762\u79ef\u56fe",
iconCls:"area_chart",handler:function(){ib.show();3==p?(Ext.getCmp("singleareachart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("singleareachart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e")))):3.1==p&&(Ext.getCmp("multiareachart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("multiareachart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u6563\u70b9\u56fe",
tooltip:"XY\u56fe\uff0c\u76f8\u5173\u6027\u5206\u6790\u56fe",iconCls:"scatter_chart",handler:function(){jb.show();5==p&&(Ext.getCmp("singlescatterchart_label").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("singlescatterchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))),Ext.getCmp("singlescatterchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{xtype:"splitbutton",text:"\u5176\u4ed6\u56fe\u8868",iconCls:"other_chart",
menu:[{text:"\u96f7\u8fbe\u56fe",tooltip:"\u5404\u9879\u6bd4\u7387\u5206\u6790",iconCls:"radar_chart",handler:function(){kb.show();8==p&&(Ext.getCmp("multiradarchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e"))),Ext.getCmp("multiradarchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u6c14\u6ce1\u56fe",tooltip:"\u5e02\u573a\u6f5c\u529b\u5206\u6790",iconCls:"bubble_chart",handler:function(){lb.show();7==p&&(Ext.getCmp("singlebubblechart_label").store.loadData(eval(fun_combox_adv_listname(h,
11,"\u5c0f\u4e8e"))),Ext.getCmp("singlebubblechart_haxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))),Ext.getCmp("singlebubblechart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))),Ext.getCmp("singlebubblechart_zaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}},{text:"\u5706\u73af\u56fe",tooltip:"\u5706\u73af\u56fe",iconCls:"round_chart",handler:function(){mb.show();6==p&&(Ext.getCmp("singledoughnutchart_haxis").store.loadData(eval(fun_combox_adv_listname(h,
11,"\u5c0f\u4e8e"))),Ext.getCmp("singledoughnutchart_vaxis").store.loadData(eval(fun_combox_adv_listname(h,11,"\u5927\u4e8e"))))}}]}]},{xtype:"buttongroup",columns:4,title:"<b>\u6570\u636e\u5de5\u5177\u4e0e\u5206\u6790</b>",items:[{text:"\u5206\u7c7b\u6c47\u603b",tooltip:"\u6c47\u603b\u591a\u4e2a\u76f8\u5173\u6027\u6307\u6807\u9879",scale:"large",rowspan:2,iconCls:"data_summary",iconAlign:"left",handler:function(){Ba.loadData(eval(fun_combox_adv_listname(h,11,"\u5c0f\u4e8e")));Ca.loadData(eval(fun_combox_adv_listname(h,
11,"\u5927\u4e8e")));Ext.getCmp("large_summary_panel_groupname").reset();Ext.getCmp("large_summary_panel_valuename").reset();Ext.getCmp("large_summary_panel_type").reset();E=H=P=" ";void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")&&Ext.getCmp("large_summary_panel_showresult_gridpanel").destroy();aa.show()}},{text:"\u65b0\u589e\u5217",scale:"large",tooltip:"\u81ea\u5b9a\u4e49\u6784\u5efa\u5ef6\u4f38\u5217",rowspan:2,iconCls:"add_column",iconAlign:"left",handler:function(){ba.show()}},
{text:"\u5bfc\u51fa",scale:"large",tooltip:"\u5bfc\u51faexcel",rowspan:2,iconCls:"export",iconAlign:"left",handler:function(){Ext.Ajax.request({url:"GetexportRows",params:{rights:q},callback:function(a,d,b){if(d){var c=h.store.getCount();a=trim(b.responseText);K=parseInt(trim(a.split("@")[0]));d=trim(a.split("@")[1]);b=trim(a.split("@")[2]);var e=parseInt(trim(a.split("@")[3])),f=parseInt(trim(a.split("@")[4]));""==b?c>K?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+
K+"\u6761!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(h),Ext.Ajax.request({url:"SaveExportActions",params:{rights:q,exportbutton:1,exportedrows:c},callback:function(a,d,c){}}))}):(d=parseInt(trim(a.split("@")[1])),b=parseInt(trim(a.split("@")[2])),c>K?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+K+"\u6761!"):b+1>f?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u6b21\u6570!"):
d+c>e?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u884c\u6570!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(h),Ext.Ajax.request({url:"SaveExportActions",params:{rights:q,exportbutton:1,exportedrows:c},callback:function(a,d,c){}}))}))}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}},{text:"",disabled:!0},
{text:"",disabled:!0}]},{xtype:"buttongroup",columns:2,title:"<b>\u590d\u5236</b>",items:[{xtype:"CopyButton",text:"\u590d\u5236",id:"copybutton",scale:"large",tooltip:"\u590d\u5236\u8868\u683c\u9009\u4e2d\u7684\u5355\u5143\u683c\u6216\u8005\u884c",rowspan:2,iconCls:"copy_large",iconAlign:"left"},{text:"",disabled:!0},{text:"",disabled:!0}]}],store:M,autoScroll:!0,stripeRows:!0,containerScroll:!0,trackMouseOver:!0,view:new Ext.ux.grid.BufferView({rowHeight:20,scrollDelay:!1,forceFit:!1}),bbar:O});
h.render();new Ext.Viewport({layout:"border",items:[{region:"center",layout:"fit",frame:!1,border:!1,items:[h]}]});var X=new Ext.data.SimpleStore({fields:["field","field_id"],autoLoad:!0,data:[["\u884c\u653f\u533a\u5212\u4ee3\u7801","AdminCode"],["\u7701\u4efd","Province"],["\u57ce\u5e02","City"],["\u533a\u53bf\u57ce\u5e02","District"]]}),nb=new Ext.form.ComboBox({selectOnFocus:!0,id:"editorfiled_combox",width:220,allowBlank:!1,editable:!1,store:X,mode:"local",typeAhead:!0,triggerAction:"all",displayField:"field",
valueField:"field_id",forceSelection:!0,resizable:!1}),ga=new Ext.data.SimpleStore({fields:["order_field","order_field_id"],autoLoad:!0,data:[["\u964d\u5e8f","DESC"],["\u5347\u5e8f"," ASC"]]}),ob=new Ext.form.ComboBox({selectOnFocus:!0,id:"editorfield_sort_combox",width:220,allowBlank:!1,editable:!1,store:ga,mode:"local",typeAhead:!0,triggerAction:"all",displayField:"order_field",valueField:"order_field_id",forceSelection:!0,lazyRender:!0,resizable:!1}),Da=new Ext.grid.CheckboxSelectionModel,pb=new Ext.grid.ColumnModel({defaults:{sortable:!0},
columns:[new Ext.grid.RowNumberer,Da,{header:"Column",dataIndex:"default_id",width:100,align:"center",sortable:!1,hideable:!1},{header:"\u6307\u6807\u9879",dataIndex:"find_field",width:200,align:"center",sortable:!1,hideable:!1,editor:nb,renderer:function(a,d,b){d=X.find("field_id",a);return-1!=d?X.getAt(d).data.field:a}},{header:"\u6b21\u5e8f",dataIndex:"Order_type",width:80,align:"center",sortable:!1,hideable:!1,editor:ob,renderer:function(a,d,b){d=ga.find("order_field_id",a);return-1!=d?ga.getAt(d).data.order_field:
a}}]}),Ea=new Ext.Toolbar({plain:!0,id:"large_sort_panel_bar"});Ea.add({xtype:"tbspacer"},"-",{text:"\u52a0\u5165\u6761\u4ef6",tooltip:"\u65b0\u589e\u6392\u5e8f\u6761\u4ef6",iconCls:"add",handler:function(){n.commitChanges();var a=n.getCount(),d=J.getSelectionModel(),b=0==a?new Ext.data.Record({default_id:"\u4e3b\u8981\u5173\u952e\u5b57",find_field:"\u7701\u4efd",Order_type:"\u964d\u5e8f"}):new Ext.data.Record({default_id:"\u6b21\u8981\u5173\u952e\u5b57",find_field:"\u7701\u4efd",Order_type:"\u964d\u5e8f"});
0!=d.getCount()&&(a=d.getSelected(),a=n.indexOf(a)+1);J.stopEditing();n.insert(a,b);J.startEditing(0,1);n.commitChanges()}},"-",{xtype:"tbspacer"},{text:"\u5220\u9664\u6761\u4ef6",tooltip:"\u5220\u9664\u6761\u4ef6",iconCls:"delete",handler:function(){n.commitChanges();var a=n.getCount(),d=J.getSelectionModel(),b=d.getCount();0==b?Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u6392\u5e8f\u6761\u4ef6!"):1==b?(d=d.getSelected(),b=n.indexOf(d),1<a&&0==b&&n.getAt(1).set("default_id",
"\u4e3b\u8981\u5173\u952e\u5b57"),n.remove(d)):1<b&&b!=a?(a=d.getSelections(),"\u4e3b\u8981\u5173\u952e\u5b57"==a[0].get("default_id")?(n.remove(a),n.commitChanges(),n.getAt(0).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57")):n.remove(a)):n.remove(d.getSelections());n.commitChanges()}},"-",{xtype:"tbspacer"},{iconCls:"arrow_up",text:"\u4e0a\u79fb",tooltip:"\u9009\u4e2d\u6392\u5e8f\u6761\u4ef6\u4e0a\u79fb",handler:function(){if(1<n.getCount()){var a=J.getSelectionModel(),d=a.getCount();if(!(0>=
d))if(1<d)Ext.Msg.alert("\u63d0\u793a","\u4e00\u6b21\u53ea\u80fd\u9009\u62e9\u4e00\u6761!");else{n.commitChanges();a=a.getSelected();a=n.indexOf(a);if(0==a)return!1;d=n.data.items[a].data;d=new Ext.data.Record({default_id:d.default_id,find_field:d.find_field,Order_type:d.Order_type});1==a?(n.removeAt(a),n.insert(a-1,d),J.getSelectionModel().selectRow(a-1),n.getAt(a).set("default_id","\u6b21\u8981\u5173\u952e\u5b57"),n.getAt(a-1).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57")):(n.removeAt(a),n.insert(a-
1,d),J.getSelectionModel().selectRow(a-1));n.commitChanges()}}}},{xtype:"tbspacer"},{iconCls:"arrow_down",text:"\u4e0b\u79fb",tooltip:"\u9009\u4e2d\u6392\u5e8f\u6761\u4ef6\u4e0b\u79fb",handler:function(){if(1<n.getCount()){n.commitChanges();var a=n.getCount(),d=J.getSelectionModel(),b=d.getCount();if(!(0>=b))if(1<b)Ext.Msg.alert("\u63d0\u793a","\u4e00\u6b21\u53ea\u80fd\u9009\u62e9\u4e00\u6761!");else{d=d.getSelected();d=n.indexOf(d);if(d==a-1)return!1;a=n.data.items[d].data;a=new Ext.data.Record({default_id:a.default_id,
find_field:a.find_field,Order_type:a.Order_type});0==d?(n.removeAt(d),n.insert(d+1,a),J.getSelectionModel().selectRow(d+1),n.getAt(d+1).set("default_id","\u6b21\u8981\u5173\u952e\u5b57"),n.getAt(d).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57")):(n.removeAt(d),n.insert(d+1,a),J.getSelectionModel().selectRow(d+1));n.commitChanges()}}}},"-",{xtype:"tbspacer"},"->",{text:"\u786e\u5b9a",iconCls:"accept",tooltip:"\u786e\u5b9a\u6392\u5e8f",handler:function(){n.commitChanges();var a=n.getCount(),d=[],
b=[];if(0<a){for(var c=0;c<=a-1;c++){var e=n.data.items[c].data.Order_type;d.push(n.data.items[c].data.find_field);b.push(e)}if(isRepeat(d))Ext.Msg.alert("\u9519\u8bef","\u6709\u5217\u88ab\u591a\u6b21\u6392\u5e8f\uff0c\u8bf7\u5220\u9664\u91cd\u590d\u7684\u6392\u5e8f\u6761\u4ef6\uff0c\u7136\u540e\u91cd\u8bd5!");else{e="";for(c=0;c<=a-1;c++)var f=fun_newcolumn_dataindexformula("EN_formula",d[c],"new_field",I),e=0<f.length?e+" ("+f+") ":"\u7701\u4efd"==d[c]?e+" province ":e+" "+d[c]+" ",e="\u964d\u5e8f"==
b[c]?e+" desc, ":e+b[c]+", ";x=e=" order by "+e.substring(0,e.length-2);grid_store_reload(M,F,O,"moh",z+"@"+A+"@"+w+"@"+x+"@"+B,q);Y.hide()}}else 0<x.length&&(x=" "),Y.hide()}},{xtype:"tbspacer"},{text:"\u53d6\u6d88",iconCls:"deldt",tooltip:"\u6e05\u9664\u6240\u6709\u6392\u5e8f\u6761\u4ef6",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u6e05\u7a7a\u6392\u5e8f\u6761\u4ef6?",function(a){"yes"==a&&(0<n.getCount()&&(n.removeAll(),n.commitChanges()),x=" ",Y.hide())})}},
{xtype:"tbspacer"});var n=new Ext.data.Store({autoDestroy:!0,proxy:new Ext.data.HttpProxy({}),reader:new Ext.data.JsonReader({totalProperty:"totalProperty",root:"root"},[{name:"find_field"},{name:"Order_type"}])}),J=new Ext.grid.EditorGridPanel({id:"large_sort_panel",tbar:Ea,sm:Da,cm:pb,clicksToEdit:1,store:n}),Y=new Ext.Window({title:"\u6392\u5e8f",width:450,height:250,resizable:!1,collapsible:!0,closeAction:"hide",autoScroll:!0,modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[J]}),
Aa=new Ext.tree.TreePanel({id:"large_showcolumn_panel_tree",el:"large_showcolumn_panel_tree",plain:!0,baseCls:"x-plain",frame:!0,autoScroll:!0,animate:!0,enableDD:!1,containerScroll:!0,border:!1,rootVisible:!0});Ext.getCmp("large_showcolumn_panel_tree").on("click",function(a){if(a.leaf){var d=a.attributes.text;a=a.attributes.id;var b=[],c=D.getCount();if(0<c)for(var e=0;e<=c-1;e++)b.push(D.data.items[e].data.filter_field);isInArray(d,b)||(D.add(new Ext.data.Record({filter_field:d,sort_flag:a})),D.sort("sort_flag",
"ASC"),D.commitChanges())}});var D=new Ext.data.JsonStore({fields:[{name:"filter_field",mapping:"filter_field"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),Fa=new Ext.grid.CheckboxSelectionModel,qb=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,Fa,{header:"<center>\u4e3b\u8981\u6307\u6807</center>",dataIndex:"filter_field",width:160,align:"left",sortable:!1,hideable:!1},{header:"\u9690\u85cfid1",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),ha=new Ext.grid.GridPanel({cm:qb,
sm:Fa,forceFit:!0,id:ha,border:!1,store:D,viewConfig:{forceFit:!0}}),Z=new Ext.Panel({layout:"border",border:!1,items:[{title:"\u6240\u6709\u6307\u6807",region:"west",width:215,fill:!0,tbar:["->","-",{xtype:"button",text:"\u5168\u9009",iconAlign:"right",tooltip:"\u663e\u793a\u6240\u6709\u7684\u6307\u6807\u9879",iconCls:"sel_right",id:"large_showcolumn_panel_selectall",handler:function(){for(var a=Ext.getCmp("large_showcolumn_panel_tree").getRootNode().childNodes,d=[],b=[],c=0;c<=a.length-1;c++)d.push(a[c].attributes.text),
b.push(a[c].attributes.id);for(var e=[],f=D.getCount(),c=0;c<=f-1;c++)e.push(D.data.items[c].data.filter_field);for(c=0;c<=a.length-1;c++)isInArray(d[c],e)||(D.add(new Ext.data.Record({filter_field:d[c],sort_flag:b[c]})),D.sort("sort_flag","ASC"),D.commitChanges())}}],layout:"fit",split:!0,collapsible:!0,collapseMode:"mini",items:[Aa]},{title:"\u5df2\u9009\u6307\u6807",region:"center",fill:!0,layout:"fit",tbar:[{xtype:"button",text:"\u64a4\u9500",tooltip:"\u5220\u9664\u9009\u4e2d\u7684\u6307\u6807\u9879",
iconCls:"sel_left",id:"large_showcolumn_panel_removesingle",handler:function(){var a=ha.getSelectionModel(),d=a.getCount();0<d?(a=1==d?a.getSelected():a.getSelections(),D.remove(a),D.commitChanges(),D.sort("sort_flag","ASC")):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u9009\u62e9\u4e0d\u663e\u793a\u7684\u6307\u6807\uff01")}},"-","->","-",{xtype:"button",text:"\u786e\u5b9a",tooltip:"\u786e\u5b9a",iconCls:"accept",id:"large_showcolumn_panel_submit",handler:function(){var a=D.getCount();if(0<a){for(var d=
Ext.getCmp("grid").getColumnModel().getColumnCount(),b=1;b<=d-1;b++)Ext.getCmp("grid").getColumnModel().setHidden(b,!0);for(d=0;d<=a-1;d++)b=fun_gridcolumnindex(D.data.items[d].data.filter_field,h),Ext.getCmp("grid").getColumnModel().setHidden(b,!1);Z.hide()}else Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u9700\u8981\u663e\u793a\u7684\u5217!")}}],items:[ha]}]}),Z=new Ext.Window({title:"\u6307\u6807\u9009\u62e9",width:460,height:350,resizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},
fill:!0,layout:"fit",items:[Z]}),za=new Ext.tree.TreePanel({id:"large_filter_panel_tree",el:"large_filter_panel_tree",plain:!0,baseCls:"x-plain",frame:!0,autoScroll:!0,animate:!0,enableDD:!1,containerScroll:!0,border:!1,rootVisible:!0});Ext.getCmp("large_filter_panel_tree").on("click",function(a){if(a.leaf){var d=a.attributes.text,b=a.attributes.id,c=a.attributes.name;a=v.getCount();d=new Ext.data.Record({either:"and",filter_field:d,filter_type:"=",contents:"",dataindex:c,sort_flag:b});ca.stopEditing();
v.insert(a,d);ca.startEditing(0,1);v.commitChanges();v.sort("sort_flag","ASC")}});var Q=new Ext.data.SimpleStore({fields:["either_type","either_type_id"],autoLoad:!0,data:[["\u548c","and"],["\u6216"," or"]]}),rb=new Ext.form.ComboBox({selectOnFocus:!0,id:"either_combox",width:80,listWidth:50,allowBlank:!1,editable:!1,store:Q,mode:"local",typeAhead:!0,triggerAction:"all",displayField:"either_type",valueField:"either_type_id",forceSelection:!0,resizable:!1}),R=new Ext.data.SimpleStore({fields:["math_type",
"math_type_id"],autoLoad:!0,data:[["\u5927\u4e8e",">"],["\u5927\u4e8e\u7b49\u4e8e",">="],["\u7b49\u4e8e","="],["\u4e0d\u7b49\u4e8e","<>"],["\u5c0f\u4e8e","<"],["\u5c0f\u4e8e\u7b49\u4e8e","<="],["\u5305\u542b","like"],["\u4e0d\u5305\u542b","not like"],["\u5f00\u5934\u662f","#like"],["\u5f00\u5934\u4e0d\u662f","#not like"],["\u7ed3\u5c3e\u662f","@like"],["\u7ed3\u5c3e\u4e0d\u662f","@not like"]]}),sb=new Ext.form.ComboBox({selectOnFocus:!0,id:"filtertype_combox",width:80,allowBlank:!1,editable:!1,store:R,
mode:"local",typeAhead:!0,triggerAction:"all",displayField:"math_type",valueField:"math_type_id",forceSelection:!0,resizable:!1}),tb=new Ext.form.TextField({allowBlank:!1,id:"contents_name"}),v=new Ext.data.JsonStore({fields:[{name:"either",mapping:"either"},{name:"filter_field",mapping:"filter_field"},{name:"filter_type",mapping:"filter_type"},{name:"contents",mapping:"contents"},{name:"dataindex",mapping:"dataindex"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),ub=new Ext.grid.CheckboxSelectionModel,
vb=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,{header:"\u548c/\u6216",dataIndex:"either",width:50,align:"center",sortable:!1,hideable:!1,editor:rb,renderer:function(a,d,b){d=Q.find("either_type_id",a);return-1!=d?Q.getAt(d).data.either_type:a}},{header:"\u4e3b\u8981\u6307\u6807",dataIndex:"filter_field",width:110,align:"center",sortable:!1,hideable:!1},{header:"\u6761\u4ef6\u7b26\u53f7",dataIndex:"filter_type",width:60,align:"center",sortable:!1,hideable:!1,editor:sb,renderer:function(a,
d,b){d=R.find("math_type_id",a);return-1!=d?R.getAt(d).data.math_type:a}},{header:"<center>\u8f93\u5165\u5185\u5bb9</center>",dataIndex:"contents",width:100,align:"right",sortable:!1,hideable:!1,editor:tb,renderer:function(a,d,b){return isNaN(a)?a:Ext.util.Format.number(a,"0,000.0")}},{header:"\u9690\u85cfdataindex",dataIndex:"dataindex",hidden:!0,hideable:!1},{header:"\u9690\u85cfsortid",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),ca=new Ext.grid.EditorGridPanel({cm:vb,sm:ub,id:"large_filter_panel_gridpanel",
border:!1,clicksToEdit:1,store:v,autoExpandColumn:4,viewConfig:{forceFit:!1}});Ext.getCmp("large_filter_panel_gridpanel").on("afteredit",function(a){V()});var C=new Ext.data.JsonStore({fields:[{name:"filter_field",mapping:"filter_field"},{name:"CH_conditions",mapping:"CH_conditions"},{name:"EN_conditions",mapping:"EN_conditions"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),wb=new Ext.grid.CheckboxSelectionModel,xb=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,{header:"\u5217\u540d",
dataIndex:"filter_field",hidden:!0,hideable:!1},{header:"<center>\u8bbe\u7f6e\u7684\u6761\u4ef6</center>",dataIndex:"CH_conditions",width:100,align:"left",sortable:!1,hideable:!1},{header:"\u9690\u85cf\u6761\u4ef6",width:100,dataIndex:"EN_conditions",align:"left",sortable:!1,hideable:!1,hidden:!0},{header:"\u9690\u85cfsortid",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),S=new Ext.grid.EditorGridPanel({cm:xb,sm:wb,id:"large_filter_panel_onlyread_gridpanel",border:!1,clicksToEdit:1,store:C,viewConfig:{forceFit:!0}}),
yb=new Ext.Panel({title:"\u5df2\u7ecf\u8bbe\u7f6e\u7684\u6761\u4ef6",border:!1,layout:"fit",items:[S]}),U=new Ext.Panel({layout:"border",border:!1,items:[{title:"\u6240\u6709\u6307\u6807",region:"west",width:180,fill:!0,layout:"fit",split:!0,collapsible:!0,collapseMode:"mini",items:[za]},{title:"\u81ea\u5b9a\u4e49\u6761\u4ef6",region:"center",fill:!0,layout:"fit",tbar:[{xtype:"button",text:"\u5220\u9664",tooltip:"\u5220\u9664\u9009\u4e2d\u7684\u7b5b\u9009\u6761\u4ef6",iconCls:"sel_left",id:"large_filter_panel_removesingle",
handler:function(){var a=ca.getSelectionModel(),d=a.getCount();0<d?(a=1==d?a.getSelected():a.getSelections(),v.remove(a),V(),v.commitChanges()):Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u6761\u4ef6!")}},"-",{xtype:"button",text:"\u6e05\u7a7a",tooltip:"\u6e05\u9664\u6240\u6709\u7684\u7b5b\u9009\u6761\u4ef6",iconCls:"select_clear",id:"large_filter_panel_clear",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u6e05\u7a7a\u6761\u4ef6\u5417?",
function(a){"yes"==a&&(v.removeAll(),v.commitChanges(),C.removeAll(),C.commitChanges(),w=" ")})}},"->","-",{xtype:"button",text:"\u786e\u5b9a",tooltip:"\u7b5b\u9009",iconCls:"accept",id:"large_filter_panel_submit",handler:function(){v.commitChanges();var a=v.getCount(),d=[],b=[],c=[],e=[];if(0<a){for(var f=" ",g=0;g<=a-1;g++){var f=v.data.items[g].data.dataindex,m=v.data.items[g].data.filter_type,u=v.data.items[g].data.contents;d.push(v.data.items[g].data.either);b.push(f);c.push(m);e.push(u)}for(g=
a=0;g<=e.length-1;g++)0==e[g].replace(" ","").length&&(a+=1);if(0<a)Ext.Msg.alert("\u9519\u8bef","\u8bf7\u8f93\u5165\u6761\u4ef6\u5185\u5bb9!");else{f=" ";a=C.getCount();for(g=0;g<=a-1;g++)e=C.data.items[g].data.filter_field,d=fun_newcolumn_dataindexformula("EN_formula",e,"new_field",I),0<d.length?(b=C.data.items[g].data.EN_conditions,b=b.replace(e,"( "+d+") "),f=f+" ("+b+") and "):f=f+" ("+C.data.items[g].data.EN_conditions+") and ";w=f=f.substring(0,f.length-4);grid_store_reload(M,F,O,"moh",z+"@"+
A+"@"+w+"@"+x+"@"+B,q);U.hide()}}else w=" ",grid_store_reload(M,F,O,"moh",z+"@"+A+"@"+w+"@"+x+"@"+B,q),U.hide()}}],items:[{layout:"border",border:!1,items:[{region:"north",fill:!0,height:200,layout:"fit",split:!0,items:[ca]},{region:"center",fill:!0,layout:"fit",items:[yb]}]}]}]}),U=new Ext.Window({title:"\u7b5b\u9009",width:550,height:420,resizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[U]}),Ga=new Ext.tree.AsyncTreeNode({id:"root",expanded:!0,text:"\u6307\u6807",
children:eval(fun_tree_listname_onlyfield(h,11))}),zb=new Ext.tree.TreePanel({id:"large_newcolumn_panel_tree",el:"large_newcolumn_panel_tree",plain:!0,baseCls:"x-plain",frame:!0,autoScroll:!0,animate:!0,enableDD:!1,containerScroll:!0,border:!1,rootVisible:!0,root:Ga});Ext.getCmp("large_newcolumn_panel_tree").on("click",function(a){if(a.leaf){a=a.attributes.text;var d=Ext.getCmp("large_newcolumn_panel_textformula").getValue(),d=d.substring(0,N)+a+d.substring(N,d.length);Ext.getCmp("large_newcolumn_panel_textformula").setValue(d);
N+=a.length}});var I=new Ext.data.JsonStore({fields:[{name:"new_field",mapping:"new_field"},{name:"CH_formula",mapping:"CH_formula"},{name:"EN_formula",mapping:"EN_formula"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),Ab=new Ext.grid.CheckboxSelectionModel,Bb=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,{header:"\u65b0\u589e\u5b57\u6bb5",width:40,dataIndex:"new_field",align:"center",sortable:!1,hideable:!1},{header:"<center>\u5b57\u6bb5\u516c\u5f0f</center>",dataIndex:"CH_formula",
width:100,align:"left",sortable:!1,hideable:!1},{header:"\u9690\u85cf\u516c\u5f0f",width:100,dataIndex:"EN_formula",align:"left",sortable:!1,hideable:!1,hidden:!0},{header:"\u9690\u85cfsortid",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),da=new Ext.grid.EditorGridPanel({cm:Bb,sm:Ab,id:"large_newcolumn_panel_onlyread_gridpanel",border:!1,clicksToEdit:1,store:I,viewConfig:{forceFit:!0}}),Cb=new Ext.Panel({border:!1,layout:"fit",items:[da]}),ba=new Ext.Panel({layout:"border",border:!1,items:[{title:"\u6240\u6709\u6307\u6807",
region:"west",width:180,fill:!0,layout:"fit",split:!0,collapseMode:"mini",items:[zb]},{region:"center",fill:!0,layout:"fit",items:[{layout:"border",border:!1,items:[{region:"north",fill:!0,border:!1,height:160,layout:"fit",items:[{layout:"form",labelAlign:"top",border:!1,bbar:["->","-",{xtype:"button",text:"\u65b0\u589e",tooltip:"\u5373\u65f6\u5728\u4e3b\u8868\u4e2d\u65b0\u589e\u81ea\u5b9a\u4e49\u6307\u6807",iconCls:"add",handler:function(){var a=Ext.getCmp("large_newcolumn_panel_textname").getValue();
if("\u4e0d\u5141\u8bb8\u4e3a\u7a7a"==trim(a)||0==trim(a).length)Ext.Msg.alert("\u9519\u8bef","\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a!");else{var d=Ext.getCmp("large_newcolumn_panel_textformula").getValue(),b=d,c=d,e=d;if("\u4ec5\u9650(,+,-,*,/,)\u7b49\u56db\u5219\u8fd0\u7b97\u7b26"!=e||0!=trim(d).length){0<=e.indexOf("(")&&(e=e.replace(/\(/g," "));0<=e.indexOf(")")&&(e=e.replace(/\)/g," "));0<=e.indexOf("+")&&(e=e.replace(/\+/g," "));0<=e.indexOf("-")&&(e=e.replace(/\-/g," "));0<=e.indexOf("*")&&(e=
e.replace(/\*/g," "));0<=e.indexOf("/")&&(e=e.replace(/\//g," "));for(var f=trim(multi_trim_one(e)).split(" "),g=e=0;g<f.length;g++)!fun_gridfieldname_exists(trim(f[g]),h)&&isNaN(trim(f[g]))&&(e=1);if(1==e)Ext.Msg.alert("\u516c\u5f0f\u9519\u8bef","\u8f93\u5165\u6307\u6807\u9519\u8bef!");else{for(g=0;g<f.length;g++)fun_gridfieldname_exists(trim(f[g]),h)&&(c=c.replace(f[g],1));Ext.Ajax.request({url:"../ActionController/ExpressionJexl.jsp",params:{Exp:c},callback:function(c,e,k){if(e)if("Error"==trim(k.responseText))Ext.MessageBox.alert("\u9519\u8bef",
"\u516c\u5f0f\u6709\u9519\u8bef,\u8bf7\u68c0\u67e5!");else{for(g=0;g<f.length;g++)fun_gridfieldname_exists(trim(f[g]),h)&&(c=fun_treenodetext_dataindex(f[g],Ga),b=b.replace(f[g],"CAST("+c+" as decimal(24,2))"));e=Ext.getCmp("grid").getColumnModel().getColumnCount();c=I.getCount();e=new Ext.data.Record({new_field:a,CH_formula:d,EN_formula:b,sort_flag:e});da.stopEditing();I.insert(c,e);da.startEditing(0,1);I.commitChanges();Ext.getCmp("large_newcolumn_panel_textname").reset();Ext.getCmp("large_newcolumn_panel_textformula").reset();
Ta()}else Ext.MessageBox.alert("\u9519\u8bef","\u516c\u5f0f\u6709\u9519\u8bef,\u8bf7\u68c0\u67e5!")}})}}}}},{xtype:"button",text:"\u5220\u9664",tooltip:"\u5373\u65f6\u5728\u4e3b\u8868\u4e2d\u5220\u9664\u9009\u4e2d\u81ea\u5b9a\u4e49\u6307\u6807",iconCls:"delete",handler:function(){I.getCount();var a=da.getSelectionModel(),d=a.getCount();0==d?Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u81ea\u5b9a\u4e49\u5217!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5220\u9664\u65b0\u589e\u5217\u5417?",
function(b){if("yes"==b)if(1==d){var c=a.getSelected();I.remove(c);h.removeColumn(c.get("new_field"));for(b=0;b<=n.getCount()-1;b++){var e=n.data.items[b].data;e.find_field==c.get("new_field")&&n.removeAt(b)}0<n.getCount()&&n.getAt(0).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57");for(b=0;b<=D.getCount()-1;b++)e=D.data.items[b].data,e.filter_field==c.get("new_field")&&D.removeAt(b);for(b=0;b<=v.getCount()-1;b++)e=v.data.items[b].data,e.filter_field==c.get("new_field")&&(v.removeAt(b),V())}else if(1<
d)for(c=a.getSelections(),I.remove(c),b=0;b<=c.length-1;b++){h.removeColumn(c[b].get("new_field"));for(var f=0;f<=n.getCount()-1;f++)e=n.data.items[f].data,e.find_field==c[b].get("new_field")&&n.removeAt(f);0<n.getCount()&&n.getAt(0).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57");for(f=0;f<=D.getCount()-1;f++)e=D.data.items[f].data,e.filter_field==c[b].get("new_field")&&D.removeAt(f);for(f=0;f<=v.getCount()-1;f++)e=v.data.items[f].data,e.filter_field==c[b].get("new_field")&&(v.removeAt(f),V())}})}},
"-",{xtype:"button",text:"\u5173\u95ed",tooltip:"\u5173\u95ed\u6539\u9875\u9762",iconCls:"deldt",handler:function(){ba.hide()}}],bodyStyle:"padding:3px 0 0 3px",items:[{xtype:"textfield",allowBlank:!0,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u4ec5\u5b57\u6bcd\u6216\u6c49\u5b57",fieldLabel:"\u540d\u79f0",id:"large_newcolumn_panel_textname",anchor:"98%",listeners:{blur:function(a){0!=this.getValue().length&&(fun_gridfieldname_exists(this.getValue(),h)&&(Ext.Msg.alert("\u63d0\u793a","\u540d\u5b57\u91cd\u590d!"),
this.focus(!0)),isCHENChar(this.getValue())||(Ext.Msg.alert("\u9519\u8bef","\u8f93\u5165\u4ec5\u5b57\u6bcd\u6216\u6c49\u5b57!"),this.focus(!0)))}}},{xtype:"textfield",fieldLabel:"\u516c\u5f0f",emptyText:"\u4ec5\u9650(,+,-,*,/,)\u7b49\u56db\u5219\u8fd0\u7b97\u7b26",blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",id:"large_newcolumn_panel_textformula",anchor:"98%",listeners:{focus:function(){},keyup:function(a,d){},blur:function(){N=Ext.getDom("large_newcolumn_panel_textformula").selectionStart}}},{xtype:"buttongroup",
border:!1,width:100,defaults:{handler:function(a){var d=Ext.getCmp("large_newcolumn_panel_textformula").getValue(),d=d.substring(0,N)+a.symbol+d.substring(N,d.length);Ext.getCmp("large_newcolumn_panel_textformula").setValue(d);N+=a.symbol.length}},columns:6,items:[{text:"(",width:25,tooltip:"\u524d\u62ec\u53f7",symbol:"("},{text:")",width:25,tooltip:"\u540e\u62ec\u53f7",symbol:")",style:"margin-left : 5px;"},{text:"+",width:25,tooltip:"\u52a0",symbol:"+",style:"margin-left : 5px;"},{text:"-",width:25,
tooltip:"\u51cf",symbol:"-",style:"margin-left : 5px;"},{text:"\u00f7",width:25,tooltip:"\u9664",symbol:"/",style:"margin-left : 5px;"},{text:"*",width:25,tooltip:"\u4e58",symbol:"*",style:"margin-left : 5px;"}]}]}]},{region:"center",fill:!0,border:!1,layout:"fit",items:[Cb]}]}]}]}),ba=new Ext.Window({title:"\u65b0\u589e\u81ea\u5b9a\u4e49\u5217",width:550,height:310,resizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[ba]}),Ba=new Ext.data.SimpleStore({fields:["dataname",
"dataindex"]}),Ca=new Ext.data.SimpleStore({fields:["valuename","valueindex"]}),Db=new Ext.data.SimpleStore({fields:["typename","typeindex"],data:[["\u8ba1\u6570","count"],["\u6c42\u548c","sum"],["\u5e73\u5747\u503c","avg"],["\u6700\u5927\u503c","max"],["\u6700\u5c0f\u503c","min"]]}),aa=new Ext.FormPanel({labelAlign:"left",border:!0,frame:!1,labelWidth:75,bodyStyle:"padding:5px",bbar:[{xtype:"tbspacer"},{xtype:"splitbutton",text:"\u6392\u5e8f\u4e0e\u7b5b\u9009",iconCls:"sortandfilter",menu:[{text:"\u6392\u5e8f",
iconCls:"small_sort",tooltip:"\u663e\u793a\u6392\u5e8f\u5bf9\u8bdd\u6846\uff0c\u4e00\u6b21\u6027\u6839\u636e\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u6392\u5e8f",handler:function(){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")?(Ha.loadData(eval(fun_combox_listname(Ext.getCmp("large_summary_panel_showresult_gridpanel")))),ia.show()):Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u6570\u636e\u53ef\u6392\u5e8f!")}},"-",{text:"\u7b5b\u9009",tooltip:"\u663e\u793a\u7b5b\u9009\u5bf9\u8bdd\u6846,\u5bf9\u6307\u6807\u8fdb\u884c\u81ea\u5b9a\u4e49\u7b5b\u9009",
iconCls:"small_filter",handler:function(){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")?(ja.loadData(eval(fun_combox_listname(Ext.getCmp("large_summary_panel_showresult_gridpanel")))),ea.show()):Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u6570\u636e\u53ef\u7b5b\u9009!")}},{text:"\u53d6\u6d88\u7b5b\u9009",tooltip:"\u53d6\u6d88\u5206\u7c7b\u6c47\u603b\u7b5b\u9009\u7684\u6240\u6709\u6761\u4ef6",iconCls:"clear_filter",handler:function(){if(void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")){Ext.getCmp("large_summary_panel_filterpanel_textfield1").reset();
Ext.getCmp("large_summary_panel_filterpanel_textfield2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname1").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath1").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath2").reset();E=" ";var a=z+"@"+A+"@"+w+"@"+x+"@"+B+"@"+P+"@"+H+"@"+E;grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,F,Ext.getCmp("GroupBy_PagingToolbar"),"moh",
a,q)}}}]},"-",{xtype:"CopyButton",text:"\u590d\u5236",id:"summary_copybutton",tooltip:"\u590d\u5236",iconCls:"copy_small"},"-",{xtype:"button",text:"\u5bfc\u51fa",id:"large_summary_panel_export",tooltip:"\u5bfc\u51faexcel",iconCls:"export_small",handler:function(){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")?Ext.Ajax.request({url:"GetexportRows",params:{rights:q},callback:function(a,d,b){if(d){var c=Ext.getCmp("large_summary_panel_showresult_gridpanel").store.getCount();a=trim(b.responseText);
K=parseInt(trim(a.split("@")[0]));d=trim(a.split("@")[1]);b=trim(a.split("@")[2]);var e=parseInt(trim(a.split("@")[3])),f=parseInt(trim(a.split("@")[4]));""==b?c>K?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+K+"\u6761!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(Ext.getCmp("large_summary_panel_showresult_gridpanel")),Ext.Ajax.request({url:"SaveExportActions",params:{rights:q,exportbutton:2,
exportedrows:c},callback:function(a,c,d){}}))}):(d=parseInt(trim(a.split("@")[1])),b=parseInt(trim(a.split("@")[2])),c>K?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+K+"\u6761!"):b+1>f?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u6b21\u6570!"):d+c>=e?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u884c\u6570!"):Ext.MessageBox.confirm("\u63d0\u793a",
"\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(Ext.getCmp("large_summary_panel_showresult_gridpanel")),Ext.Ajax.request({url:"SaveExportActions",params:{rights:q,exportbutton:2,exportedrows:c},callback:function(a,c,d){}}))}))}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}):Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u6570\u636e\u53ef\u5bfc\u51fa!")}},"->","-",{xtype:"button",text:"\u786e\u5b9a",tooltip:"\u786e\u5b9a",
id:"large_summary_panel_submit",iconCls:"accept",handler:function(){Ext.getCmp("large_summary_panel_sortpanel_groupname").reset();Ext.getCmp("large_summary_panel_sortpanel_type").reset();Ext.getCmp("large_summary_panel_filterpanel_textfield1").reset();Ext.getCmp("large_summary_panel_filterpanel_textfield2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname1").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath1").reset();
Ext.getCmp("large_summary_panel_filterpanel_groupmath2").reset();E=H=" ";var a=Ext.getCmp("large_summary_panel_groupname").getValue(),d=Ext.getCmp("large_summary_panel_groupname").getRawValue(),b=Ext.getCmp("large_summary_panel_valuename").getValue(),c=Ext.getCmp("large_summary_panel_valuename").getRawValue(),e=Ext.getCmp("large_summary_panel_type").getValue(),f=Ext.getCmp("large_summary_panel_type").getRawValue(),c=replaceAll(c,"\\[\u4e07\\]",""),c=replaceAll(c,"\\[\u52a9\u7406\\]","\u542b\u52a9\u7406");
if(0==trim(a).length||0==trim(b).length||0==trim(e).length)Ext.Msg.alert("\u63d0\u793a","\u5b57\u6bb5\u4e0d\u5141\u8bb8\u4e3a\u7a7a!");else{var g="",m="";if(0<=b.indexOf(",")){for(var b=b.split(","),c=c.split(","),h=0;h<=b.length-1;h++)h==b.length-1?(m=m+e+"("+b[h]+") as "+c[h]+"_"+e,g=g+"{header: '"+c[h]+"_"+f+"',dataIndex: '"+trim(c[h])+"_"+trim(e)+"',align : 'right',width:150,xtype:'numbercolumn',format : '0,00.0',sortable: false}"):(m=m+e+"("+b[h]+") as "+c[h]+"_"+e+",",g=g+"{header: '"+c[h]+
"_"+f+"',dataIndex: '"+trim(c[h])+"_"+trim(e)+"',align : 'right',width:150,xtype:'numbercolumn',format : '0,00.0',sortable: false},");m=a+","+m}else m=a+","+e+"("+b+") as "+c+"_"+e,g="{header: '"+c+"_"+f+"',dataIndex: '"+trim(c)+"_"+trim(e)+"',width:150,align : 'right',xtype:'numbercolumn',format : '0,00.0',sortable: false}";P=m;a=0<="\u7701\u4efd".indexOf(d)?"[new Ext.grid.RowNumberer({width:30}),{header: '\u884c\u653f\u533a\u5212\u4ee3\u7801',dataIndex:'admincode_temp',width:90,sortable: false},{header: '"+
d+"',dataIndex: '"+a+"',width:100,sortable: false},"+g+"]":0<="\u5730\u7ea7\u5e02".indexOf(d)?"[new Ext.grid.RowNumberer({width:30}),{header: '\u884c\u653f\u533a\u5212\u4ee3\u7801',dataIndex:'admincode_temp',width:90,sortable: false},{header: '\u7701\u4efd',dataIndex:'province',width:90,sortable: false},{header: '"+d+"',dataIndex: '"+a+"',width:100,sortable: false},"+g+"]":0<="\u533a\u53bf\u5e02@\u533a\u53bf\u57ce\u5e02".indexOf(d)?"[new Ext.grid.RowNumberer({width:30}),{header: '\u884c\u653f\u533a\u5212\u4ee3\u7801',dataIndex:'admincode_temp',width:90,sortable: false},{header:'\u7701\u4efd',dataIndex:'province',width:90,sortable:false},{header:'\u5730\u7ea7\u5e02',dataIndex:'city',width:90,sortable:false},{header: '"+
d+"',dataIndex: '"+a+"',width:100,sortable: false},"+g+"]":"[new Ext.grid.RowNumberer({width:30}),{header: '"+d+"',dataIndex: '"+a+"',width:100,false: true},"+g+"]";Ua("moh",a,F,z+"@"+A+"@"+w+"@"+x+"@"+B+"@"+P+"@"+H+"@"+E)}}},{xtype:"button",text:"\u5168\u90e8\u5220\u9664",tooltip:"\u5220\u9664\u5206\u7c7b\u6c47\u603b\u7ed3\u679c",id:"large_summary_panel_clear",iconCls:"select_clear",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5220\u9664\u7ed3\u679c\u5417?",
function(a){"yes"==a&&(Ext.getCmp("large_summary_panel_groupname").reset(),Ext.getCmp("large_summary_panel_valuename").reset(),Ext.getCmp("large_summary_panel_type").reset(),E=H=P=" ",void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel_store")&&Ext.getCmp("large_summary_panel_showresult_gridpanel_store").remove(),void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")&&Ext.getCmp("large_summary_panel_showresult_gridpanel").destroy(),void 0!=Ext.getCmp("GroupBy_PagingToolbar")&&Ext.getCmp("GroupBy_PagingToolbar").destroy())})}},
{xtype:"button",text:"\u53d6\u6d88",tooltip:"\u5173\u95ed\u5206\u7c7b\u6c47\u603b\u9875\u9762",id:"large_summary_panel_cancel",iconCls:"deldt",handler:function(){aa.hide()}}],items:[{xtype:"combo",selectOnFocus:!0,store:Ba,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u5206\u7c7b\u5b57\u6bb5",fieldLabel:"\u5206\u7c7b\u5b57\u6bb5",id:"large_summary_panel_groupname",
anchor:"85%",listeners:{scope:this,change:function(){E=H=" "}}},{xtype:"multiSelect",selectOnFocus:!0,store:Ca,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"valuename",valueField:"valueindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u5206\u7c7b\u5b57\u6bb5",fieldLabel:"\u9009\u5b9a\u6c47\u603b\u9879",id:"large_summary_panel_valuename",anchor:"85%",listeners:{scope:this,change:function(){E=H=" "}}},{xtype:"combo",
selectOnFocus:!0,store:Db,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"typename",valueField:"typeindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6c47\u603b\u65b9\u5f0f",fieldLabel:"\u6c47\u603b\u65b9\u5f0f",id:"large_summary_panel_type",anchor:"85%",listeners:{scope:this,change:function(){E=H=" "}}}]}),Eb=new Ext.Panel({layout:"border",border:!1,items:[{region:"north",fill:!0,border:!1,height:115,layout:"fit",items:[aa]},
{region:"center",fill:!0,id:"dynamic_panel",border:!1,layout:"fit"}]}),aa=new Ext.Window({title:"\u5206\u7c7b\u6c47\u603b",width:850,height:450,resizable:!0,maximizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Eb]}),Ha=new Ext.data.SimpleStore({fields:["dataname","dataindex"]}),Fb=new Ext.data.SimpleStore({fields:["sortname","sortindex"],data:[["\u5347\u5e8f","asc"],["\u964d\u5e8f","desc"]]}),Gb=new Ext.FormPanel({labelAlign:"top",border:!0,frame:!0,
bodyStyle:"padding:5px",buttonAlign:"center",items:[{xtype:"combo",selectOnFocus:!0,store:Ha,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u6392\u5e8f\u5b57\u6bb5",fieldLabel:"\u6392\u5e8f\u5b57\u6bb5",id:"large_summary_panel_sortpanel_groupname",anchor:"95%",listeners:{}},{xtype:"combo",selectOnFocus:!0,store:Fb,mode:"local",triggerAction:"all",
allowBlank:!0,displayField:"sortname",valueField:"sortindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6392\u5e8f\u65b9\u5f0f",fieldLabel:"\u6392\u5e8f\u65b9\u5f0f",id:"large_summary_panel_sortpanel_type",anchor:"95%",listeners:{}}],buttons:[{text:"\u786e\u5b9a",tooltip:"\u786e\u5b9a\u6392\u5e8f",id:"large_summary_panel_sortpanel_submit",iconCls:"accept",handler:function(){var a=Ext.getCmp("large_summary_panel_sortpanel_groupname").getValue();
Ext.getCmp("large_summary_panel_sortpanel_groupname").getRawValue();var d=Ext.getCmp("large_summary_panel_sortpanel_type").getValue();0!=trim(a).length&&0!=trim(d).length?(H="order by "+a+" "+d,a=z+"@"+A+"@"+w+"@"+x+"@"+B+"@"+P+"@"+H+"@"+E,grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,F,Ext.getCmp("GroupBy_PagingToolbar"),"moh",a,q),Ext.getCmp("large_summary_panel_sortpanel_groupname").reset(),Ext.getCmp("large_summary_panel_sortpanel_type").reset(),ia.hide()):Ext.Msg.alert("\u63d0\u793a",
"\u8bf7\u9009\u62e9\u6392\u5e8f\u5b57\u6bb5\u6216\u8005\u6392\u5e8f\u65b9\u5f0f!")}},{text:"\u53d6\u6d88",tooltip:"\u5173\u95ed\u754c\u9762",id:"large_summary_panel_sortpanel_cancel",iconCls:"deldt",handler:function(){ia.hide()}}]}),ia=new Ext.Window({title:"\u6392\u5e8f",width:250,height:200,resizable:!1,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Gb]}),ja=new Ext.data.SimpleStore({fields:["dataname","dataindex"]}),Ia=new Ext.data.SimpleStore({fields:["mathtype",
"mathid"],data:[["\u5927\u4e8e",">"],["\u5927\u4e8e\u7b49\u4e8e",">="],["\u7b49\u4e8e","="],["\u4e0d\u7b49\u4e8e","<>"],["\u5c0f\u4e8e","<"],["\u5c0f\u4e8e\u7b49\u4e8e","<="]]}),Hb=new Ext.FormPanel({border:!0,frame:!0,bodyStyle:"padding:5px",buttonAlign:"center",items:[{layout:"column",items:[{columnWidth:.4,layout:"form",labelAlign:"top",items:[{xtype:"combo",selectOnFocus:!0,store:ja,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,
resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u7b5b\u9009\u5b57\u6bb5",fieldLabel:"\u7b5b\u9009\u5b57\u6bb51",id:"large_summary_panel_filterpanel_groupname1",width:120},{xtype:"combo",selectOnFocus:!0,store:Ia,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"mathtype",valueField:"mathid",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6761\u4ef6\u7b26\u53f7",fieldLabel:"\u6761\u4ef6\u7b26\u53f71",
id:"large_summary_panel_filterpanel_groupmath1",width:80},{xtype:"textfield",allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u8f93\u5165\u6761\u4ef6",fieldLabel:"\u7b5b\u9009\u6761\u4ef61",id:"large_summary_panel_filterpanel_textfield1",width:100}]},{columnWidth:.2,layout:"form",labelAlign:"top",style:"margin-left:15px",items:[{xtype:"radio",boxLabel:"\u548c",name:"fieldtype",id:"state",inputValue:"and"},{xtype:"radio",boxLabel:"\u6216",name:"fieldtype",inputValue:"or",checked:!0}]},
{columnWidth:.4,layout:"form",labelAlign:"top",items:[{xtype:"combo",selectOnFocus:!0,store:ja,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u7b5b\u9009\u5b57\u6bb5",fieldLabel:"\u7b5b\u9009\u5b57\u6bb52",id:"large_summary_panel_filterpanel_groupname2",width:120},{xtype:"combo",selectOnFocus:!0,store:Ia,mode:"local",triggerAction:"all",allowBlank:!0,
displayField:"mathtype",valueField:"mathid",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6761\u4ef6\u7b26\u53f7",fieldLabel:"\u6761\u4ef6\u7b26\u53f72",id:"large_summary_panel_filterpanel_groupmath2",width:80},{xtype:"textfield",allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u8f93\u5165\u6761\u4ef6",fieldLabel:"\u7b5b\u9009\u6761\u4ef62",id:"large_summary_panel_filterpanel_textfield2",width:100}]}]}],buttons:[{text:"\u786e\u5b9a",
tooltip:"\u786e\u5b9a\u7b5b\u9009",id:"large_summary_panel_filterpanel_submit",iconCls:"accept",handler:function(){var a=trim(Ext.getCmp("large_summary_panel_filterpanel_textfield1").getValue()),d=trim(Ext.getCmp("large_summary_panel_filterpanel_groupname1").getValue()),b=trim(Ext.getCmp("large_summary_panel_filterpanel_groupmath1").getValue());if(0==a.length||0==d.length||0==b)Ext.Msg.alert("\u63d0\u793a","\u8bf7\u7b5b\u9009\u6761\u4ef6\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u586b\u5199!");else{var c=
"",c=0<=d.indexOf("District")||0<=d.indexOf("City")||0<=d.indexOf("Province")?d+b+" '"+trim(a)+"' ":d+b+a,a=trim(Ext.getCmp("large_summary_panel_filterpanel_textfield2").getValue()),d=trim(Ext.getCmp("large_summary_panel_filterpanel_groupname2").getValue()),b=trim(Ext.getCmp("large_summary_panel_filterpanel_groupmath2").getValue());if(0<a.length&&0<d.length&&0<b.length){var e=Ext.getCmp("state").getGroupValue(),f="",f=0<=d.indexOf("District")||0<=d.indexOf("City")||0<=d.indexOf("Province")?d+" "+
b+" '"+a+"' ":d+" "+b+" "+a;E=c+" "+e+" "+f;c=z+"@"+A+"@"+w+"@"+x+"@"+B+"@"+P+"@"+H+"@"+E;grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,F,Ext.getCmp("GroupBy_PagingToolbar"),"moh",c,q);ea.hide()}else 0==a.length&&0==d.length&&0==b.length?(E=c,c=z+"@"+A+"@"+w+"@"+x+"@"+B+"@"+P+"@"+H+"@"+E,grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,F,Ext.getCmp("GroupBy_PagingToolbar"),"moh",c,q),ea.hide()):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u7b5b\u9009\u6761\u4ef6\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u586b\u5199!")}}},
{text:"\u53d6\u6d88",tooltip:"\u5173\u95ed\u9875\u9762",id:"large_summary_panel_filterpanel_cancel",iconCls:"deldt",handler:function(){ea.hide()}}]}),ea=new Ext.Window({title:"\u7b5b\u9009",width:360,height:230,resizable:!1,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Hb]}),Ja=new Ext.Toolbar({plain:!0,id:"barchart_tbar"});Ja.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"barchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",
tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"barchart_summit",handler:function(){if(0==p){var a=Ext.getCmp("singlebarchart_majortitle").getValue(),d=Ext.getCmp("singlebarchart_charttype").getValue(),b=Ext.getCmp("singlebarchart_charttype").getRawValue(),c=Ext.getCmp("singlebarchart_haxis").getValue();Ext.getCmp("singlebarchart_haxis").getRawValue();var e=Ext.getCmp("singlebarchart_vaxis").getValue(),f=Ext.getCmp("singlebarchart_vaxis").getRawValue(),g=Ext.getCmp("singlebarchart_subtitle").getValue(),
m=Ext.getCmp("singlebarchart_haxisname").getValue(),h=Ext.getCmp("singlebarchart_vaxisname").getValue(),k=0,l=Ext.getCmp("barchart_label").getValue(),k=l?1:0;0==trim(d).length||0==trim(c).length||0==trim(e).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(l=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:l,haxis:c,vaxis:e,dbname:"moh",rights:q},callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("barchartContainer",
d,0,a,g,m,h,k,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else.1==p?(a=Ext.getCmp("multibarchart_majortitle").getValue(),d=Ext.getCmp("multibarchart_charttype").getValue(),b=Ext.getCmp("multibarchart_charttype").getRawValue(),c=Ext.getCmp("multibarchart_haxis").getValue(),Ext.getCmp("multibarchart_haxis").getRawValue(),e=Ext.getCmp("multibarchart_vaxis").getValue(),f=Ext.getCmp("multibarchart_vaxis").getRawValue(),g=Ext.getCmp("multibarchart_subtitle").getValue(),
m=Ext.getCmp("multibarchart_haxisname").getValue(),h=Ext.getCmp("multibarchart_vaxisname").getValue(),k=0,k=(l=Ext.getCmp("barchart_label").getValue())?1:0,0==trim(d).length||0==trim(c).length||0==trim(e).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(l=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:l,haxis:c,vaxis:e,dbname:"moh",rights:q},callback:function(c,l,n){if(l){c=trim(n.responseText);if(0<=
f.indexOf(",")){l=f.split(",");n=e.split(",");for(var p=0;p<=l.length-1;p++)c=c.replace(trim(n[p]),trim(l[p]))}else c=c.replace(e,f);"\u4e09\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)"==b||"\u4e8c\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)"==b?renderCharts("barchartContainer",d,1.1,a,g,m,h,k,c):renderCharts("barchartContainer",d,1,a,g,m,h,k,c)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Ib=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlebarchart_accordingpanel",bbar:Ja,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u67f1\u5f62\u8868",autoScroll:!0,border:!1,forceFit:!0,id:"singlebarchart_panel",iconCls:"chart_bar_edit",listeners:{expand:function(a){p=0;oa(h,11);Ext.getCmp("singlebarchart_panel").remove(Ext.getCmp("singlebarchart_form"));Ext.getCmp("singlebarchart_panel").add(Ext.getCmp("singlebarchart_form"));
Ext.getCmp("singlebarchart_panel").doLayout()},afterRender:function(){p=0;oa(h,11);Ext.getCmp("singlebarchart_panel").add(Ext.getCmp("singlebarchart_form"));Ext.getCmp("singlebarchart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u67f1\u5f62\u8868",autoScroll:!0,border:!1,forceFit:!0,id:"multibarchart_panel",iconCls:"chart_bar_edit",listeners:{expand:function(a){p=.1;Va(h,11);Ext.getCmp("multibarchart_panel").remove(Ext.getCmp("multibarchart_form"));Ext.getCmp("multibarchart_panel").add(Ext.getCmp("multibarchart_form"));
Ext.getCmp("multibarchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'barchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),db=new Ext.Window({title:"\u67f1\u5f62\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Ib]}),Ka=new Ext.Toolbar({plain:!0,id:"columnchart_tbar"});Ka.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"columnchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"columnchart_summit",handler:function(){if(1==p){var a=Ext.getCmp("singlecolumnchart_majortitle").getValue(),d=Ext.getCmp("singlecolumnchart_charttype").getValue();Ext.getCmp("singlecolumnchart_charttype").getRawValue();var b=Ext.getCmp("singlecolumnchart_haxis").getValue();Ext.getCmp("singlecolumnchart_haxis").getRawValue();var c=Ext.getCmp("singlecolumnchart_vaxis").getValue(),
e=Ext.getCmp("singlecolumnchart_vaxis").getRawValue(),f=Ext.getCmp("singlecolumnchart_subtitle").getValue(),g=Ext.getCmp("singlecolumnchart_haxisname").getValue(),m=Ext.getCmp("singlecolumnchart_vaxisname").getValue(),h=0,k=Ext.getCmp("columnchart_label").getValue(),h=k?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetSingleBarChart",
params:{sql:k,haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("columnchartContainer",d,0,a,f,g,m,h,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else 1.1==p?(a=Ext.getCmp("multicolumnchart_majortitle").getValue(),d=Ext.getCmp("multicolumnchart_charttype").getValue(),Ext.getCmp("multicolumnchart_charttype").getRawValue(),b=Ext.getCmp("multicolumnchart_haxis").getValue(),Ext.getCmp("multicolumnchart_haxis").getRawValue(),
c=Ext.getCmp("multicolumnchart_vaxis").getValue(),e=Ext.getCmp("multicolumnchart_vaxis").getRawValue(),f=Ext.getCmp("multicolumnchart_subtitle").getValue(),g=Ext.getCmp("multicolumnchart_haxisname").getValue(),m=Ext.getCmp("multicolumnchart_vaxisname").getValue(),h=0,h=(k=Ext.getCmp("columnchart_label").getValue())?1:0,0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=z+"@"+A+"@"+w+
"@"+x+"@"+B,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(b,k,r){if(k){b=trim(r.responseText);if(0<=e.indexOf(",")){k=e.split(",");r=c.split(",");for(var n=0;n<=k.length-1;n++)b=b.replace(trim(r[n]),trim(k[n]))}else b=b.replace(c,e);renderCharts("columnchartContainer",d,1,a,f,g,m,h,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Jb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlecolumnchart_accordingpanel",bbar:Ka,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u6761\u5f62\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlecolumnchart_panel",iconCls:"chart_column_edit",listeners:{expand:function(a){p=1;pa(h,11);Ext.getCmp("singlecolumnchart_panel").remove(Ext.getCmp("singlecolumnchart_form"));Ext.getCmp("singlecolumnchart_panel").add(Ext.getCmp("singlecolumnchart_form"));
Ext.getCmp("singlecolumnchart_panel").doLayout()},afterRender:function(){p=1;pa(h,11);Ext.getCmp("singlecolumnchart_panel").add(Ext.getCmp("singlecolumnchart_form"));Ext.getCmp("singlecolumnchart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u6761\u5f62\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multicolumnchart_panel",iconCls:"chart_column_edit",listeners:{expand:function(a){p=1.1;Wa(h,11);Ext.getCmp("multicolumnchart_panel").remove(Ext.getCmp("multicolumnchart_form"));Ext.getCmp("multicolumnchart_panel").add(Ext.getCmp("multicolumnchart_form"));
Ext.getCmp("multicolumnchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'columnchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),hb=new Ext.Window({title:"\u6761\u5f62\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Jb]}),La=new Ext.Toolbar({plain:!0,id:"linechart_tbar"});La.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"linechart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"linechart_summit",handler:function(){if(2==p){var a=Ext.getCmp("singlelinechart_majortitle").getValue(),d=Ext.getCmp("singlelinechart_charttype").getValue();Ext.getCmp("singlelinechart_charttype").getRawValue();var b=Ext.getCmp("singlelinechart_haxis").getValue();Ext.getCmp("singlelinechart_haxis").getRawValue();var c=Ext.getCmp("singlelinechart_vaxis").getValue(),e=Ext.getCmp("singlelinechart_vaxis").getRawValue(),
f=Ext.getCmp("singlelinechart_subtitle").getValue(),g=Ext.getCmp("singlelinechart_haxisname").getValue(),h=Ext.getCmp("singlelinechart_vaxisname").getValue(),n=0,k=Ext.getCmp("linechart_label").getValue(),n=k?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"moh",rights:q},
callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("linechartContainer",d,0,a,f,g,h,n,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else 2.1==p?(a=Ext.getCmp("multilinechart_majortitle").getValue(),d=Ext.getCmp("multilinechart_charttype").getValue(),Ext.getCmp("multilinechart_charttype").getRawValue(),b=Ext.getCmp("multilinechart_haxis").getValue(),Ext.getCmp("multilinechart_haxis").getRawValue(),c=Ext.getCmp("multilinechart_vaxis").getValue(),
e=Ext.getCmp("multilinechart_vaxis").getRawValue(),f=Ext.getCmp("multilinechart_subtitle").getValue(),g=Ext.getCmp("multilinechart_haxisname").getValue(),h=Ext.getCmp("multilinechart_vaxisname").getValue(),n=0,n=(k=Ext.getCmp("linechart_label").getValue())?1:0,0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:k,
haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(b,k,p){if(k){b=trim(p.responseText);if(0<=e.indexOf(",")){k=e.split(",");p=c.split(",");for(var q=0;q<=k.length-1;q++)b=b.replace(trim(p[q]),trim(k[q]))}else b=b.replace(c,e);renderCharts("linechartContainer",d,1,a,f,g,h,n,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Kb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlelinechart_accordingpanel",bbar:La,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u6298\u7ebf\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlelinechart_panel",iconCls:"chart_line_edit",listeners:{expand:function(a){p=2;qa(h,11);Ext.getCmp("singlelinechart_panel").remove(Ext.getCmp("singlelinechart_form"));Ext.getCmp("singlelinechart_panel").add(Ext.getCmp("singlelinechart_form"));
Ext.getCmp("singlelinechart_panel").doLayout()},afterRender:function(){p=2;qa(h,11);Ext.getCmp("singlelinechart_panel").add(Ext.getCmp("singlelinechart_form"));Ext.getCmp("singlelinechart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u6298\u7ebf\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multilinechart_panel",iconCls:"chart_line_edit",listeners:{expand:function(a){p=2.1;Xa(h,11);Ext.getCmp("multilinechart_panel").remove(Ext.getCmp("multilinechart_form"));Ext.getCmp("multilinechart_panel").add(Ext.getCmp("multilinechart_form"));
Ext.getCmp("multilinechart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'linechartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),eb=new Ext.Window({title:"\u6298\u7ebf\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Kb]}),Ma=new Ext.Toolbar({plain:!0,id:"areachart_tbar"});Ma.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"areachart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"areachart_summit",handler:function(){if(3==p){var a=Ext.getCmp("singleareachart_majortitle").getValue(),d=Ext.getCmp("singleareachart_charttype").getValue();Ext.getCmp("singleareachart_charttype").getRawValue();var b=Ext.getCmp("singleareachart_haxis").getValue();Ext.getCmp("singleareachart_haxis").getRawValue();var c=Ext.getCmp("singleareachart_vaxis").getValue(),e=Ext.getCmp("singleareachart_vaxis").getRawValue(),
f=Ext.getCmp("singleareachart_subtitle").getValue(),g=Ext.getCmp("singleareachart_haxisname").getValue(),h=Ext.getCmp("singleareachart_vaxisname").getValue(),n=0,k=Ext.getCmp("areachart_label").getValue(),n=k?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"moh",rights:q},
callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("areachartContainer",d,0,a,f,g,h,n,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else 3.1==p?(a=Ext.getCmp("multiareachart_majortitle").getValue(),d=Ext.getCmp("multiareachart_charttype").getValue(),Ext.getCmp("multiareachart_charttype").getRawValue(),b=Ext.getCmp("multiareachart_haxis").getValue(),Ext.getCmp("multiareachart_haxis").getRawValue(),c=Ext.getCmp("multiareachart_vaxis").getValue(),
e=Ext.getCmp("multiareachart_vaxis").getRawValue(),f=Ext.getCmp("multiareachart_subtitle").getValue(),g=Ext.getCmp("multiareachart_haxisname").getValue(),h=Ext.getCmp("multiareachart_vaxisname").getValue(),n=0,n=(k=Ext.getCmp("areachart_label").getValue())?1:0,0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:k,
haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(b,k,p){if(k){b=trim(p.responseText);if(0<=e.indexOf(",")){k=e.split(",");p=c.split(",");for(var q=0;q<=k.length-1;q++)b=b.replace(trim(p[q]),trim(k[q]))}else b=b.replace(c,e);renderCharts("areachartContainer",d,1,a,f,g,h,n,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Lb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singleareachart_accordingpanel",bbar:Ma,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u9762\u79ef\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singleareachart_panel",iconCls:"area_chart_edit",listeners:{expand:function(a){p=3;ra(h,11);Ext.getCmp("singleareachart_panel").remove(Ext.getCmp("singleareachart_form"));Ext.getCmp("singleareachart_panel").add(Ext.getCmp("singleareachart_form"));
Ext.getCmp("singleareachart_panel").doLayout()},afterRender:function(){p=3;ra(h,11);Ext.getCmp("singleareachart_panel").add(Ext.getCmp("singleareachart_form"));Ext.getCmp("singleareachart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u9762\u79ef\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multiareachart_panel",iconCls:"area_chart_edit",listeners:{expand:function(a){p=3.1;Ya(h,11);Ext.getCmp("multiareachart_panel").remove(Ext.getCmp("multiareachart_form"));Ext.getCmp("multiareachart_panel").add(Ext.getCmp("multiareachart_form"));
Ext.getCmp("multiareachart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'areachartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),ib=new Ext.Window({title:"\u9762\u79ef\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Lb]}),Na=new Ext.Toolbar({plain:!0,id:"piechart_tbar"});Na.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"piechart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"piechart_summit",handler:function(){if(4==p){var a=Ext.getCmp("singlepiechart_majortitle").getValue(),d=Ext.getCmp("singlepiechart_charttype").getValue();Ext.getCmp("singlepiechart_charttype").getRawValue();var b=Ext.getCmp("singlepiechart_haxis").getValue();Ext.getCmp("singlepiechart_haxis").getRawValue();var c=Ext.getCmp("singlepiechart_vaxis").getValue();Ext.getCmp("singlepiechart_vaxis").getRawValue();
var e=Ext.getCmp("singlepiechart_subtitle").getValue(),f=0,f=Ext.getCmp("piechart_label").getValue()?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6807\u7b7e/\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:z+"@"+A+"@"+w+"@"+x+"@"+B,haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(c,b,h){b?(c=trim(h.responseText),renderCharts("piechartContainer",d,2.1,a,e,"","",f,c)):Ext.MessageBox.alert("\u9519\u8bef",
"\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Mb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlepiechart_accordingpanel",bbar:Na,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u997c\u56fe",autoScroll:!0,
border:!1,forceFit:!0,id:"singlepiechart_panel",iconCls:"pie_chart_edit",listeners:{expand:function(a){p=4;sa(h,11);Ext.getCmp("singlepiechart_panel").remove(Ext.getCmp("singlepiechart_form"));Ext.getCmp("singlepiechart_panel").add(Ext.getCmp("singlepiechart_form"));Ext.getCmp("singlepiechart_panel").doLayout()},afterRender:function(){p=4;sa(h,11);Ext.getCmp("singlepiechart_panel").add(Ext.getCmp("singlepiechart_form"));Ext.getCmp("singlepiechart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",
html:"<div id = 'piechartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),fb=new Ext.Window({title:"\u997c\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Mb]}),Oa=new Ext.Toolbar({plain:!0,id:"scatterchart_tbar"});Oa.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u56de\u5f52\u7ebf",style:"margin-top:-8px;",id:"scatterchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",
tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"scatterchart_summit",handler:function(){if(5==p){var a=Ext.getCmp("singlescatterchart_majortitle").getValue(),d=Ext.getCmp("singlescatterchart_charttype").getValue();Ext.getCmp("singlescatterchart_charttype").getRawValue();var b=Ext.getCmp("singlescatterchart_label").getValue(),c=Ext.getCmp("singlescatterchart_haxis").getValue(),e=Ext.getCmp("singlescatterchart_haxis").getRawValue(),f=Ext.getCmp("singlescatterchart_vaxis").getValue(),g=Ext.getCmp("singlescatterchart_vaxis").getRawValue(),
h=Ext.getCmp("singlescatterchart_subtitle").getValue(),n=Ext.getCmp("singlescatterchart_haxisname").getValue(),k=Ext.getCmp("singlescatterchart_vaxisname").getValue(),l=0,l=Ext.getCmp("scatterchart_label").getValue()?1:0;0==trim(d).length||0==trim(c).length||0==trim(f).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/XY\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetScatterChart",params:{sql:z+"@"+A+"@"+w+"@"+x+"@"+B,label:b,haxis:c,vaxis:f,showregression:l,dbname:"moh",
rights:q},callback:function(b,l,p){l?(b=trim(p.responseText),b=replaceAll(b,f,g),b=replaceAll(b,c,e),renderCharts("scatterchartContainer",d,3,a,h,n,k,0,b)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Nb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,
fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlescatterchart_accordingpanel",bbar:Oa,collapseMode:"mini",items:[{title:"\u6563\u70b9\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlescatterchart_panel",iconCls:"scatter_chart_edit",listeners:{expand:function(a){p=5;ta(h,11);Ext.getCmp("singlescatterchart_panel").remove(Ext.getCmp("singlescatterchart_form"));Ext.getCmp("singlescatterchart_panel").add(Ext.getCmp("singlescatterchart_form"));Ext.getCmp("singlescatterchart_panel").doLayout()},
afterRender:function(){p=5;ta(h,11);Ext.getCmp("singlescatterchart_panel").add(Ext.getCmp("singlescatterchart_form"));Ext.getCmp("singlescatterchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'scatterchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),jb=new Ext.Window({title:"\u6563\u70b9\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Nb]}),Pa=
new Ext.Toolbar({plain:!0,id:"doughnutchart_tbar"});Pa.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"doughnutchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"doughnutchart_summit",handler:function(){if(6==p){var a=Ext.getCmp("singledoughnutchart_majortitle").getValue(),d=Ext.getCmp("singledoughnutchart_charttype").getValue();Ext.getCmp("singledoughnutchart_charttype").getRawValue();var b=
Ext.getCmp("singledoughnutchart_haxis").getValue();Ext.getCmp("singledoughnutchart_haxis").getRawValue();var c=Ext.getCmp("singledoughnutchart_vaxis").getValue();Ext.getCmp("singledoughnutchart_vaxis").getRawValue();var e=Ext.getCmp("singledoughnutchart_subtitle").getValue(),f=0,f=Ext.getCmp("doughnutchart_label").getValue()?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6807\u7b7e/\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):
Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:z+"@"+A+"@"+w+"@"+x+"@"+B,haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(b,c,h){c?(b=trim(h.responseText),renderCharts("doughnutchartContainer",d,2.1,a,e,"","",f,b)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Ob=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singledoughnutchart_accordingpanel",bbar:Pa,collapseMode:"mini",items:[{title:"\u5706\u73af\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singledoughnutchart_panel",iconCls:"round_chart_edit",listeners:{expand:function(a){p=6;ua(h,11);Ext.getCmp("singledoughnutchart_panel").remove(Ext.getCmp("singledoughnutchart_form"));Ext.getCmp("singledoughnutchart_panel").add(Ext.getCmp("singledoughnutchart_form"));
Ext.getCmp("singledoughnutchart_panel").doLayout()},afterRender:function(){p=6;ua(h,11);Ext.getCmp("singledoughnutchart_panel").add(Ext.getCmp("singledoughnutchart_form"));Ext.getCmp("singledoughnutchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'doughnutchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),mb=new Ext.Window({title:"\u5706\u73af\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},
fill:!0,layout:"fit",items:[Ob]}),Qa=new Ext.Toolbar({plain:!0,id:"bubblechart_tbar"});Qa.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u8c61\u9650",style:"margin-top:-8px;",id:"bubblechart_quadrant",checked:!1},"-",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"bubblechart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"bubblechart_summit",handler:function(){if(7==p){var a=Ext.getCmp("singlebubblechart_majortitle").getValue(),
d=Ext.getCmp("singlebubblechart_charttype").getValue();Ext.getCmp("singlebubblechart_charttype").getRawValue();var b=Ext.getCmp("singlebubblechart_label").getValue(),c=Ext.getCmp("singlebubblechart_haxis").getValue(),e=Ext.getCmp("singlebubblechart_haxis").getRawValue(),f=Ext.getCmp("singlebubblechart_vaxis").getValue(),g=Ext.getCmp("singlebubblechart_vaxis").getRawValue(),h=Ext.getCmp("singlebubblechart_zaxis").getValue();Ext.getCmp("singlebubblechart_zaxis").getRawValue();var n=Ext.getCmp("singlebubblechart_subtitle").getValue(),
k=Ext.getCmp("singlebubblechart_haxisname").getValue(),l=Ext.getCmp("singlebubblechart_vaxisname").getValue(),t=0,r=Ext.getCmp("bubblechart_label").getValue(),t=r?1:0,v=0,v=(r=Ext.getCmp("bubblechart_quadrant").getValue())?1:0;0==trim(d).length||0==trim(c).length||0==trim(f).length||0==trim(h).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/XYZ\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetBubbleChart",params:{sql:z+"@"+A+"@"+w+"@"+x+"@"+B,label:b,haxis:c,vaxis:f,
zaxis:h,dbname:"moh",rights:q},callback:function(b,h,m){h?(b=trim(m.responseText),b=replaceAll(b,f,g),b=replaceAll(b,c,e),t=t.toString()+"@"+v.toString(),renderCharts("bubblechartContainer",d,4,a,n,k,l,t,b)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Pb=new Ext.Panel({layout:"border",
border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlebubblechart_accordingpanel",bbar:Qa,collapseMode:"mini",items:[{title:"\u6c14\u6ce1\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlebubblechart_panel",iconCls:"bubble_chart_edit",listeners:{expand:function(a){p=7;va(h,11);Ext.getCmp("singlebubblechart_panel").remove(Ext.getCmp("singlebubblechart_form"));Ext.getCmp("singlebubblechart_panel").add(Ext.getCmp("singlebubblechart_form"));
Ext.getCmp("singlebubblechart_panel").doLayout()},afterRender:function(){p=7;va(h,11);Ext.getCmp("singlebubblechart_panel").add(Ext.getCmp("singlebubblechart_form"));Ext.getCmp("singlebubblechart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'bubblechartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),lb=new Ext.Window({title:"\u6c14\u6ce1\u56fe",width:750,height:420,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},
fill:!0,layout:"fit",items:[Pb]}),Ra=new Ext.Toolbar({plain:!0,id:"radarchart_tbar"});Ra.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"radarchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"radarchart_summit",handler:function(){if(8==p){var a=Ext.getCmp("multiradarchart_majortitle").getValue(),d=Ext.getCmp("multiradarchart_charttype").getValue();Ext.getCmp("multiradarchart_charttype").getRawValue();
var b=Ext.getCmp("multiradarchart_haxis").getValue();Ext.getCmp("multiradarchart_haxis").getRawValue();var c=Ext.getCmp("multiradarchart_vaxis").getValue(),e=Ext.getCmp("multiradarchart_vaxis").getRawValue(),f=Ext.getCmp("multiradarchart_subtitle").getValue(),g=0,g=Ext.getCmp("radarchart_label").getValue()?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetMultiBarChart",
params:{sql:z+"@"+A+"@"+w+"@"+x+"@"+B,haxis:b,vaxis:c,dbname:"moh",rights:q},callback:function(b,h,k){if(h){b=trim(k.responseText);if(0<=e.indexOf(",")){h=e.split(",");k=c.split(",");for(var l=0;l<=h.length-1;l++)b=b.replace(trim(k[l]),trim(h[l]))}else b=b.replace(c,e);renderCharts("radarchartContainer",d,5,a,f,"","",g,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Qb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singleradarchart_accordingpanel",bbar:Ra,collapseMode:"mini",items:[{title:"\u96f7\u8fbe\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multiradarchart_panel",iconCls:"radar_chart_edit",listeners:{expand:function(a){p=8;wa(h,11);Ext.getCmp("multiradarchart_panel").remove(Ext.getCmp("multiradarchart_form"));Ext.getCmp("multiradarchart_panel").add(Ext.getCmp("multiradarchart_form"));
Ext.getCmp("multiradarchart_panel").doLayout()},afterRender:function(){p=8;wa(h,11);Ext.getCmp("multiradarchart_panel").add(Ext.getCmp("multiradarchart_form"));Ext.getCmp("multiradarchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'radarchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),kb=new Ext.Window({title:"\u96f7\u8fbe\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plugins:new Ext.ux.WindowAlwaysOnTop,
plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Qb]}),Sa=new Ext.Toolbar({plain:!0,id:"combinedchart_tbar"});Sa.add("->","-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"combinedchart_summit",handler:function(){if(9==p){var a=Ext.getCmp("singlecombinedchart_majortitle").getValue(),d=Ext.getCmp("singlecombinedchart_charttype").getValue();Ext.getCmp("singlecombinedchart_charttype").getRawValue();var b=Ext.getCmp("singlecombinedchart_haxis").getValue();
Ext.getCmp("singlecombinedchart_haxis").getRawValue();var c=Ext.getCmp("singlecombinedchart_vaxis").getValue(),e=Ext.getCmp("singlecombinedchart_vaxis").getRawValue(),f=Ext.getCmp("singlecombinedchart_vtyle").getValue(),g=Ext.getCmp("singlecombinedchart_showlabel").getValue(),h=Ext.getCmp("singlecombinedchart_subtitle").getValue(),n=Ext.getCmp("singlecombinedchart_haxisname").getValue(),k=Ext.getCmp("singlecombinedchart_vaxisname").getValue(),l=0;if(0==trim(d).length||0==trim(b).length||0==trim(c).length)Ext.Msg.alert("\u9519\u8bef",
"\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!");else if(1==T)Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!");else{var t=z+"@"+A+"@"+w+"@"+x+"@"+B;Ext.Ajax.request({url:"GetSingleCombinedChart",params:{sql:t,haxis:b,vaxis:c,vcharttype:f,showvalue:g,dbname:"moh",rights:q},callback:function(b,f,g){if(f){b=trim(g.responseText);if(0<=e.indexOf(",")){f=e.split(",");g=c.split(",");for(var p=0;p<=f.length-1;p++)b=
b.replace(trim(g[p]),trim(f[p]))}else b=b.replace(c,e);renderCharts("combinedchartContainer",d,6,a,h,n,k,l,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}else if(9.1==p){a=Ext.getCmp("multicombinedchart_majortitle").getValue();d=Ext.getCmp("multicombinedchart_charttype").getValue();Ext.getCmp("multicombinedchart_charttype").getRawValue();b=Ext.getCmp("multicombinedchart_haxis").getValue();Ext.getCmp("multicombinedchart_haxis").getRawValue();
var c=Ext.getCmp("multicombinedchart_vaxis").getValue(),e=Ext.getCmp("multicombinedchart_vaxis").getRawValue(),f=Ext.getCmp("multicombinedchart_vtyle").getValue(),g=Ext.getCmp("multicombinedchart_showlabel").getValue(),h=Ext.getCmp("multicombinedchart_subtitle").getValue(),n=Ext.getCmp("multicombinedchart_haxisname").getValue(),k=Ext.getCmp("multicombinedchart_vaxisname").getValue(),r=Ext.getCmp("multicombinedchart_secondaxis").getValue(),l=0;0==trim(d).length||0==trim(b).length||0==trim(c).length?
Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):1==multi_index?Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!"):0==r.length?Ext.Msg.alert("\u9519\u8bef","\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u6b21\u8f74!"):Ext.getCmp("multicombinedchart_vaxis").getValue()==r?Ext.Msg.alert("\u9519\u8bef","\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u4e3b\u8f74!"):(t=z+"@"+A+"@"+w+"@"+x+"@"+B,Ext.Ajax.request({url:"GetMultiCombinedChart",
params:{sql:t,haxis:b,vaxis:c,vcharttype:f,showvalue:g,secondaxisvalue:r,dbname:"moh",rights:q},callback:function(b,f,g){if(f){b=trim(g.responseText);if(0<=e.indexOf(",")){f=e.split(",");g=c.split(",");for(var p=0;p<=f.length-1;p++)b=b.replace(trim(g[p]),trim(f[p]))}else b=b.replace(c,e);renderCharts("combinedchartContainer",d,6,a,h,n,k,l,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Rb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:235,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlecombinedchart_accordingpanel",bbar:Sa,collapseMode:"mini",items:[{title:"\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74)",autoScroll:!0,border:!1,forceFit:!0,id:"singlecombinedchart_panel",iconCls:"combined_chart_edit",listeners:{expand:function(a){p=9;xa(h,11);Ext.getCmp("singlecombinedchart_panel").remove(Ext.getCmp("singlecombinedchart_form"));Ext.getCmp("singlecombinedchart_panel").add(Ext.getCmp("singlecombinedchart_form"));
Ext.getCmp("singlecombinedchart_panel").doLayout()},afterRender:function(){p=9;xa(h,11);Ext.getCmp("singlecombinedchart_panel").add(Ext.getCmp("singlecombinedchart_form"));Ext.getCmp("singlecombinedchart_panel").doLayout()}}},{title:"\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74)",autoScroll:!0,border:!1,forceFit:!0,id:"multicombinedchart_panel",iconCls:"combined_chart_edit",listeners:{expand:function(a){p=9.1;Za(h,11);Ext.getCmp("multicombinedchart_panel").remove(Ext.getCmp("multicombinedchart_form"));
Ext.getCmp("multicombinedchart_panel").add(Ext.getCmp("multicombinedchart_form"));Ext.getCmp("multicombinedchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'combinedchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),gb=new Ext.Window({title:"\u7ed3\u5408\u56fe",width:770,height:470,resizable:!0,maximizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Rb]}),Sb=new Ext.menu.Menu({id:"rightMenu",
items:[{text:"\u5355\u5143\u683c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"cellcopy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",handler:function(){la(h,"copybutton")}},"-",{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"copy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",handler:function(){ma(h,"copybutton")}},
{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236(\u5305\u62ec\u8868\u5934)\u5185\u5bb9",iconCls:"copy_header",handler:function(){na(h,"copybutton")}}]});h.addListener("rowcontextmenu",function(a,d,b){b.preventDefault();Sb.showAt(b.getXY())});h.addListener("cellcontextmenu",function(a,d,b,c){columnindex=b});Ext.Ajax.on("requestcomplete",function(a,d,b){"timeOut"==d.getResponseHeader("sessionstatus")&&(d.getResponseHeader("loginPath")?Ext.Msg.alert("\u63d0\u793a","\u4f1a\u8bdd\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u9646!"):
Ext.Msg.alert("\u63d0\u793a","\u8bf7\u6c42\u8d85\u65f6\u8bf7\u91cd\u65b0\u767b\u9646 !"),window.top.location.href=d.getResponseHeader("loginPath"))},this);Ext.getCmp("copybutton").on("click",function(){0==t?Ext.MessageBox.alert("\u63d0\u793a","\u8bf7\u5148\u53f3\u952e\u52a0\u8f7d\u6570\u636e"):Ext.MessageBox.alert("\u63d0\u793a","\u5df2\u7ecf\u590d\u5236\u5230\u526a\u8d34\u677f",function(a){"ok"==a&&(Ext.Ajax.request({url:"SaveCopyActions",params:{rights:q,copybutton:1,copyedrows:t},callback:function(a,
b,c){}}),t=0)})});Ext.getCmp("summary_copybutton").on("click",function(){0==t?Ext.MessageBox.alert("\u63d0\u793a","\u8bf7\u5148\u53f3\u952e\u52a0\u8f7d\u6570\u636e"):Ext.MessageBox.alert("\u63d0\u793a","\u5df2\u7ecf\u590d\u5236\u5230\u526a\u8d34\u677f",function(a){"ok"==a&&(Ext.Ajax.request({url:"SaveCopyActions",params:{rights:q,copybutton:2,copyedrows:t},callback:function(a,b,c){}}),t=0)})});O.add("-","<span id = loginMTime></span>");var ka=0;(new Ext.util.TaskRunner).start({run:function(){ka+=
1;document.getElementById("loginMTime").innerHTML="<b>\u5df2\u767b\u5f55\uff08\u79d2\uff09</b>\uff1a"+ka},interval:1E3})});