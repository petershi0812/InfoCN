Ext.onReady(function(){function V(){B.removeAll();for(var a=u.getCount(),d=[],b=[],c=[],e=[],f=[],h=[],l=[],P=[],k=0;k<=a-1;k++){var q=u.data.items[k].data.either,F=Q.getAt(Q.find("either_type_id",q)).data.either_type;d.push(q);b.push(F);q=u.data.items[k].data.dataindex;e.push(u.data.items[k].data.filter_field);c.push(q);q=u.data.items[k].data.filter_type;F=R.getAt(R.find("math_type_id",q)).data.math_type;f.push(q);h.push(F);l.push(u.data.items[k].data.contents);P.push(u.data.items[k].data.sort_flag)}for(k=
0;k<=a-1;k++){var F=q=" ",r=countInArray(e[k],e);if(1<r){if(k==a-1||c[k]!=c[k+1]){for(r=k-r+1;r<=k;r++){if(8<=fun_gridcolumnindex(c[k],g)){if(isNaN(l[k])){Ext.Msg.alert("\u9519\u8bef","\u8bf7\u8f93\u5165\u6570\u5b57!");break}q=q+d[r]+" "+c[r]+" "+f[r]+" "+l[r]+" "}else q="\u5305\u542b"==h[k]||"\u4e0d\u5305\u542b"==h[k]?q+d[r]+" "+c[r]+" "+f[r]+" '%"+l[r]+"%' ":"\u5f00\u5934\u662f"==h[k]||"\u5f00\u5934\u4e0d\u662f"==h[k]?q+d[r]+" "+c[r]+" "+f[r].substring(1,f[r].length)+" '"+l[r]+"%' ":"\u7ed3\u5c3e\u662f"==
h[k]||"\u7ed3\u5c3e\u4e0d\u662f"==h[k]?q+d[r]+" "+c[r]+" "+f[r].substring(1,f[r].length)+" '%"+l[r]+"' ":q+d[r]+" "+c[r]+" "+f[r]+" '"+l[r]+"' ";F=F+b[r]+e[r]+h[r]+"'"+l[r]+"'"}for(var q=q.substring(4,q.length),F=F.substring(2,F.length),r=B.getCount(),K=0;K<=r-1;K++)B.getAt(K).get("sort_flag")==P[k]&&B.removeAt(K);q=new Ext.data.Record({filter_field:e[k],CH_conditions:F,EN_conditions:q,sort_flag:P[k]});S.stopEditing();B.insert(r,q);S.startEditing(0,1);B.commitChanges();B.sort("sort_flag","ASC")}}else{if(8<=
fun_gridcolumnindex(c[k],g)){if(isNaN(l[k])){Ext.Msg.alert("\u9519\u8bef","\u8bf7\u8f93\u5165\u6570\u5b57!");break}q=c[k]+" "+f[k]+" "+l[k]}else q="\u5305\u542b"==h[k]||"\u4e0d\u5305\u542b"==h[k]?c[k]+" "+f[k]+" '%"+l[k]+"%' ":"\u5f00\u5934\u662f"==h[k]||"\u5f00\u5934\u4e0d\u662f"==h[k]?c[k]+" "+f[k].substring(1,f[k].length)+" '"+l[k]+"%' ":"\u7ed3\u5c3e\u662f"==h[k]||"\u7ed3\u5c3e\u4e0d\u662f"==h[k]?c[k]+" "+f[k].substring(1,f[k].length)+" '%"+l[k]+"' ":c[k]+" "+f[k]+" '"+l[k]+"' ";F=e[k]+h[k]+"'"+
l[k]+"'";r=B.getCount();for(K=0;K<=r-1;K++)B.getAt(K).get("sort_flag")==P[k]&&B.removeAt(K);q=new Ext.data.Record({filter_field:e[k],CH_conditions:F,EN_conditions:q,sort_flag:P[k]});S.stopEditing();B.insert(r,q);S.startEditing(0,1);B.commitChanges();B.sort("sort_flag","ASC")}}}function Ta(){var a=H.getCount();if(0!=a){for(var d=" ",b=0;b<=a-1;b++){var c=H.data.items[b].data,e=c.new_field,c=c.EN_formula,d=b==a-1?d+"("+c+") as "+e+"":d+"("+c+") as "+e+", ";fun_gridfieldname_exists(trim(e),g)||g.addColumn(eval("("+
("{header:'"+e+"',align:'right',width: 100,xtype:'numbercolumn',format : '0,00.00',sortable:false,hideable:false,dataIndex:'"+e+"'}")+")"))}A=d;grid_store_reload(L,E,N,"operation",y+"@"+z+"@"+v+"@"+w+"@"+A,p)}else Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u65b0\u589e\u7684\u5b57\u6bb5!")}function Ua(a,d,b,c){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel_store")&&Ext.getCmp("large_summary_panel_showresult_gridpanel_store").remove();void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")&&
Ext.getCmp("large_summary_panel_showresult_gridpanel").destroy();void 0!=Ext.getCmp("GroupBy_PagingToolbar")&&Ext.getCmp("GroupBy_PagingToolbar").destroy();void 0!=Ext.getCmp("summary_rightMenu")&&Ext.getCmp("summary_rightMenu").destroy();var e=new Ext.data.Store({id:"large_summary_panel_showresult_gridpanel_store",autoLoad:{params:{start:0,limit:b}},reader:new Ext.data.JsonReader,proxy:new Ext.data.HttpProxy({url:"GetAllGridstoreGroupByPage"})});e.on("beforeload",function(d,b){Ext.apply(b.params,
{sql:c,dbname:a,rights:p})});b=new Ext.PagingToolbar({id:"GroupBy_PagingToolbar",store:e,pageSize:b,displayInfo:!0,displayMsg:"\u7b2c{0}\u6761-{1}\u6761\uff0c\u4e00\u5171{2}\u6761",onFirstLayout:function(){this.dsLoaded&&this.onLoad.apply(this,this.dsLoaded);this.rendered&&this.refresh&&this.refresh.hide()}});var f=new Ext.grid.GridPanel({id:"large_summary_panel_showresult_gridpanel",autoScroll:!0,border:!0,bbar:b,loadMask:!0,stripeRows:!0,containerScroll:!0,trackMouseOver:!0,cm:new Ext.grid.ColumnModel(eval("("+
d+")")),store:e});Ext.getCmp("dynamic_panel").add(f);Ext.getCmp("dynamic_panel").doLayout();var h=new Ext.menu.Menu({id:"summary_rightMenu",items:[{text:"\u5355\u5143\u683c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"cellcopy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",handler:function(){la(f,"summary_copybutton")}},"-",{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"copy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",
handler:function(){ma(f,"summary_copybutton")}},{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236(\u5305\u62ec\u8868\u5934)\u5185\u5bb9",iconCls:"copy_header",handler:function(){na(f,"summary_copybutton")}}]});f.addListener("rowcontextmenu",function(a,d,c){c.preventDefault();h.showAt(c.getXY())});f.addListener("cellcontextmenu",function(a,d,c,b){columnindex=c})}function oa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u67f1\u5f62\u56fe",
"column2d"],["\u4e09\u7ef4\u67f1\u5f62\u56fe","column3d"],["\u4e8c\u7ef4\u5e15\u7d2f\u6258\u67f1\u5f62\u56fe","pareto2d"],["\u4e09\u7ef4\u5e15\u7d2f\u6258\u67f1\u5f62\u56fe","pareto3d"]]}),c=new Ext.data.SimpleStore({id:"singlebarchart_haxis_store",fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({id:"singlebarchart_vaxis_store",fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlebarchart_form",labelAlign:"right",
border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlebarchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlebarchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",
typeAhead:!0,triggerAction:"all",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlebarchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,
d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebarchart_vaxis",editable:!0,store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",
collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlebarchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlebarchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singlebarchart_vaxisname"}]}]})}function Va(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type",
"fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u67f1\u5f62\u56fe","mscolumn2d"],["\u4e09\u7ef4\u67f1\u5f62\u56fe","mscolumn3d"],["\u4e8c\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe","stackedcolumn2d"],["\u4e09\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe","stackedcolumn3d"],["\u4e8c\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)","stackedcolumn2d@1"],["\u4e09\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)","stackedcolumn3d@1"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),
e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multibarchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multibarchart_majortitle"},
{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,listWidth:150,id:"multibarchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all",listeners:{select:function(a,d,c){},afterRender:function(a,d,c){}}},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multibarchart_haxis",store:c,mode:"local",
emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multibarchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",
displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multibarchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",
id:"multibarchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multibarchart_vaxisname"}]}]})}function pa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u6761\u5f62\u56fe","bar2d"],["\u4e09\u7ef4\u6761\u5f62\u56fe","bar3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,
data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlecolumnchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",
id:"singlecolumnchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlecolumnchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlecolumnchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",
typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlecolumnchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,
lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlecolumnchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlecolumnchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},
{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singlecolumnchart_vaxisname"}]}]})}function Wa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u6761\u5f62\u56fe","msbar2d"],["\u4e09\u7ef4\u6761\u5f62\u56fe","msbar3d"],["\u4e8c\u7ef4\u5806\u79ef\u6761\u5f62\u56fe","stackedbar2d"],["\u4e09\u7ef4\u5806\u79ef\u6761\u5f62\u56fe","stackedbar3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name",
"category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multicolumnchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",
id:"multicolumnchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"multicolumnchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all",listeners:{select:function(a,d,c){},afterRender:function(a,d,c){}}},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multicolumnchart_haxis",
store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multicolumnchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,
triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multicolumnchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",
id:"multicolumnchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multicolumnchart_vaxisname"}]}]})}function qa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6298\u7ebf\u56fe","line"],["\u5e73\u6ed1\u6298\u7ebf\u56fe","spline"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),
e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlelinechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlelinechart_majortitle"},
{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlelinechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlelinechart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,
triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlelinechart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,
resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlelinechart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlelinechart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},
{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singlelinechart_vaxisname"}]}]})}function Xa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6298\u7ebf\u56fe","msline"],["\u5e73\u6ed1\u6298\u7ebf\u56fe","msspline"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});
new Ext.FormPanel({labelWidth:55,id:"multilinechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multilinechart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,
id:"multilinechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multilinechart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",
forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multilinechart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,
d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multilinechart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"multilinechart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",
id:"multilinechart_vaxisname"}]}]})}function ra(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u9762\u79ef\u56fe","area2d"],["\u5e73\u6ed1\u9762\u79ef\u56fe","splinearea"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singleareachart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",
forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singleareachart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singleareachart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",
valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singleareachart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},
{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singleareachart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,
defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singleareachart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singleareachart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"singleareachart_vaxisname"}]}]})}function Ya(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type",
"fusion_chart_type_id"],autoLoad:!0,data:[["\u9762\u79ef\u56fe","MSArea"],["\u5e73\u6ed1\u9762\u79ef\u56fe","mssplinearea"],["\u5806\u79ef\u9762\u79ef\u56fe","stackedarea2d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multiareachart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",
items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multiareachart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"multiareachart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",
forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multiareachart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",
fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multiareachart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},
defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multiareachart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"multiareachart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multiareachart_vaxisname"}]}]})}function sa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,
data:[["\u4e8c\u7ef4\u997c\u56fe","pie2d"],["\u4e09\u7ef4\u997c\u56fe","pie3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlepiechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",
autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlepiechart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlepiechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},
{xtype:"combo",fieldLabel:"\u6807\u7b7e",selectOnFocus:!0,id:"singlepiechart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlepiechart_vaxis",store:e,mode:"local",
emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",
id:"singlepiechart_subtitle"}]}]})}function ta(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6563\u70b9\u56fe","scatter"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlescatterchart_form",
labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlescatterchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlescatterchart_charttype",store:b,mode:"local",
emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6807\u7b7e",selectOnFocus:!0,id:"singlescatterchart_label",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,
e,P){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"X\u6307\u6807\u9879",selectOnFocus:!0,id:"singlescatterchart_haxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165X\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,P){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}},{xtype:"combo",fieldLabel:"Y\u6307\u6807\u9879",
selectOnFocus:!0,id:"singlescatterchart_vaxis",store:f,mode:"local",emptyText:"\u8bf7\u8f93\u5165Y\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,e){f.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",
items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlescatterchart_subtitle"},{fieldLabel:"X\u8f74\u540d\u79f0",id:"singlescatterchart_haxisname",emptyText:"\u8bf7\u8f93\u5165X\u8f74\u540d\u79f0"},{fieldLabel:"Y\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165Y\u8f74\u540d\u79f0",id:"singlescatterchart_vaxisname"}]}]})}function ua(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u4e8c\u7ef4\u5706\u73af\u56fe",
"doughnut2d"],["\u4e09\u7ef4\u5706\u73af\u56fe","doughnut3d"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singledoughnutchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,
defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singledoughnutchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singledoughnutchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},
{xtype:"combo",fieldLabel:"\u6807\u7b7e",selectOnFocus:!0,id:"singledoughnutchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singledoughnutchart_vaxis",
store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",
emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singledoughnutchart_subtitle"}]}]})}function va(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["\u6c14\u6ce1\u56fe","bubble"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]}),
h=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlebubblechart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlebubblechart_majortitle"},
{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"singlebubblechart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all"},{xtype:"combo",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_label",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6807\u7b7e\u9879",typeAhead:!0,
triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,k){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"combo",fieldLabel:"X\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_haxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165X\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,
resizable:!0,listeners:{afterRender:function(c,b,k){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}},{xtype:"combo",fieldLabel:"Y\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_vaxis",store:f,mode:"local",emptyText:"\u8bf7\u8f93\u5165Y\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,e){f.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}},
{xtype:"combo",fieldLabel:"Z\u6307\u6807\u9879",selectOnFocus:!0,id:"singlebubblechart_zaxis",store:h,mode:"local",emptyText:"\u8bf7\u8f93\u5165Z\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,e){h.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,
defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlebubblechart_subtitle"},{fieldLabel:"X\u8f74\u540d\u79f0",id:"singlebubblechart_haxisname",emptyText:"\u8bf7\u8f93\u5165X\u8f74\u540d\u79f0"},{fieldLabel:"Y\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165Y\u8f74\u540d\u79f0",id:"singlebubblechart_vaxisname"}]}]})}function wa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],
autoLoad:!0,data:[["\u96f7\u8fbe\u56fe","radar"]]}),c=new Ext.data.SimpleStore({fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multiradarchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},
defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multiradarchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",selectOnFocus:!0,id:"multiradarchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0,typeAhead:!0,triggerAction:"all",listeners:{select:function(a,
d,c){},afterRender:function(a,d,c){}}},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multiradarchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,
id:"multiradarchart_vaxis",store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",
emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multiradarchart_subtitle"}]}]})}function xa(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["2D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09","mscombi2d"],["3D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09","mscombi3d"],["2D\u5806\u79ef\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09",
"stackedcolumn2dline"],["3D\u5806\u79ef\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74\uff09","stackedcolumn3dline"]]}),c=new Ext.data.SimpleStore({id:"singlecombinedchart_haxis_store",fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({id:"singlecombinedchart_vaxis_store",fields:["value_name","value_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({id:"singlecombinedchart_vtyle_store",fields:["charttype_name","charttype_id"],
autoLoad:!0,data:[]}),h=new Ext.data.SimpleStore({id:"singlecombinedchart_showlabel_store",fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"singlecombinedchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",
width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"singlecombinedchart_majortitle"},{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",listWidth:240,selectOnFocus:!0,id:"singlecombinedchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",typeAhead:!0,triggerAction:"all",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"singlecombinedchart_haxis",
store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,k){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"singlecombinedchart_vaxis",editable:!0,store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",
typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,k){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))},blur:function(a,d,c){Ext.getCmp("singlecombinedchart_vtyle").reset();Ext.getCmp("singlecombinedchart_showlabel").reset();c=this.getValue();var b=this.getRawValue();d=a="";if(0>b.indexOf(","))a=a+"['"+b+"-\u7ebf\u5f62\u56fe','"+c+"-line'],['"+b+"-\u9762\u79ef\u56fe','"+c+"-area']",
0<trim(a).length&&(a="["+a+"]",f.loadData(eval(a)),d="["+("['"+b+"','"+c+"']")+"]",h.loadData(eval(d)));else{c=c.split(",");for(var b=b.split(","),e=0;e<b.length;e++)a=a+"['"+trim(b[e])+"-\u7ebf\u5f62\u56fe','"+trim(c[e])+"-line'],",a=a+"['"+trim(b[e])+"-\u9762\u79ef\u56fe','"+trim(c[e])+"-area'],",d=d+"['"+trim(b[e])+"','"+trim(c[e])+"'],";0<trim(a).length&&(a=a.substring(0,a.length-1),a="["+a+"]",f.loadData(eval(a)),d=d.substring(0,d.length-1),d="["+d+"]",h.loadData(eval(d)))}}}},{xtype:"multiSelect",
fieldLabel:"\u6307\u6807\u56fe\u5f62",selectOnFocus:!0,id:"singlecombinedchart_vtyle",store:f,mode:"local",emptyText:"\u9ed8\u8ba4\u67f1\u5f62\u56fe",typeAhead:!0,triggerAction:"all",displayField:"charttype_name",valueField:"charttype_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{blur:function(a,d,c){a=this.getRawValue().split(",");d=Ext.getCmp("singlecombinedchart_vaxis").getRawValue();if(0<=d.indexOf(","))for(d=d.split(/[,-]/),c=0;c<d.length;c++)if(1<countInArray_adv(trim(d[c]),a)){Ext.Msg.alert("\u9519\u8bef",
"\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!");T=1;break}else T=0;else 1<countInArray_adv(d,a)?(Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!"),T=1):T=0}}},{xtype:"multiSelect",fieldLabel:"\u663e\u793a\u503c",selectOnFocus:!0,id:"singlecombinedchart_showlabel",editable:!0,store:h,mode:"local",emptyText:"\u9ed8\u8ba4\u4e0d\u663e\u793a",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",
forceSelection:!0,lazyRender:!0,resizable:!0}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"singlecombinedchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",id:"singlecombinedchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",
id:"singlecombinedchart_vaxisname"}]}]})}function Za(a,d){var b=new Ext.data.SimpleStore({fields:["fusion_chart_type","fusion_chart_type_id"],autoLoad:!0,data:[["2D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74\uff09","mscombidy2d"],["3D\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74\uff09","mscolumn3dlinedy"],["3D\u5806\u79ef\u67f1\u5f62+\u7ebf\u6027+\u9762\u79ef\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74\uff09","stackedcolumn3dlinedy"]]}),
c=new Ext.data.SimpleStore({id:"multicombinedchart_haxis_store",fields:["category_name","category_id"],autoLoad:!0,data:[]}),e=new Ext.data.SimpleStore({id:"multicombinedchart_vaxis_store",fields:["value_name","value_id"],autoLoad:!0,data:[]}),f=new Ext.data.SimpleStore({id:"multicombinedchart_vtyle_store",fields:["charttype_name","charttype_id"],autoLoad:!0,data:[]}),h=new Ext.data.SimpleStore({id:"multicombinedchart_showlabel_store",fields:["value_name","value_id"],autoLoad:!0,data:[]}),l=new Ext.data.SimpleStore({id:"multicombinedchart_secondaxis_store",
fields:["value_name","value_id"],autoLoad:!0,data:[]});new Ext.FormPanel({labelWidth:55,id:"multicombinedchart_form",labelAlign:"right",border:!1,bodyStyle:"padding:2px 3px 0",forceFit:!0,defaultType:"textfield",items:[{xtype:"fieldset",collapsible:!0,forceFit:!0,title:"\u4e3b\u8981\u53c2\u6570\u8bbe\u7f6e",autoHeight:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u4e3b\u6807\u9898",width:120,emptyText:"\u8bf7\u8f93\u5165\u6807\u9898",id:"multicombinedchart_majortitle"},{xtype:"combo",
fieldLabel:"\u56fe\u8868\u7c7b\u578b",listWidth:240,selectOnFocus:!0,id:"multicombinedchart_charttype",store:b,mode:"local",emptyText:"\u8bf7\u9009\u62e9\u56fe\u8868\u7c7b\u578b",typeAhead:!0,triggerAction:"all",displayField:"fusion_chart_type",valueField:"fusion_chart_type_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"combo",fieldLabel:"\u6a2a\u8f74",selectOnFocus:!0,id:"multicombinedchart_haxis",store:c,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u6307\u6807\u9879",typeAhead:!0,
triggerAction:"all",displayField:"category_name",valueField:"category_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{afterRender:function(b,e,l){c.loadData(eval(fun_combox_adv_listname(a,d,"\u5c0f\u4e8e")))}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u9879",selectOnFocus:!0,id:"multicombinedchart_vaxis",editable:!0,store:e,mode:"local",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u6307\u6807\u9879",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,
lazyRender:!0,resizable:!0,listeners:{afterRender:function(c,b,l){e.loadData(eval(fun_combox_adv_listname(a,d,"\u5927\u4e8e")))},blur:function(a,d,c){Ext.getCmp("multicombinedchart_vtyle").reset();Ext.getCmp("multicombinedchart_showlabel").reset();Ext.getCmp("multicombinedchart_secondaxis").reset();var b=this.getValue(),e=this.getRawValue();c=d=a="";if(0>e.indexOf(","))a=a+"['"+e+"-\u7ebf\u5f62\u56fe','"+b+"-line'],['"+e+"-\u9762\u79ef\u56fe','"+b+"-area']",0<trim(a).length&&(a="["+a+"]",f.loadData(eval(a)),
d="["+("['"+e+"','"+b+"']")+"]",h.loadData(eval(d)),c="["+("['"+e+"','"+b+"']")+"]",l.loadData(eval(c)));else{for(var b=b.split(","),e=e.split(","),g=0;g<e.length;g++)a=a+"['"+trim(e[g])+"-\u7ebf\u5f62\u56fe','"+trim(b[g])+"-line'],",a=a+"['"+trim(e[g])+"-\u9762\u79ef\u56fe','"+trim(b[g])+"-area'],",d=d+"['"+trim(e[g])+"','"+trim(b[g])+"'],",c=c+"['"+trim(e[g])+"','"+trim(b[g])+"'],";0<trim(a).length&&(a=a.substring(0,a.length-1),a="["+a+"]",f.loadData(eval(a)),d=d.substring(0,d.length-1),d="["+d+
"]",h.loadData(eval(d)),c=c.substring(0,c.length-1),c="["+c+"]",l.loadData(eval(c)))}}}},{xtype:"multiSelect",fieldLabel:"\u6307\u6807\u56fe\u5f62",selectOnFocus:!0,id:"multicombinedchart_vtyle",store:f,mode:"local",emptyText:"\u9ed8\u8ba4\u67f1\u5f62\u56fe",typeAhead:!0,triggerAction:"all",displayField:"charttype_name",valueField:"charttype_id",forceSelection:!0,lazyRender:!0,resizable:!0,listeners:{blur:function(a,d,c){a=this.getRawValue().split(",");d=Ext.getCmp("multicombinedchart_vaxis").getRawValue();
if(0<=d.indexOf(","))for(d=d.split(/[,-]/),c=0;c<d.length;c++)if(1<countInArray_adv(trim(d[c]),a)){Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!");multi_index=1;break}else multi_index=0;else 1<countInArray_adv(d,a)?(Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!"),multi_index=1):multi_index=0}}},{xtype:"multiSelect",fieldLabel:"\u663e\u793a\u503c",selectOnFocus:!0,id:"multicombinedchart_showlabel",
editable:!0,store:h,mode:"local",emptyText:"\u9ed8\u8ba4\u4e0d\u663e\u793a",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0},{xtype:"multiSelect",fieldLabel:"\u6b21\u8f74",selectOnFocus:!0,id:"multicombinedchart_secondaxis",editable:!0,store:l,mode:"local",emptyText:"\u81f3\u5c11\u4e00\u6839\u6b21\u8f74",typeAhead:!0,triggerAction:"all",displayField:"value_name",valueField:"value_id",forceSelection:!0,lazyRender:!0,resizable:!0,
listeners:{blur:function(a,d,c){this.getValue()==Ext.getCmp("multicombinedchart_vaxis").getValue()&&Ext.Msg.alert("\u9519\u8bef","\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u4e3b\u8f74!")}}}]},{xtype:"fieldset",title:"\u9644\u5c5e\u53c2\u6570\u8bbe\u7f6e",collapsible:!0,autoHeight:!0,forceFit:!0,defaults:{anchor:"98%"},defaultType:"textfield",items:[{fieldLabel:"\u526f\u6807\u9898",emptyText:"\u8bf7\u8f93\u5165\u5b50\u6807\u9898",id:"multicombinedchart_subtitle"},{fieldLabel:"\u6a2a\u8f74\u540d\u79f0",
id:"multicombinedchart_haxisname",emptyText:"\u8bf7\u8f93\u5165\u6a2a\u8f74\u540d\u79f0"},{fieldLabel:"\u7eb5\u8f74\u540d\u79f0",emptyText:"\u8bf7\u8f93\u5165\u7eb5\u8f74\u540d\u79f0",id:"multicombinedchart_vaxisname"}]}]})}function la(a,d){var b=a.getSelectionModel(),c=b.getCount();if(void 0==b.getSelected())Ext.Msg.alert("\u63d0\u793a","\u672a\u9009\u62e9\u4efb\u4f55\u6570\u636e!");else if(1==c){var e=b.getSelected();t=1;Ext.Ajax.request({url:"GetcopyRows",params:{rights:p},callback:function(c,
b,f){b?(t=1,c=trim(f.responseText),x=parseInt(trim(c.split("@")[0])),b=trim(c.split("@")[1]),f=parseInt(trim(c.split("@")[2])),""==b?t>x?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!"):(c=a.getColumnModel().getDataIndex(columnindex),c=e.get(c),Ext.getCmp(d).setValue(c)):(b=parseInt(trim(c.split("@")[1])),t>x?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!"):b+t>f?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!"):
(c=a.getColumnModel().getDataIndex(columnindex),c=e.get(c),Ext.getCmp(d).setValue(c)))):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else{var f="",h=b.getSelections();Ext.Ajax.request({url:"GetcopyRows",params:{rights:p},callback:function(c,b,e){if(b)if(t=h.length,c=trim(e.responseText),x=parseInt(trim(c.split("@")[0])),b=trim(c.split("@")[1]),e=parseInt(trim(c.split("@")[2])),""==b)if(t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+
x+"\u6761!");else{c=a.getColumnModel().getDataIndex(columnindex);for(b=0;b<=h.length-1;b++)f=f+h[b].get(c)+"\n";Ext.getCmp(d).setValue(f)}else if(b=parseInt(trim(c.split("@")[1])),t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else if(b+t>e)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{c=a.getColumnModel().getDataIndex(columnindex);for(b=0;b<=h.length-1;b++)f=
f+h[b].get(c)+"\n";Ext.getCmp(d).setValue(f)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}function ma(a,d){var b=a.getSelectionModel(),c=a.getColumnModel(),e=b.getCount();if(void 0==b.getSelected())Ext.Msg.alert("\u63d0\u793a","\u672a\u9009\u62e9\u4efb\u4f55\u6570\u636e!");else if(1==e)b.getSelected(),t=1,Ext.Ajax.request({url:"GetcopyRows",params:{rights:p},callback:function(a,e,f){if(e)if(t=1,a=trim(f.responseText),x=parseInt(trim(a.split("@")[0])),
e=trim(a.split("@")[1]),f=parseInt(trim(a.split("@")[2])),""==e)if(t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else{a="";e=b.getSelected();f=c.getColumnCount();for(var h=1;h<f;h++)c.isHidden(h)||(a=a+e.get(c.getDataIndex(h))+"\t");Ext.getCmp(d).setValue(a)}else if(e=parseInt(trim(a.split("@")[1])),t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else if(e+t>f)Ext.Msg.alert("\u63d0\u793a",
"\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{a="";e=b.getSelected();f=c.getColumnCount();for(h=1;h<f;h++)c.isHidden(h)||(a=a+e.get(c.getDataIndex(h))+"\t");Ext.getCmp(d).setValue(a)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}});else{var f="",h=b.getSelections();Ext.Ajax.request({url:"GetcopyRows",params:{rights:p},callback:function(a,b,e){if(b)if(t=h.length,a=trim(e.responseText),
x=parseInt(trim(a.split("@")[0])),b=trim(a.split("@")[1]),e=parseInt(trim(a.split("@")[2])),""==b)if(t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else{a=c.getColumnCount();for(b=0;b<h.length;b++){e="";for(var g=1;g<a;g++)c.isHidden(g)||(e=e+h[b].get(c.getDataIndex(g))+"\t");f=f+e+"\n"}Ext.getCmp(d).setValue(f)}else if(b=parseInt(trim(a.split("@")[1])),t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+
x+"\u6761!");else if(b+t>e)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{a=c.getColumnCount();for(b=0;b<h.length;b++){e="";for(g=1;g<a;g++)c.isHidden(g)||(e=e+h[b].get(c.getDataIndex(g))+"\t");f=f+e+"\n"}Ext.getCmp(d).setValue(f)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}function na(a,d){var b=a.getSelectionModel(),c=a.getColumnModel(),e=c.config,
f=b.getCount();if(void 0==b.getSelected())Ext.Msg.alert("\u63d0\u793a","\u672a\u9009\u62e9\u4efb\u4f55\u6570\u636e!");else if(1==f){var h="",l="",g=b.getSelected();t=1;Ext.Ajax.request({url:"GetcopyRows",params:{rights:p},callback:function(a,b,f){if(b)if(t=1,a=trim(f.responseText),x=parseInt(trim(a.split("@")[0])),b=trim(a.split("@")[1]),f=parseInt(trim(a.split("@")[2])),""==b)if(t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else{a=c.getColumnCount();
for(b=1;b<a;b++)c.isHidden(b)||(h=h+e[b].header+"\t",l=l+g.get(c.getDataIndex(b))+"\t");a=h+"\n"+l;Ext.getCmp(d).setValue(a)}else if(b=parseInt(trim(a.split("@")[1])),t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else if(b+t>f)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");else{a=c.getColumnCount();for(b=1;b<a;b++)c.isHidden(b)||(h=h+e[b].header+"\t",l=l+g.get(c.getDataIndex(b))+
"\t");a=h+"\n"+l;Ext.getCmp(d).setValue(a)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else{var k="",q=b.getSelections();Ext.Ajax.request({url:"GetcopyRows",params:{rights:p},callback:function(a,b,f){if(b)if(t=q.length,a=trim(f.responseText),x=parseInt(trim(a.split("@")[0])),b=trim(a.split("@")[1]),f=parseInt(trim(a.split("@")[2])),""==b)if(t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+
"\u6761!");else{a=c.getColumnCount();for(b=0;b<q.length;b++){var h="";f="";for(var l=1;l<a;l++)c.isHidden(l)||(h=h+e[l].header+"\t",f=f+q[b].get(c.getDataIndex(l))+"\t");k=k+f+"\n"}k=h+"\n"+k;Ext.getCmp(d).setValue(k)}else if(b=parseInt(trim(a.split("@")[1])),t>x)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u590d\u5236"+x+"\u6761!");else if(b+t>f)Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u590d\u5236\u884c\u6570!");
else{a=c.getColumnCount();for(b=0;b<q.length;b++){f=h="";for(l=1;l<a;l++)c.isHidden(l)||(h=h+e[l].header+"\t",f=f+q[b].get(c.getDataIndex(l))+"\t");k=k+f+"\n"}k=h+"\n"+k;Ext.getCmp(d).setValue(k)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}Ext.QuickTips.init();Ext.form.Field.prototype.msgTarget="qtip";Ext.BLANK_IMAGE_URL="../EXT/extjs3.3.1/images/s.gif";var p=document.getElementById("rightspk").value,E=PAGESIZE,J,x,y=" ",z=" ",w=" ",
v=" ",A=" ",O=" ",G=" ",D=" ",M=0,n=0,T=0,t=0,$a=new Ext.data.SimpleStore({fields:["province_id"],proxy:new Ext.data.HttpProxy({url:"GetComboxSelections?id=province&rights="+p})}),fa=new Ext.data.SimpleStore({fields:["city_id"],proxy:new Ext.data.HttpProxy({url:"GetComboxSelections?id=city&rights="+p}),baseParams:{province_id:""},remoteSort:!0}),W=new Ext.data.SimpleStore({fields:["district_id"],proxy:new Ext.data.HttpProxy({url:"GetComboxSelections?id=district&rights="+p}),baseParams:{province_id:"",
city_id:""},remoteSort:!0}),ab=new Ext.data.SimpleStore({fields:["hos_level_id","hos_level"],data:[[0,"\u4e09\u7ea7"],[1,"\u4e09\u7ea7\u7532\u7b49"],[2,"\u4e09\u7ea7\u5176\u4ed6"],[3,"\u4e8c\u7ea7"],[4,"\u4e00\u7ea7"],[5,"\u672a\u8bc4"]]}),L=new Ext.data.Store({autoLoad:{params:{start:0,limit:E}},reader:new Ext.data.JsonReader,proxy:new Ext.data.HttpProxy({url:"GetAllGridstorePage"})});L.on("beforeload",function(a,d){Ext.apply(d.params,{sql:y,dbname:"operation",numcolumnpoint:9,rights:p})});var ya=
new Ext.grid.CheckboxSelectionModel,bb=new Ext.grid.ColumnModel(fun_grid_colModel_config("\u4f4f\u9662\u624b\u672f\u91cf",ya)),N=new Ext.PagingToolbar({store:L,pageSize:E,displayInfo:!0,displayMsg:"\u7b2c{0}\u6761\u5230{1}\u6761\uff0c\u4e00\u5171{2}\u6761",onFirstLayout:function(){this.dsLoaded&&this.onLoad.apply(this,this.dsLoaded);this.rendered&&this.refresh&&this.refresh.hide()}}),g=new Ext.grid.GridPanel({renderTo:"grid_div",id:"grid",frame:!1,sm:ya,cm:bb,border:!0,loadMask:!0,tbar:[{xtype:"buttongroup",
title:"<b>\u5feb\u901f\u7b5b\u9009</b>",columns:4,defaults:{scale:"small"},items:[{xtype:"multiSelect",width:85,listWidth:85,selectOnFocus:!0,id:"combo_province",store:$a,mode:"remote",emptyText:"\u9009\u62e9\u7701\u4efd",triggerAction:"all",allowBlank:!0,displayField:"province_id",valueField:"province_id",forceSelection:!1,resizable:!0,style:"margin-left : 3px",listeners:{scope:this,blur:function(a){},change:function(){province_field=Ext.getCmp("combo_province");if(province_field.isValid()){city_field=
Ext.getCmp("combo_city");city_field.clearValue();district_field=Ext.getCmp("combo_district");district_field.clearValue();var a=province_field.getValue();0<=a.length&&(Ext.getCmp("combo_province").setValue(a),fa.baseParams.province_id=a,W.baseParams.province_id=a,fa.load())}}}},{xtype:"multiSelect",width:85,blankText:"\u9009\u62e9\u5730\u7ea7\u5e02",emptyText:"\u9009\u62e9\u5730\u7ea7\u5e02",triggerAction:"all",allowBlank:!0,displayField:"city_id",valueField:"city_id",forceSelection:!1,resizable:!0,
id:"combo_city",store:fa,selectOnFocus:!0,loadText:"\u6b63\u5728\u52a0\u8f7d...",style:"margin-left : 6px",listeners:{scope:this,change:function(){city_field=Ext.getCmp("combo_city");if(city_field.isValid()){district_field=Ext.getCmp("combo_district");district_field.clearValue();var a=city_field.getValue();0<=a.length&&(Ext.getCmp("combo_city").setValue(a),W.baseParams.city_id=a,W.load())}}}},{xtype:"multiSelect",width:85,blankText:"\u9009\u62e9\u533a\u53bf\u5e02",emptyText:"\u9009\u62e9\u533a\u53bf\u5e02",
triggerAction:"all",allowBlank:!0,displayField:"district_id",valueField:"district_id",forceSelection:!1,resizable:!0,id:"combo_district",store:W,selectOnFocus:!0,loadText:"\u6b63\u5728\u52a0\u8f7d...",style:"margin-left : 9px",listeners:{}},{text:"",disabled:!0},{xtype:"multiSelect",selectOnFocus:!0,id:"hoplevel_combox",width:85,name:"hos_level",blankText:"\u8bf7\u9009\u62e9\u7b49\u7ea7",emptyText:"\u9009\u62e9\u7b49\u7ea7",allowBlank:!0,store:ab,mode:"local",triggerAction:"all",displayField:"hos_level",
valueField:"hos_level_id",forceSelection:!1,resizable:!0,style:"margin-left : 3px",listeners:{}},{text:"",disabled:!0},{text:"\u641c\u7d22",width:30,id:"combox_search",iconCls:"search",style:"margin-left : 20px",handler:function(){var a=Ext.getCmp("combo_province").getRawValue(),d=Ext.getCmp("combo_city").getRawValue(),b=Ext.getCmp("combo_district").getRawValue(),c=Ext.getCmp("hoplevel_combox").getRawValue(),e="",f=e="",h="",l="";if(""==a&&""==c)Ext.Msg.alert("\u63d0\u793a","\u8bf7\u8f93\u5165\u6761\u4ef6!");
else{if(0<=a.indexOf("(\u5168\u56fd)")||0<=d.indexOf("(\u5168\u56fd)")||0<=b.indexOf("(\u5168\u56fd)"))e=" ";else{if(""!=a){if(0<a.indexOf(","))for(var a=a.split(","),g=0;g<=a.length-1;g++)e=g<a.length-1?e+"province = '"+a[g].replace(" ","")+"' or ":e+"province = '"+a[g].replace(" ","")+"' ";else e="province = '"+a+"' ";e=" ( "+e+" ) and "}if(""!=d){if(0<d.indexOf(","))for(a=d.split(","),g=0;g<=a.length-1;g++)f=g<a.length-1?f+"city = '"+a[g].replace(" ","")+"' or ":f+"city = '"+a[g].replace(" ","")+
"' ";else f="city = '"+d+"' ";f=" ( "+f+" ) and "}if(""!=b){if(0<b.indexOf(","))for(a=b.split(","),g=0;g<=a.length-1;g++)h=g<a.length-1?h+"district = '"+a[g].replace(" ","")+"' or ":h+"district = '"+a[g].replace(" ","")+"' ";else h="district = '"+b+"' ";h=" ( "+h+" ) and "}if(""!=c){if(0<c.indexOf(","))for(a=c.split(","),g=0;g<=a.length-1;g++)switch(a[g].replace(" ","")){case "\u4e09\u7ea7":l+="(Grade_Level_Link = '\u4e09\u7ea7') or ";break;case "\u4e09\u7ea7\u7532\u7b49":l+="(Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u7532\u7b49') or ";
break;case "\u4e09\u7ea7\u5176\u4ed6":l+="(Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u4e59\u3001\u4e19\u6216\u672a\u8bc4\u7b49') or ";break;case "\u4e8c\u7ea7":l+="(Grade_Level_Link = '\u4e8c\u7ea7' and Grade_Link = '\u5168\u90e8') or ";break;case "\u4e00\u7ea7":l+="(Grade_Level_Link = '\u4e00\u7ea7' and Grade_Link = '\u5168\u90e8') or ";break;case "\u672a\u8bc4":l+="(Grade_Level_Link = '\u672a\u8bc4' and Grade_Link = '\u5168\u90e8') or "}else{switch(c){case "\u4e09\u7ea7":l="Grade_Level_Link = '\u4e09\u7ea7' ";
break;case "\u4e09\u7ea7\u7532\u7b49":l="Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u7532\u7b49' ";break;case "\u4e09\u7ea7\u5176\u4ed6":l="Grade_Level_Link = '\u4e09\u7ea7' and Grade_Link = '\u4e59\u3001\u4e19\u6216\u672a\u8bc4\u7b49' ";break;case "\u4e8c\u7ea7":l="Grade_Level_Link = '\u4e8c\u7ea7' and Grade_Link = '\u5168\u90e8' ";break;case "\u4e00\u7ea7":l="Grade_Level_Link = '\u4e00\u7ea7' and Grade_Link = '\u5168\u90e8' ";break;case "\u672a\u8bc4":l="Grade_Level_Link = '\u672a\u8bc4' and Grade_Link = '\u5168\u90e8'"}l+=
" or "}l=" ( "+l.substring(0,l.length-3)+" ) and "}e=e+f+h+l;e=e.substring(0,e.length-4)}z=e;grid_store_reload(L,E,N,"operation",y+"@"+z+"@"+v+"@"+w+"@"+A,p)}}},{text:"",disabled:!0}]},{xtype:"buttongroup",columns:4,title:"<b>\u7b5b\u9009\u4e0e\u6392\u5e8f</b>",items:[{text:"\u6392\u5e8f",scale:"large",tooltip:"\u663e\u793a\u6392\u5e8f\u5bf9\u8bdd\u6846\uff0c\u4e00\u6b21\u6027\u6839\u636e\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u6392\u5e8f",rowspan:2,iconCls:"large_sort",iconAlign:"left",handler:function(){var a=
fun_combox_listname(g);X.loadData(eval(a));Y.show()}},{text:"\u7b5b\u9009",scale:"large",tooltip:"\u663e\u793a\u7b5b\u9009\u5bf9\u8bdd\u6846,\u5bf9\u6307\u6807\u8fdb\u884c\u81ea\u5b9a\u4e49\u7b5b\u9009",rowspan:2,iconCls:"large_filter",iconAlign:"left",handler:function(){var a=new Ext.tree.AsyncTreeNode({id:"root",expanded:!0,text:"\u6307\u6807",children:eval(fun_tree_listname(g))});za.setRootNode(a);U.show()}},{text:"\u6307\u6807\u9009\u62e9",scale:"large",tooltip:"\u663e\u793a\u6307\u6807\u9009\u62e9\u5bf9\u8bdd\u6846,\u6709\u9009\u62e9\u6027\u7684\u663e\u793a\u6307\u6807\u5217",
rowspan:2,iconCls:"large_showcolumn",iconAlign:"left",handler:function(){var a=new Ext.tree.AsyncTreeNode({id:"root",expanded:!0,text:"\u6307\u6807",children:eval(fun_tree_listname(g))});Aa.setRootNode(a);Z.show()}},{text:"\u663e\u793a\u6307\u6807",tooltip:"\u663e\u793a\u6240\u6709\u7684\u6307\u6807\u5217",iconCls:"small_showcolumn",handler:function(){for(var a=Ext.getCmp("grid").getColumnModel().getColumnCount(),d=1;d<=a-1;d++)Ext.getCmp("grid").getColumnModel().setHidden(d,!1)}},{text:"\u53d6\u6d88\u7b5b\u9009",
tooltip:"\u53d6\u6d88\u5feb\u901f\u7b5b\u9009\u548c\u7b5b\u9009\u7684\u6240\u6709\u6761\u4ef6",iconCls:"clear_filter",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u53d6\u6d88\u7b5b\u9009\u5417?",function(a){"yes"==a&&(Ext.getCmp("combo_city").reset(),Ext.getCmp("combo_province").reset(),Ext.getCmp("combo_district").reset(),Ext.getCmp("hoplevel_combox").reset(),v=z=y=" ",grid_store_reload(L,E,N,"operation",y+"@"+z+"@"+v+"@"+w+"@"+A,p),0<B.getCount()&&B.removeAll(),
0<u.getCount()&&u.removeAll())})}}]},{xtype:"buttongroup",columns:4,title:"<b>\u56fe\u8868</b>",defaults:{scale:"small"},items:[{text:"\u67f1\u5f62\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u67f1\u5f62\u56fe",iconCls:"bar_chart",handler:function(){cb.show();0==n?(Ext.getCmp("singlebarchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singlebarchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e")))):.1==n&&(Ext.getCmp("multibarchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,
8,"\u5c0f\u4e8e"))),Ext.getCmp("multibarchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u6298\u7ebf\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u6298\u7ebf\u56fe\u548c\u5e73\u6ed1\u6298\u7ebf\u56fe",iconCls:"line_chart",handler:function(){db.show();2==n?(Ext.getCmp("singlelinechart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singlelinechart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e")))):
2.1==n&&(Ext.getCmp("multilinechart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("multilinechart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u997c\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u997c\u56fe",iconCls:"pie_chart",handler:function(){eb.show();4==n&&(Ext.getCmp("singlepiechart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singlepiechart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,
8,"\u5927\u4e8e"))))}},{text:"\u7ed3\u5408\u56fe",tooltip:"\u521b\u5efa\u5355\u8f74\u6216\u4e3b\u6b21\u8f74\u7ebf\u6027\uff0c\u67f1\u5f62\uff0c\u9762\u79ef\u56fe\u7684\u7ec4\u5408",iconCls:" combined_chart",handler:function(){fb.show();9==n?(Ext.getCmp("singlecombinedchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singlecombinedchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e")))):9.1==n&&(Ext.getCmp("multicombinedchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,
8,"\u5c0f\u4e8e"))),Ext.getCmp("multicombinedchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u6761\u5f62\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u6761\u5f62\u56fe",iconCls:"column_chart",handler:function(){gb.show();1==n?(Ext.getCmp("singlecolumnchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singlecolumnchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e")))):1.1==n&&
(Ext.getCmp("multicolumnchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("multicolumnchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u9762\u79ef\u56fe",tooltip:"\u5355\u7ef4\u5ea6\u548c\u591a\u7ef4\u5ea6\u9762\u79ef\u56fe\u548c\u5e73\u6ed1\u9762\u79ef\u56fe",iconCls:"area_chart",handler:function(){hb.show();3==n?(Ext.getCmp("singleareachart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),
Ext.getCmp("singleareachart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e")))):3.1==n&&(Ext.getCmp("multiareachart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("multiareachart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u6563\u70b9\u56fe",tooltip:"XY\u56fe\uff0c\u76f8\u5173\u6027\u5206\u6790\u56fe",iconCls:"scatter_chart",handler:function(){ib.show();5==n&&(Ext.getCmp("singlescatterchart_label").store.loadData(eval(fun_combox_adv_listname(g,
8,"\u5c0f\u4e8e"))),Ext.getCmp("singlescatterchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))),Ext.getCmp("singlescatterchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{xtype:"splitbutton",text:"\u5176\u4ed6\u56fe\u8868",iconCls:"other_chart",menu:[{text:"\u96f7\u8fbe\u56fe",tooltip:"\u5404\u9879\u6bd4\u7387\u5206\u6790",iconCls:"radar_chart",handler:function(){jb.show();8==n&&(Ext.getCmp("multiradarchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,
8,"\u5c0f\u4e8e"))),Ext.getCmp("multiradarchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u6c14\u6ce1\u56fe",tooltip:"\u5e02\u573a\u6f5c\u529b\u5206\u6790",iconCls:"bubble_chart",handler:function(){kb.show();7==n&&(Ext.getCmp("singlebubblechart_label").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singlebubblechart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))),Ext.getCmp("singlebubblechart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,
8,"\u5927\u4e8e"))),Ext.getCmp("singlebubblechart_zaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}},{text:"\u5706\u73af\u56fe",tooltip:"\u5706\u73af\u56fe",iconCls:"round_chart",handler:function(){lb.show();6==n&&(Ext.getCmp("singledoughnutchart_haxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e"))),Ext.getCmp("singledoughnutchart_vaxis").store.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e"))))}}]}]},{xtype:"buttongroup",columns:4,title:"<b>\u6570\u636e\u5de5\u5177\u4e0e\u5206\u6790</b>",
items:[{text:"\u5206\u7c7b\u6c47\u603b",tooltip:"\u6c47\u603b\u591a\u4e2a\u76f8\u5173\u6027\u6307\u6807\u9879",scale:"large",rowspan:2,iconCls:"data_summary",iconAlign:"left",handler:function(){Ba.loadData(eval(fun_combox_adv_listname(g,8,"\u5c0f\u4e8e")));Ca.loadData(eval(fun_combox_adv_listname(g,8,"\u5927\u4e8e")));Ext.getCmp("large_summary_panel_groupname").reset();Ext.getCmp("large_summary_panel_valuename").reset();Ext.getCmp("large_summary_panel_type").reset();D=G=O=" ";void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")&&
Ext.getCmp("large_summary_panel_showresult_gridpanel").destroy();aa.show()}},{text:"\u65b0\u589e\u5217",scale:"large",tooltip:"\u81ea\u5b9a\u4e49\u6784\u5efa\u5ef6\u4f38\u5217",rowspan:2,iconCls:"add_column",iconAlign:"left",handler:function(){ba.show()}},{text:"\u5bfc\u51fa",scale:"large",tooltip:"\u5bfc\u51faexcel",rowspan:2,iconCls:"export",iconAlign:"left",handler:function(){Ext.Ajax.request({url:"GetexportRows",params:{rights:p},callback:function(a,d,b){if(d){var c=g.store.getCount();a=trim(b.responseText);
J=parseInt(trim(a.split("@")[0]));d=trim(a.split("@")[1]);b=trim(a.split("@")[2]);var e=parseInt(trim(a.split("@")[3])),f=parseInt(trim(a.split("@")[4]));""==b?c>J?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+J+"\u6761!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(g),Ext.Ajax.request({url:"SaveExportActions",params:{rights:p,exportbutton:1,exportedrows:c},callback:function(a,d,c){}}))}):(d=
parseInt(trim(a.split("@")[1])),b=parseInt(trim(a.split("@")[2])),c>J?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+J+"\u6761!"):b+1>f?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u6b21\u6570!"):d+c>e?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u884c\u6570!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",
function(a){"yes"==a&&(exported(g),Ext.Ajax.request({url:"SaveExportActions",params:{rights:p,exportbutton:1,exportedrows:c},callback:function(a,d,c){}}))}))}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}},{text:"",disabled:!0},{text:"",disabled:!0}]},{xtype:"buttongroup",columns:2,title:"<b>\u590d\u5236</b>",items:[{xtype:"CopyButton",text:"\u590d\u5236",id:"copybutton",scale:"large",tooltip:"\u590d\u5236\u8868\u683c\u9009\u4e2d\u7684\u5355\u5143\u683c\u6216\u8005\u884c",
rowspan:2,iconCls:"copy_large",iconAlign:"left"},{text:"",disabled:!0},{text:"",disabled:!0}]}],store:L,autoScroll:!0,stripeRows:!0,containerScroll:!0,trackMouseOver:!0,view:new Ext.ux.grid.BufferView({rowHeight:20,scrollDelay:!1,forceFit:!1}),bbar:N});g.render();new Ext.Viewport({layout:"border",items:[{region:"center",layout:"fit",frame:!1,border:!1,items:[g]}]});var X=new Ext.data.SimpleStore({fields:["field","field_id"],autoLoad:!0,data:[["\u884c\u653f\u533a\u5212\u4ee3\u7801","AdminCode"],["\u7701\u4efd",
"Province"],["\u57ce\u5e02","City"],["\u533a\u53bf\u57ce\u5e02","District"]]}),mb=new Ext.form.ComboBox({selectOnFocus:!0,id:"editorfiled_combox",width:220,allowBlank:!1,editable:!1,store:X,mode:"local",typeAhead:!0,triggerAction:"all",displayField:"field",valueField:"field_id",forceSelection:!0,resizable:!1}),ga=new Ext.data.SimpleStore({fields:["order_field","order_field_id"],autoLoad:!0,data:[["\u964d\u5e8f","DESC"],["\u5347\u5e8f"," ASC"]]}),nb=new Ext.form.ComboBox({selectOnFocus:!0,id:"editorfield_sort_combox",
width:220,allowBlank:!1,editable:!1,store:ga,mode:"local",typeAhead:!0,triggerAction:"all",displayField:"order_field",valueField:"order_field_id",forceSelection:!0,lazyRender:!0,resizable:!1}),Da=new Ext.grid.CheckboxSelectionModel,ob=new Ext.grid.ColumnModel({defaults:{sortable:!0},columns:[new Ext.grid.RowNumberer,Da,{header:"Column",dataIndex:"default_id",width:100,align:"center",sortable:!1,hideable:!1},{header:"\u6307\u6807\u9879",dataIndex:"find_field",width:200,align:"center",sortable:!1,hideable:!1,
editor:mb,renderer:function(a,d,b){d=X.find("field_id",a);return-1!=d?X.getAt(d).data.field:a}},{header:"\u6b21\u5e8f",dataIndex:"Order_type",width:80,align:"center",sortable:!1,hideable:!1,editor:nb,renderer:function(a,d,b){d=ga.find("order_field_id",a);return-1!=d?ga.getAt(d).data.order_field:a}}]}),Ea=new Ext.Toolbar({plain:!0,id:"large_sort_panel_bar"});Ea.add({xtype:"tbspacer"},"-",{text:"\u52a0\u5165\u6761\u4ef6",tooltip:"\u65b0\u589e\u6392\u5e8f\u6761\u4ef6",iconCls:"add",handler:function(){m.commitChanges();
var a=m.getCount(),d=I.getSelectionModel(),b=0==a?new Ext.data.Record({default_id:"\u4e3b\u8981\u5173\u952e\u5b57",find_field:"\u7701\u4efd",Order_type:"\u964d\u5e8f"}):new Ext.data.Record({default_id:"\u6b21\u8981\u5173\u952e\u5b57",find_field:"\u7701\u4efd",Order_type:"\u964d\u5e8f"});0!=d.getCount()&&(a=d.getSelected(),a=m.indexOf(a)+1);I.stopEditing();m.insert(a,b);I.startEditing(0,1);m.commitChanges()}},"-",{xtype:"tbspacer"},{text:"\u5220\u9664\u6761\u4ef6",tooltip:"\u5220\u9664\u6761\u4ef6",
iconCls:"delete",handler:function(){m.commitChanges();var a=m.getCount(),d=I.getSelectionModel(),b=d.getCount();0==b?Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u6392\u5e8f\u6761\u4ef6!"):1==b?(d=d.getSelected(),b=m.indexOf(d),1<a&&0==b&&m.getAt(1).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57"),m.remove(d)):1<b&&b!=a?(a=d.getSelections(),"\u4e3b\u8981\u5173\u952e\u5b57"==a[0].get("default_id")?(m.remove(a),m.commitChanges(),m.getAt(0).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57")):
m.remove(a)):m.remove(d.getSelections());m.commitChanges()}},"-",{xtype:"tbspacer"},{iconCls:"arrow_up",text:"\u4e0a\u79fb",tooltip:"\u9009\u4e2d\u6392\u5e8f\u6761\u4ef6\u4e0a\u79fb",handler:function(){if(1<m.getCount()){var a=I.getSelectionModel(),d=a.getCount();if(!(0>=d))if(1<d)Ext.Msg.alert("\u63d0\u793a","\u4e00\u6b21\u53ea\u80fd\u9009\u62e9\u4e00\u6761!");else{m.commitChanges();a=a.getSelected();a=m.indexOf(a);if(0==a)return!1;d=m.data.items[a].data;d=new Ext.data.Record({default_id:d.default_id,
find_field:d.find_field,Order_type:d.Order_type});1==a?(m.removeAt(a),m.insert(a-1,d),I.getSelectionModel().selectRow(a-1),m.getAt(a).set("default_id","\u6b21\u8981\u5173\u952e\u5b57"),m.getAt(a-1).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57")):(m.removeAt(a),m.insert(a-1,d),I.getSelectionModel().selectRow(a-1));m.commitChanges()}}}},{xtype:"tbspacer"},{iconCls:"arrow_down",text:"\u4e0b\u79fb",tooltip:"\u9009\u4e2d\u6392\u5e8f\u6761\u4ef6\u4e0b\u79fb",handler:function(){if(1<m.getCount()){m.commitChanges();
var a=m.getCount(),d=I.getSelectionModel(),b=d.getCount();if(!(0>=b))if(1<b)Ext.Msg.alert("\u63d0\u793a","\u4e00\u6b21\u53ea\u80fd\u9009\u62e9\u4e00\u6761!");else{d=d.getSelected();d=m.indexOf(d);if(d==a-1)return!1;a=m.data.items[d].data;a=new Ext.data.Record({default_id:a.default_id,find_field:a.find_field,Order_type:a.Order_type});0==d?(m.removeAt(d),m.insert(d+1,a),I.getSelectionModel().selectRow(d+1),m.getAt(d+1).set("default_id","\u6b21\u8981\u5173\u952e\u5b57"),m.getAt(d).set("default_id","\u4e3b\u8981\u5173\u952e\u5b57")):
(m.removeAt(d),m.insert(d+1,a),I.getSelectionModel().selectRow(d+1));m.commitChanges()}}}},"-",{xtype:"tbspacer"},"->",{text:"\u786e\u5b9a",iconCls:"accept",tooltip:"\u786e\u5b9a\u6392\u5e8f",handler:function(){m.commitChanges();var a=m.getCount(),d=[],b=[];if(0<a){for(var c=0;c<=a-1;c++){var e=m.data.items[c].data.Order_type;d.push(m.data.items[c].data.find_field);b.push(e)}if(isRepeat(d))Ext.Msg.alert("\u9519\u8bef","\u6709\u5217\u88ab\u591a\u6b21\u6392\u5e8f\uff0c\u8bf7\u5220\u9664\u91cd\u590d\u7684\u6392\u5e8f\u6761\u4ef6\uff0c\u7136\u540e\u91cd\u8bd5!");
else{e="";for(c=0;c<=a-1;c++)var f=fun_newcolumn_dataindexformula("EN_formula",d[c],"new_field",H),e=0<f.length?e+" ("+f+") ":"\u7701\u4efd"==d[c]?e+" province ":e+" "+d[c]+" ",e="\u964d\u5e8f"==b[c]?e+" desc, ":e+b[c]+", ";w=e=" order by "+e.substring(0,e.length-2);grid_store_reload(L,E,N,"operation",y+"@"+z+"@"+v+"@"+w+"@"+A,p);Y.hide()}}else 0<w.length&&(w=" "),Y.hide()}},{xtype:"tbspacer"},{text:"\u53d6\u6d88",iconCls:"deldt",tooltip:"\u6e05\u9664\u6240\u6709\u6392\u5e8f\u6761\u4ef6",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a",
"\u786e\u5b9a\u9700\u8981\u6e05\u7a7a\u6392\u5e8f\u6761\u4ef6?",function(a){"yes"==a&&(0<m.getCount()&&(m.removeAll(),m.commitChanges()),w=" ",Y.hide())})}},{xtype:"tbspacer"});var m=new Ext.data.Store({autoDestroy:!0,proxy:new Ext.data.HttpProxy({}),reader:new Ext.data.JsonReader({totalProperty:"totalProperty",root:"root"},[{name:"find_field"},{name:"Order_type"}])}),I=new Ext.grid.EditorGridPanel({id:"large_sort_panel",tbar:Ea,sm:Da,cm:ob,clicksToEdit:1,store:m}),Y=new Ext.Window({title:"\u6392\u5e8f",
width:450,height:250,resizable:!1,collapsible:!0,closeAction:"hide",autoScroll:!0,modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[I]}),Aa=new Ext.tree.TreePanel({id:"large_showcolumn_panel_tree",el:"large_showcolumn_panel_tree",plain:!0,baseCls:"x-plain",frame:!0,autoScroll:!0,animate:!0,enableDD:!1,containerScroll:!0,border:!1,rootVisible:!0});Ext.getCmp("large_showcolumn_panel_tree").on("click",function(a){if(a.leaf){var d=a.attributes.text;a=a.attributes.id;var b=[],c=C.getCount();
if(0<c)for(var e=0;e<=c-1;e++)b.push(C.data.items[e].data.filter_field);isInArray(d,b)||(C.add(new Ext.data.Record({filter_field:d,sort_flag:a})),C.sort("sort_flag","ASC"),C.commitChanges())}});var C=new Ext.data.JsonStore({fields:[{name:"filter_field",mapping:"filter_field"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),Fa=new Ext.grid.CheckboxSelectionModel,pb=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,Fa,{header:"<center>\u4e3b\u8981\u6307\u6807</center>",dataIndex:"filter_field",
width:160,align:"left",sortable:!1,hideable:!1},{header:"\u9690\u85cfid1",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),ha=new Ext.grid.GridPanel({cm:pb,sm:Fa,forceFit:!0,id:ha,border:!1,store:C,viewConfig:{forceFit:!0}}),Z=new Ext.Panel({layout:"border",border:!1,items:[{title:"\u6240\u6709\u6307\u6807",region:"west",width:215,fill:!0,tbar:["->","-",{xtype:"button",text:"\u5168\u9009",iconAlign:"right",tooltip:"\u663e\u793a\u6240\u6709\u7684\u6307\u6807\u9879",iconCls:"sel_right",id:"large_showcolumn_panel_selectall",
handler:function(){for(var a=Ext.getCmp("large_showcolumn_panel_tree").getRootNode().childNodes,d=[],b=[],c=0;c<=a.length-1;c++)d.push(a[c].attributes.text),b.push(a[c].attributes.id);for(var e=[],f=C.getCount(),c=0;c<=f-1;c++)e.push(C.data.items[c].data.filter_field);for(c=0;c<=a.length-1;c++)isInArray(d[c],e)||(C.add(new Ext.data.Record({filter_field:d[c],sort_flag:b[c]})),C.sort("sort_flag","ASC"),C.commitChanges())}}],layout:"fit",split:!0,collapsible:!0,collapseMode:"mini",items:[Aa]},{title:"\u5df2\u9009\u6307\u6807",
region:"center",fill:!0,layout:"fit",tbar:[{xtype:"button",text:"\u64a4\u9500",tooltip:"\u5220\u9664\u9009\u4e2d\u7684\u6307\u6807\u9879",iconCls:"sel_left",id:"large_showcolumn_panel_removesingle",handler:function(){var a=ha.getSelectionModel(),d=a.getCount();0<d?(a=1==d?a.getSelected():a.getSelections(),C.remove(a),C.commitChanges(),C.sort("sort_flag","ASC")):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u9009\u62e9\u4e0d\u663e\u793a\u7684\u6307\u6807\uff01")}},"-","->","-",{xtype:"button",text:"\u786e\u5b9a",
tooltip:"\u786e\u5b9a",iconCls:"accept",id:"large_showcolumn_panel_submit",handler:function(){var a=C.getCount();if(0<a){for(var d=Ext.getCmp("grid").getColumnModel().getColumnCount(),b=1;b<=d-1;b++)Ext.getCmp("grid").getColumnModel().setHidden(b,!0);for(d=0;d<=a-1;d++)b=fun_gridcolumnindex(C.data.items[d].data.filter_field,g),Ext.getCmp("grid").getColumnModel().setHidden(b,!1);Z.hide()}else Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u9700\u8981\u663e\u793a\u7684\u5217!")}}],items:[ha]}]}),
Z=new Ext.Window({title:"\u6307\u6807\u9009\u62e9",width:460,height:350,resizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Z]}),za=new Ext.tree.TreePanel({id:"large_filter_panel_tree",el:"large_filter_panel_tree",plain:!0,baseCls:"x-plain",frame:!0,autoScroll:!0,animate:!0,enableDD:!1,containerScroll:!0,border:!1,rootVisible:!0});Ext.getCmp("large_filter_panel_tree").on("click",function(a){if(a.leaf){var d=a.attributes.text,b=a.attributes.id,c=a.attributes.name;
a=u.getCount();d=new Ext.data.Record({either:"and",filter_field:d,filter_type:"=",contents:"",dataindex:c,sort_flag:b});ca.stopEditing();u.insert(a,d);ca.startEditing(0,1);u.commitChanges();u.sort("sort_flag","ASC")}});var Q=new Ext.data.SimpleStore({fields:["either_type","either_type_id"],autoLoad:!0,data:[["\u548c","and"],["\u6216"," or"]]}),qb=new Ext.form.ComboBox({selectOnFocus:!0,id:"either_combox",width:80,listWidth:50,allowBlank:!1,editable:!1,store:Q,mode:"local",typeAhead:!0,triggerAction:"all",
displayField:"either_type",valueField:"either_type_id",forceSelection:!0,resizable:!1}),R=new Ext.data.SimpleStore({fields:["math_type","math_type_id"],autoLoad:!0,data:[["\u5927\u4e8e",">"],["\u5927\u4e8e\u7b49\u4e8e",">="],["\u7b49\u4e8e","="],["\u4e0d\u7b49\u4e8e","<>"],["\u5c0f\u4e8e","<"],["\u5c0f\u4e8e\u7b49\u4e8e","<="],["\u5305\u542b","like"],["\u4e0d\u5305\u542b","not like"],["\u5f00\u5934\u662f","#like"],["\u5f00\u5934\u4e0d\u662f","#not like"],["\u7ed3\u5c3e\u662f","@like"],["\u7ed3\u5c3e\u4e0d\u662f",
"@not like"]]}),rb=new Ext.form.ComboBox({selectOnFocus:!0,id:"filtertype_combox",width:80,allowBlank:!1,editable:!1,store:R,mode:"local",typeAhead:!0,triggerAction:"all",displayField:"math_type",valueField:"math_type_id",forceSelection:!0,resizable:!1}),sb=new Ext.form.TextField({allowBlank:!1,id:"contents_name"}),u=new Ext.data.JsonStore({fields:[{name:"either",mapping:"either"},{name:"filter_field",mapping:"filter_field"},{name:"filter_type",mapping:"filter_type"},{name:"contents",mapping:"contents"},
{name:"dataindex",mapping:"dataindex"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),tb=new Ext.grid.CheckboxSelectionModel,ub=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,{header:"\u548c/\u6216",dataIndex:"either",width:50,align:"center",sortable:!1,hideable:!1,editor:qb,renderer:function(a,d,b){d=Q.find("either_type_id",a);return-1!=d?Q.getAt(d).data.either_type:a}},{header:"\u4e3b\u8981\u6307\u6807",dataIndex:"filter_field",width:110,align:"center",sortable:!1,hideable:!1},
{header:"\u6761\u4ef6\u7b26\u53f7",dataIndex:"filter_type",width:60,align:"center",sortable:!1,hideable:!1,editor:rb,renderer:function(a,d,b){d=R.find("math_type_id",a);return-1!=d?R.getAt(d).data.math_type:a}},{header:"<center>\u8f93\u5165\u5185\u5bb9</center>",dataIndex:"contents",width:100,align:"right",sortable:!1,hideable:!1,editor:sb,renderer:function(a,d,b){return isNaN(a)?a:Ext.util.Format.number(a,"0,000.0")}},{header:"\u9690\u85cfdataindex",dataIndex:"dataindex",hidden:!0,hideable:!1},{header:"\u9690\u85cfsortid",
dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),ca=new Ext.grid.EditorGridPanel({cm:ub,sm:tb,id:"large_filter_panel_gridpanel",border:!1,clicksToEdit:1,store:u,autoExpandColumn:4,viewConfig:{forceFit:!1}});Ext.getCmp("large_filter_panel_gridpanel").on("afteredit",function(a){V()});var B=new Ext.data.JsonStore({fields:[{name:"filter_field",mapping:"filter_field"},{name:"CH_conditions",mapping:"CH_conditions"},{name:"EN_conditions",mapping:"EN_conditions"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),
vb=new Ext.grid.CheckboxSelectionModel,wb=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,{header:"\u5217\u540d",dataIndex:"filter_field",hidden:!0,hideable:!1},{header:"<center>\u8bbe\u7f6e\u7684\u6761\u4ef6</center>",dataIndex:"CH_conditions",width:100,align:"left",sortable:!1,hideable:!1},{header:"\u9690\u85cf\u6761\u4ef6",width:100,dataIndex:"EN_conditions",align:"left",sortable:!1,hideable:!1,hidden:!0},{header:"\u9690\u85cfsortid",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),
S=new Ext.grid.EditorGridPanel({cm:wb,sm:vb,id:"large_filter_panel_onlyread_gridpanel",border:!1,clicksToEdit:1,store:B,viewConfig:{forceFit:!0}}),xb=new Ext.Panel({title:"\u5df2\u7ecf\u8bbe\u7f6e\u7684\u6761\u4ef6",border:!1,layout:"fit",items:[S]}),U=new Ext.Panel({layout:"border",border:!1,items:[{title:"\u6240\u6709\u6307\u6807",region:"west",width:180,fill:!0,layout:"fit",split:!0,collapsible:!0,collapseMode:"mini",items:[za]},{title:"\u81ea\u5b9a\u4e49\u6761\u4ef6",region:"center",fill:!0,layout:"fit",
tbar:[{xtype:"button",text:"\u5220\u9664",tooltip:"\u5220\u9664\u9009\u4e2d\u7684\u7b5b\u9009\u6761\u4ef6",iconCls:"sel_left",id:"large_filter_panel_removesingle",handler:function(){var a=ca.getSelectionModel(),d=a.getCount();0<d?(a=1==d?a.getSelected():a.getSelections(),u.remove(a),V(),u.commitChanges()):Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u6761\u4ef6!")}},"-",{xtype:"button",text:"\u6e05\u7a7a",tooltip:"\u6e05\u9664\u6240\u6709\u7684\u7b5b\u9009\u6761\u4ef6",
iconCls:"select_clear",id:"large_filter_panel_clear",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u6e05\u7a7a\u6761\u4ef6\u5417?",function(a){"yes"==a&&(u.removeAll(),u.commitChanges(),B.removeAll(),B.commitChanges(),v=" ")})}},"->","-",{xtype:"button",text:"\u786e\u5b9a",tooltip:"\u7b5b\u9009",iconCls:"accept",id:"large_filter_panel_submit",handler:function(){u.commitChanges();var a=u.getCount(),d=[],b=[],c=[],e=[];if(0<a){for(var f=" ",h=0;h<=a-1;h++){var f=
u.data.items[h].data.dataindex,l=u.data.items[h].data.filter_type,g=u.data.items[h].data.contents;d.push(u.data.items[h].data.either);b.push(f);c.push(l);e.push(g)}for(h=a=0;h<=e.length-1;h++)0==e[h].replace(" ","").length&&(a+=1);if(0<a)Ext.Msg.alert("\u9519\u8bef","\u8bf7\u8f93\u5165\u6761\u4ef6\u5185\u5bb9!");else{f=" ";a=B.getCount();for(h=0;h<=a-1;h++)e=B.data.items[h].data.filter_field,d=fun_newcolumn_dataindexformula("EN_formula",e,"new_field",H),0<d.length?(b=B.data.items[h].data.EN_conditions,
b=b.replace(e,"( "+d+") "),f=f+" ("+b+") and "):f=f+" ("+B.data.items[h].data.EN_conditions+") and ";v=f=f.substring(0,f.length-4);grid_store_reload(L,E,N,"operation",y+"@"+z+"@"+v+"@"+w+"@"+A,p);U.hide()}}else v=" ",grid_store_reload(L,E,N,"operation",y+"@"+z+"@"+v+"@"+w+"@"+A,p),U.hide()}}],items:[{layout:"border",border:!1,items:[{region:"north",fill:!0,height:200,layout:"fit",split:!0,items:[ca]},{region:"center",fill:!0,layout:"fit",items:[xb]}]}]}]}),U=new Ext.Window({title:"\u7b5b\u9009",width:550,
height:420,resizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[U]}),Ga=new Ext.tree.AsyncTreeNode({id:"root",expanded:!0,text:"\u6307\u6807",children:eval(fun_tree_listname_onlyfield(g,8))}),yb=new Ext.tree.TreePanel({id:"large_newcolumn_panel_tree",el:"large_newcolumn_panel_tree",plain:!0,baseCls:"x-plain",frame:!0,autoScroll:!0,animate:!0,enableDD:!1,containerScroll:!0,border:!1,rootVisible:!0,root:Ga});Ext.getCmp("large_newcolumn_panel_tree").on("click",
function(a){if(a.leaf){a=a.attributes.text;var d=Ext.getCmp("large_newcolumn_panel_textformula").getValue(),d=d.substring(0,M)+a+d.substring(M,d.length);Ext.getCmp("large_newcolumn_panel_textformula").setValue(d);M+=a.length}});var H=new Ext.data.JsonStore({fields:[{name:"new_field",mapping:"new_field"},{name:"CH_formula",mapping:"CH_formula"},{name:"EN_formula",mapping:"EN_formula"},{name:"sort_flag",mapping:"sort_flag"}],root:"records"}),zb=new Ext.grid.CheckboxSelectionModel,Ab=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer,
{header:"\u65b0\u589e\u5b57\u6bb5",width:40,dataIndex:"new_field",align:"center",sortable:!1,hideable:!1},{header:"<center>\u5b57\u6bb5\u516c\u5f0f</center>",dataIndex:"CH_formula",width:100,align:"left",sortable:!1,hideable:!1},{header:"\u9690\u85cf\u516c\u5f0f",width:100,dataIndex:"EN_formula",align:"left",sortable:!1,hideable:!1,hidden:!0},{header:"\u9690\u85cfsortid",dataIndex:"sort_flag",hidden:!0,hideable:!1}]}),da=new Ext.grid.EditorGridPanel({cm:Ab,sm:zb,id:"large_newcolumn_panel_onlyread_gridpanel",
border:!1,clicksToEdit:1,store:H,viewConfig:{forceFit:!0}}),Bb=new Ext.Panel({border:!1,layout:"fit",items:[da]}),ba=new Ext.Panel({layout:"border",border:!1,items:[{title:"\u6240\u6709\u6307\u6807",region:"west",width:180,fill:!0,layout:"fit",split:!0,collapseMode:"mini",items:[yb]},{region:"center",fill:!0,layout:"fit",items:[{layout:"border",border:!1,items:[{region:"north",fill:!0,border:!1,height:160,layout:"fit",items:[{layout:"form",labelAlign:"top",border:!1,bbar:["->","-",{xtype:"button",
text:"\u65b0\u589e",tooltip:"\u5373\u65f6\u5728\u4e3b\u8868\u4e2d\u65b0\u589e\u81ea\u5b9a\u4e49\u6307\u6807",iconCls:"add",handler:function(){var a=Ext.getCmp("large_newcolumn_panel_textname").getValue();if("\u4e0d\u5141\u8bb8\u4e3a\u7a7a"==trim(a)||0==trim(a).length)Ext.Msg.alert("\u9519\u8bef","\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a!");else{var d=Ext.getCmp("large_newcolumn_panel_textformula").getValue(),b=d,c=d,e=d;if("\u4ec5\u9650(,+,-,*,/,)\u7b49\u56db\u5219\u8fd0\u7b97\u7b26"!=e||0!=trim(d).length){0<=
e.indexOf("(")&&(e=e.replace(/\(/g," "));0<=e.indexOf(")")&&(e=e.replace(/\)/g," "));0<=e.indexOf("+")&&(e=e.replace(/\+/g," "));0<=e.indexOf("-")&&(e=e.replace(/\-/g," "));0<=e.indexOf("*")&&(e=e.replace(/\*/g," "));0<=e.indexOf("/")&&(e=e.replace(/\//g," "));for(var f=trim(multi_trim_one(e)).split(" "),h=e=0;h<f.length;h++)!fun_gridfieldname_exists(trim(f[h]),g)&&isNaN(trim(f[h]))&&(e=1);if(1==e)Ext.Msg.alert("\u516c\u5f0f\u9519\u8bef","\u8f93\u5165\u6307\u6807\u9519\u8bef!");else{for(h=0;h<f.length;h++)fun_gridfieldname_exists(trim(f[h]),
g)&&(c=c.replace(f[h],1));Ext.Ajax.request({url:"../ActionController/ExpressionJexl.jsp",params:{Exp:c},callback:function(c,e,k){if(e)if("Error"==trim(k.responseText))Ext.MessageBox.alert("\u9519\u8bef","\u516c\u5f0f\u6709\u9519\u8bef,\u8bf7\u68c0\u67e5!");else{for(h=0;h<f.length;h++)fun_gridfieldname_exists(trim(f[h]),g)&&(c=fun_treenodetext_dataindex(f[h],Ga),b=b.replace(f[h],"CAST("+c+" as decimal(24,2))"));e=Ext.getCmp("grid").getColumnModel().getColumnCount();c=H.getCount();e=new Ext.data.Record({new_field:a,
CH_formula:d,EN_formula:b,sort_flag:e});da.stopEditing();H.insert(c,e);da.startEditing(0,1);H.commitChanges();Ext.getCmp("large_newcolumn_panel_textname").reset();Ext.getCmp("large_newcolumn_panel_textformula").reset();Ta()}else Ext.MessageBox.alert("\u9519\u8bef","\u516c\u5f0f\u6709\u9519\u8bef,\u8bf7\u68c0\u67e5!")}})}}}}},{xtype:"button",text:"\u5220\u9664",tooltip:"\u5373\u65f6\u5728\u4e3b\u8868\u4e2d\u5220\u9664\u9009\u4e2d\u81ea\u5b9a\u4e49\u6307\u6807",iconCls:"delete",handler:function(){H.getCount();
var a=da.getSelectionModel(),d=a.getCount();0==d?Ext.Msg.alert("\u9519\u8bef","\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u81ea\u5b9a\u4e49\u5217!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5220\u9664\u65b0\u589e\u5217\u5417?",function(b){if("yes"==b)if(1==d){var c=a.getSelected();H.remove(c);g.removeColumn(c.get("new_field"));for(b=0;b<=m.getCount()-1;b++){var e=m.data.items[b].data;e.find_field==c.get("new_field")&&m.removeAt(b)}0<m.getCount()&&m.getAt(0).set("default_id",
"\u4e3b\u8981\u5173\u952e\u5b57");for(b=0;b<=C.getCount()-1;b++)e=C.data.items[b].data,e.filter_field==c.get("new_field")&&C.removeAt(b);for(b=0;b<=u.getCount()-1;b++)e=u.data.items[b].data,e.filter_field==c.get("new_field")&&(u.removeAt(b),V())}else if(1<d)for(c=a.getSelections(),H.remove(c),b=0;b<=c.length-1;b++){g.removeColumn(c[b].get("new_field"));for(var f=0;f<=m.getCount()-1;f++)e=m.data.items[f].data,e.find_field==c[b].get("new_field")&&m.removeAt(f);0<m.getCount()&&m.getAt(0).set("default_id",
"\u4e3b\u8981\u5173\u952e\u5b57");for(f=0;f<=C.getCount()-1;f++)e=C.data.items[f].data,e.filter_field==c[b].get("new_field")&&C.removeAt(f);for(f=0;f<=u.getCount()-1;f++)e=u.data.items[f].data,e.filter_field==c[b].get("new_field")&&(u.removeAt(f),V())}})}},"-",{xtype:"button",text:"\u5173\u95ed",tooltip:"\u5173\u95ed\u6539\u9875\u9762",iconCls:"deldt",handler:function(){ba.hide()}}],bodyStyle:"padding:3px 0 0 3px",items:[{xtype:"textfield",allowBlank:!0,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",
emptyText:"\u4ec5\u5b57\u6bcd\u6216\u6c49\u5b57",fieldLabel:"\u540d\u79f0",id:"large_newcolumn_panel_textname",anchor:"98%",listeners:{blur:function(a){0!=this.getValue().length&&(fun_gridfieldname_exists(this.getValue(),g)&&(Ext.Msg.alert("\u63d0\u793a","\u540d\u5b57\u91cd\u590d!"),this.focus(!0)),isCHENChar(this.getValue())||(Ext.Msg.alert("\u9519\u8bef","\u8f93\u5165\u4ec5\u5b57\u6bcd\u6216\u6c49\u5b57!"),this.focus(!0)))}}},{xtype:"textfield",fieldLabel:"\u516c\u5f0f",emptyText:"\u4ec5\u9650(,+,-,*,/,)\u7b49\u56db\u5219\u8fd0\u7b97\u7b26",
blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",id:"large_newcolumn_panel_textformula",anchor:"98%",listeners:{focus:function(){},keyup:function(a,d){},blur:function(){M=Ext.getDom("large_newcolumn_panel_textformula").selectionStart}}},{xtype:"buttongroup",border:!1,width:100,defaults:{handler:function(a){var d=Ext.getCmp("large_newcolumn_panel_textformula").getValue(),d=d.substring(0,M)+a.symbol+d.substring(M,d.length);Ext.getCmp("large_newcolumn_panel_textformula").setValue(d);M+=a.symbol.length}},columns:6,
items:[{text:"(",width:25,tooltip:"\u524d\u62ec\u53f7",symbol:"("},{text:")",width:25,tooltip:"\u540e\u62ec\u53f7",symbol:")",style:"margin-left : 5px;"},{text:"+",width:25,tooltip:"\u52a0",symbol:"+",style:"margin-left : 5px;"},{text:"-",width:25,tooltip:"\u51cf",symbol:"-",style:"margin-left : 5px;"},{text:"\u00f7",width:25,tooltip:"\u9664",symbol:"/",style:"margin-left : 5px;"},{text:"*",width:25,tooltip:"\u4e58",symbol:"*",style:"margin-left : 5px;"}]}]}]},{region:"center",fill:!0,border:!1,layout:"fit",
items:[Bb]}]}]}]}),ba=new Ext.Window({title:"\u65b0\u589e\u81ea\u5b9a\u4e49\u5217",width:550,height:310,resizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[ba]}),Ba=new Ext.data.SimpleStore({fields:["dataname","dataindex"]}),Ca=new Ext.data.SimpleStore({fields:["valuename","valueindex"]}),Cb=new Ext.data.SimpleStore({fields:["typename","typeindex"],data:[["\u8ba1\u6570","count"],["\u6c42\u548c","sum"],["\u5e73\u5747\u503c","avg"],["\u6700\u5927\u503c",
"max"],["\u6700\u5c0f\u503c","min"]]}),aa=new Ext.FormPanel({labelAlign:"left",border:!0,frame:!1,labelWidth:75,bodyStyle:"padding:5px",bbar:[{xtype:"tbspacer"},{xtype:"splitbutton",text:"\u6392\u5e8f\u4e0e\u7b5b\u9009",iconCls:"sortandfilter",menu:[{text:"\u6392\u5e8f",iconCls:"small_sort",tooltip:"\u663e\u793a\u6392\u5e8f\u5bf9\u8bdd\u6846\uff0c\u4e00\u6b21\u6027\u6839\u636e\u591a\u4e2a\u6761\u4ef6\u8fdb\u884c\u6392\u5e8f",handler:function(){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")?
(Ha.loadData(eval(fun_combox_listname(Ext.getCmp("large_summary_panel_showresult_gridpanel")))),ia.show()):Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u6570\u636e\u53ef\u6392\u5e8f!")}},"-",{text:"\u7b5b\u9009",tooltip:"\u663e\u793a\u7b5b\u9009\u5bf9\u8bdd\u6846,\u5bf9\u6307\u6807\u8fdb\u884c\u81ea\u5b9a\u4e49\u7b5b\u9009",iconCls:"small_filter",handler:function(){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")?(ja.loadData(eval(fun_combox_listname(Ext.getCmp("large_summary_panel_showresult_gridpanel")))),
ea.show()):Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u6570\u636e\u53ef\u7b5b\u9009!")}},{text:"\u53d6\u6d88\u7b5b\u9009",tooltip:"\u53d6\u6d88\u5206\u7c7b\u6c47\u603b\u7b5b\u9009\u7684\u6240\u6709\u6761\u4ef6",iconCls:"clear_filter",handler:function(){if(void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")){Ext.getCmp("large_summary_panel_filterpanel_textfield1").reset();Ext.getCmp("large_summary_panel_filterpanel_textfield2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname1").reset();
Ext.getCmp("large_summary_panel_filterpanel_groupname2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath1").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath2").reset();D=" ";var a=y+"@"+z+"@"+v+"@"+w+"@"+A+"@"+O+"@"+G+"@"+D;grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,E,Ext.getCmp("GroupBy_PagingToolbar"),"operation",a,p)}}}]},"-",{xtype:"CopyButton",text:"\u590d\u5236",id:"summary_copybutton",tooltip:"\u590d\u5236",iconCls:"copy_small"},
"-",{xtype:"button",text:"\u5bfc\u51fa",id:"large_summary_panel_export",tooltip:"\u5bfc\u51faexcel",iconCls:"export_small",handler:function(){void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")?Ext.Ajax.request({url:"GetexportRows",params:{rights:p},callback:function(a,d,b){if(d){var c=Ext.getCmp("large_summary_panel_showresult_gridpanel").store.getCount();a=trim(b.responseText);J=parseInt(trim(a.split("@")[0]));d=trim(a.split("@")[1]);b=trim(a.split("@")[2]);var e=parseInt(trim(a.split("@")[3])),
f=parseInt(trim(a.split("@")[4]));""==b?c>J?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+J+"\u6761!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(Ext.getCmp("large_summary_panel_showresult_gridpanel")),Ext.Ajax.request({url:"SaveExportActions",params:{rights:p,exportbutton:2,exportedrows:c},callback:function(a,c,d){}}))}):(d=parseInt(trim(a.split("@")[1])),b=parseInt(trim(a.split("@")[2])),c>
J?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u6743\u9650\u53ea\u80fd\u5bfc\u51fa"+J+"\u6761!"):b+1>f?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u6b21\u6570!"):d+c>=e?Ext.Msg.alert("\u63d0\u793a","\u8be5\u8d26\u6237\u5728\u5f53\u6708\u5df2\u7ecf\u7d2f\u8ba1\u8d85\u8fc7\u5bfc\u51fa\u884c\u6570!"):Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5bfc\u51fa?",function(a){"yes"==a&&(exported(Ext.getCmp("large_summary_panel_showresult_gridpanel")),
Ext.Ajax.request({url:"SaveExportActions",params:{rights:p,exportbutton:2,exportedrows:c},callback:function(a,c,d){}}))}))}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}):Ext.Msg.alert("\u63d0\u793a","\u6ca1\u6709\u6570\u636e\u53ef\u5bfc\u51fa!")}},"->","-",{xtype:"button",text:"\u786e\u5b9a",tooltip:"\u786e\u5b9a",id:"large_summary_panel_submit",iconCls:"accept",handler:function(){Ext.getCmp("large_summary_panel_sortpanel_groupname").reset();
Ext.getCmp("large_summary_panel_sortpanel_type").reset();Ext.getCmp("large_summary_panel_filterpanel_textfield1").reset();Ext.getCmp("large_summary_panel_filterpanel_textfield2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname1").reset();Ext.getCmp("large_summary_panel_filterpanel_groupname2").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath1").reset();Ext.getCmp("large_summary_panel_filterpanel_groupmath2").reset();D=G=" ";var a=Ext.getCmp("large_summary_panel_groupname").getValue(),
d=Ext.getCmp("large_summary_panel_groupname").getRawValue(),b=Ext.getCmp("large_summary_panel_valuename").getValue(),c=Ext.getCmp("large_summary_panel_valuename").getRawValue(),e=Ext.getCmp("large_summary_panel_type").getValue(),f=Ext.getCmp("large_summary_panel_type").getRawValue(),c=replaceAll(c,"\\[\u4e07\\]",""),c=replaceAll(c,"\\[\u52a9\u7406\\]","\u542b\u52a9\u7406");if(0==trim(a).length||0==trim(b).length||0==trim(e).length)Ext.Msg.alert("\u63d0\u793a","\u5b57\u6bb5\u4e0d\u5141\u8bb8\u4e3a\u7a7a!");
else{var h="",l="";if(0<=b.indexOf(",")){for(var b=b.split(","),c=c.split(","),g=0;g<=b.length-1;g++)g==b.length-1?(l=l+e+"("+b[g]+") as "+c[g]+"_"+e,h=h+"{header: '"+c[g]+"_"+f+"',dataIndex: '"+trim(c[g])+"_"+trim(e)+"',align : 'right',width:150,xtype:'numbercolumn',format : '0,00.0',sortable: false}"):(l=l+e+"("+b[g]+") as "+c[g]+"_"+e+",",h=h+"{header: '"+c[g]+"_"+f+"',dataIndex: '"+trim(c[g])+"_"+trim(e)+"',align : 'right',width:150,xtype:'numbercolumn',format : '0,00.0',sortable: false},");l=
a+","+l}else l=a+","+e+"("+b+") as "+c+"_"+e,h="{header: '"+c+"_"+f+"',dataIndex: '"+trim(c)+"_"+trim(e)+"',width:150,align : 'right',xtype:'numbercolumn',format : '0,00.0',sortable: false}";O=l;a=0<="\u7701\u4efd".indexOf(d)?"[new Ext.grid.RowNumberer({width:30}),{header: '\u884c\u653f\u533a\u5212\u4ee3\u7801',dataIndex:'admincode_temp',width:90,sortable: false},{header: '"+d+"',dataIndex: '"+a+"',width:100,sortable: false},"+h+"]":0<="\u5730\u7ea7\u5e02".indexOf(d)?"[new Ext.grid.RowNumberer({width:30}),{header: '\u884c\u653f\u533a\u5212\u4ee3\u7801',dataIndex:'admincode_temp',width:90,sortable: false},{header: '\u7701\u4efd',dataIndex:'province',width:90,sortable: false},{header: '"+
d+"',dataIndex: '"+a+"',width:100,sortable: false},"+h+"]":0<="\u533a\u53bf\u5e02@\u533a\u53bf\u57ce\u5e02".indexOf(d)?"[new Ext.grid.RowNumberer({width:30}),{header: '\u884c\u653f\u533a\u5212\u4ee3\u7801',dataIndex:'admincode_temp',width:90,sortable: false},{header:'\u7701\u4efd',dataIndex:'province',width:90,sortable:false},{header:'\u5730\u7ea7\u5e02',dataIndex:'city',width:90,sortable:false},{header: '"+d+"',dataIndex: '"+a+"',width:100,sortable: false},"+h+"]":"[new Ext.grid.RowNumberer({width:30}),{header: '"+
d+"',dataIndex: '"+a+"',width:100,false: true},"+h+"]";Ua("operation",a,E,y+"@"+z+"@"+v+"@"+w+"@"+A+"@"+O+"@"+G+"@"+D)}}},{xtype:"button",text:"\u5168\u90e8\u5220\u9664",tooltip:"\u5220\u9664\u5206\u7c7b\u6c47\u603b\u7ed3\u679c",id:"large_summary_panel_clear",iconCls:"select_clear",handler:function(){Ext.MessageBox.confirm("\u63d0\u793a","\u786e\u5b9a\u9700\u8981\u5220\u9664\u7ed3\u679c\u5417?",function(a){"yes"==a&&(Ext.getCmp("large_summary_panel_groupname").reset(),Ext.getCmp("large_summary_panel_valuename").reset(),
Ext.getCmp("large_summary_panel_type").reset(),D=G=O=" ",void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel_store")&&Ext.getCmp("large_summary_panel_showresult_gridpanel_store").remove(),void 0!=Ext.getCmp("large_summary_panel_showresult_gridpanel")&&Ext.getCmp("large_summary_panel_showresult_gridpanel").destroy(),void 0!=Ext.getCmp("GroupBy_PagingToolbar")&&Ext.getCmp("GroupBy_PagingToolbar").destroy())})}},{xtype:"button",text:"\u53d6\u6d88",tooltip:"\u5173\u95ed\u5206\u7c7b\u6c47\u603b\u9875\u9762",
id:"large_summary_panel_cancel",iconCls:"deldt",handler:function(){aa.hide()}}],items:[{xtype:"combo",selectOnFocus:!0,store:Ba,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u5206\u7c7b\u5b57\u6bb5",fieldLabel:"\u5206\u7c7b\u5b57\u6bb5",id:"large_summary_panel_groupname",anchor:"85%",listeners:{scope:this,change:function(){D=G=" "}}},{xtype:"multiSelect",
selectOnFocus:!0,store:Ca,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"valuename",valueField:"valueindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u5206\u7c7b\u5b57\u6bb5",fieldLabel:"\u9009\u5b9a\u6c47\u603b\u9879",id:"large_summary_panel_valuename",anchor:"85%",listeners:{scope:this,change:function(){D=G=" "}}},{xtype:"combo",selectOnFocus:!0,store:Cb,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"typename",
valueField:"typeindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6c47\u603b\u65b9\u5f0f",fieldLabel:"\u6c47\u603b\u65b9\u5f0f",id:"large_summary_panel_type",anchor:"85%",listeners:{scope:this,change:function(){D=G=" "}}}]}),Db=new Ext.Panel({layout:"border",border:!1,items:[{region:"north",fill:!0,border:!1,height:115,layout:"fit",items:[aa]},{region:"center",fill:!0,id:"dynamic_panel",border:!1,layout:"fit"}]}),aa=new Ext.Window({title:"\u5206\u7c7b\u6c47\u603b",
width:850,height:450,resizable:!0,maximizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Db]}),Ha=new Ext.data.SimpleStore({fields:["dataname","dataindex"]}),Eb=new Ext.data.SimpleStore({fields:["sortname","sortindex"],data:[["\u5347\u5e8f","asc"],["\u964d\u5e8f","desc"]]}),Fb=new Ext.FormPanel({labelAlign:"top",border:!0,frame:!0,bodyStyle:"padding:5px",buttonAlign:"center",items:[{xtype:"combo",selectOnFocus:!0,store:Ha,mode:"local",triggerAction:"all",
allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u6392\u5e8f\u5b57\u6bb5",fieldLabel:"\u6392\u5e8f\u5b57\u6bb5",id:"large_summary_panel_sortpanel_groupname",anchor:"95%",listeners:{}},{xtype:"combo",selectOnFocus:!0,store:Eb,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"sortname",valueField:"sortindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",
emptyText:"\u6392\u5e8f\u65b9\u5f0f",fieldLabel:"\u6392\u5e8f\u65b9\u5f0f",id:"large_summary_panel_sortpanel_type",anchor:"95%",listeners:{}}],buttons:[{text:"\u786e\u5b9a",tooltip:"\u786e\u5b9a\u6392\u5e8f",id:"large_summary_panel_sortpanel_submit",iconCls:"accept",handler:function(){var a=Ext.getCmp("large_summary_panel_sortpanel_groupname").getValue();Ext.getCmp("large_summary_panel_sortpanel_groupname").getRawValue();var d=Ext.getCmp("large_summary_panel_sortpanel_type").getValue();0!=trim(a).length&&
0!=trim(d).length?(G="order by "+a+" "+d,a=y+"@"+z+"@"+v+"@"+w+"@"+A+"@"+O+"@"+G+"@"+D,grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,E,Ext.getCmp("GroupBy_PagingToolbar"),"operation",a,p),Ext.getCmp("large_summary_panel_sortpanel_groupname").reset(),Ext.getCmp("large_summary_panel_sortpanel_type").reset(),ia.hide()):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u9009\u62e9\u6392\u5e8f\u5b57\u6bb5\u6216\u8005\u6392\u5e8f\u65b9\u5f0f!")}},{text:"\u53d6\u6d88",tooltip:"\u5173\u95ed\u754c\u9762",
id:"large_summary_panel_sortpanel_cancel",iconCls:"deldt",handler:function(){ia.hide()}}]}),ia=new Ext.Window({title:"\u6392\u5e8f",width:250,height:200,resizable:!1,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Fb]}),ja=new Ext.data.SimpleStore({fields:["dataname","dataindex"]}),Ia=new Ext.data.SimpleStore({fields:["mathtype","mathid"],data:[["\u5927\u4e8e",">"],["\u5927\u4e8e\u7b49\u4e8e",">="],["\u7b49\u4e8e","="],["\u4e0d\u7b49\u4e8e","<>"],["\u5c0f\u4e8e",
"<"],["\u5c0f\u4e8e\u7b49\u4e8e","<="]]}),Gb=new Ext.FormPanel({border:!0,frame:!0,bodyStyle:"padding:5px",buttonAlign:"center",items:[{layout:"column",items:[{columnWidth:.4,layout:"form",labelAlign:"top",items:[{xtype:"combo",selectOnFocus:!0,store:ja,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u7b5b\u9009\u5b57\u6bb5",fieldLabel:"\u7b5b\u9009\u5b57\u6bb51",
id:"large_summary_panel_filterpanel_groupname1",width:120},{xtype:"combo",selectOnFocus:!0,store:Ia,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"mathtype",valueField:"mathid",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6761\u4ef6\u7b26\u53f7",fieldLabel:"\u6761\u4ef6\u7b26\u53f71",id:"large_summary_panel_filterpanel_groupmath1",width:80},{xtype:"textfield",allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u8f93\u5165\u6761\u4ef6",
fieldLabel:"\u7b5b\u9009\u6761\u4ef61",id:"large_summary_panel_filterpanel_textfield1",width:100}]},{columnWidth:.2,layout:"form",labelAlign:"top",style:"margin-left:15px",items:[{xtype:"radio",boxLabel:"\u548c",name:"fieldtype",id:"state",inputValue:"and"},{xtype:"radio",boxLabel:"\u6216",name:"fieldtype",inputValue:"or",checked:!0}]},{columnWidth:.4,layout:"form",labelAlign:"top",items:[{xtype:"combo",selectOnFocus:!0,store:ja,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"dataname",
valueField:"dataindex",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u9009\u62e9\u7b5b\u9009\u5b57\u6bb5",fieldLabel:"\u7b5b\u9009\u5b57\u6bb52",id:"large_summary_panel_filterpanel_groupname2",width:120},{xtype:"combo",selectOnFocus:!0,store:Ia,mode:"local",triggerAction:"all",allowBlank:!0,displayField:"mathtype",valueField:"mathid",forceSelection:!1,resizable:!0,allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u6761\u4ef6\u7b26\u53f7",
fieldLabel:"\u6761\u4ef6\u7b26\u53f72",id:"large_summary_panel_filterpanel_groupmath2",width:80},{xtype:"textfield",allowBlank:!1,blankText:"\u4e0d\u5141\u8bb8\u4e3a\u7a7a",emptyText:"\u8f93\u5165\u6761\u4ef6",fieldLabel:"\u7b5b\u9009\u6761\u4ef62",id:"large_summary_panel_filterpanel_textfield2",width:100}]}]}],buttons:[{text:"\u786e\u5b9a",tooltip:"\u786e\u5b9a\u7b5b\u9009",id:"large_summary_panel_filterpanel_submit",iconCls:"accept",handler:function(){var a=trim(Ext.getCmp("large_summary_panel_filterpanel_textfield1").getValue()),
d=trim(Ext.getCmp("large_summary_panel_filterpanel_groupname1").getValue()),b=trim(Ext.getCmp("large_summary_panel_filterpanel_groupmath1").getValue());if(0==a.length||0==d.length||0==b)Ext.Msg.alert("\u63d0\u793a","\u8bf7\u7b5b\u9009\u6761\u4ef6\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u586b\u5199!");else{var c="",c=0<=d.indexOf("District")||0<=d.indexOf("City")||0<=d.indexOf("Province")?d+b+" '"+trim(a)+"' ":d+b+a,a=trim(Ext.getCmp("large_summary_panel_filterpanel_textfield2").getValue()),d=trim(Ext.getCmp("large_summary_panel_filterpanel_groupname2").getValue()),
b=trim(Ext.getCmp("large_summary_panel_filterpanel_groupmath2").getValue());if(0<a.length&&0<d.length&&0<b.length){var e=Ext.getCmp("state").getGroupValue(),f="",f=0<=d.indexOf("District")||0<=d.indexOf("City")||0<=d.indexOf("Province")?d+" "+b+" '"+a+"' ":d+" "+b+" "+a;D=c+" "+e+" "+f;c=y+"@"+z+"@"+v+"@"+w+"@"+A+"@"+O+"@"+G+"@"+D;grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,E,Ext.getCmp("GroupBy_PagingToolbar"),"operation",c,p);ea.hide()}else 0==a.length&&0==d.length&&
0==b.length?(D=c,c=y+"@"+z+"@"+v+"@"+w+"@"+A+"@"+O+"@"+G+"@"+D,grid_store_reload(Ext.getCmp("large_summary_panel_showresult_gridpanel").store,E,Ext.getCmp("GroupBy_PagingToolbar"),"operation",c,p),ea.hide()):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u7b5b\u9009\u6761\u4ef6\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u586b\u5199!")}}},{text:"\u53d6\u6d88",tooltip:"\u5173\u95ed\u9875\u9762",id:"large_summary_panel_filterpanel_cancel",iconCls:"deldt",handler:function(){ea.hide()}}]}),ea=new Ext.Window({title:"\u7b5b\u9009",
width:360,height:230,resizable:!1,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Gb]}),Ja=new Ext.Toolbar({plain:!0,id:"barchart_tbar"});Ja.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"barchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"barchart_summit",handler:function(){if(0==n){var a=Ext.getCmp("singlebarchart_majortitle").getValue(),d=Ext.getCmp("singlebarchart_charttype").getValue(),
b=Ext.getCmp("singlebarchart_charttype").getRawValue(),c=Ext.getCmp("singlebarchart_haxis").getValue();Ext.getCmp("singlebarchart_haxis").getRawValue();var e=Ext.getCmp("singlebarchart_vaxis").getValue(),f=Ext.getCmp("singlebarchart_vaxis").getRawValue(),h=Ext.getCmp("singlebarchart_subtitle").getValue(),g=Ext.getCmp("singlebarchart_haxisname").getValue(),m=Ext.getCmp("singlebarchart_vaxisname").getValue(),k=0,q=Ext.getCmp("barchart_label").getValue(),k=q?1:0;0==trim(d).length||0==trim(c).length||
0==trim(e).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(q=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:q,haxis:c,vaxis:e,dbname:"operation",rights:p},callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("barchartContainer",d,0,a,h,g,m,k,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else.1==n?(a=Ext.getCmp("multibarchart_majortitle").getValue(),
d=Ext.getCmp("multibarchart_charttype").getValue(),b=Ext.getCmp("multibarchart_charttype").getRawValue(),c=Ext.getCmp("multibarchart_haxis").getValue(),Ext.getCmp("multibarchart_haxis").getRawValue(),e=Ext.getCmp("multibarchart_vaxis").getValue(),f=Ext.getCmp("multibarchart_vaxis").getRawValue(),h=Ext.getCmp("multibarchart_subtitle").getValue(),g=Ext.getCmp("multibarchart_haxisname").getValue(),m=Ext.getCmp("multibarchart_vaxisname").getValue(),k=0,k=(q=Ext.getCmp("barchart_label").getValue())?1:
0,0==trim(d).length||0==trim(c).length||0==trim(e).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(q=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:q,haxis:c,vaxis:e,dbname:"operation",rights:p},callback:function(c,q,n){if(q){c=trim(n.responseText);if(0<=f.indexOf(",")){q=f.split(",");n=e.split(",");for(var p=0;p<=q.length-1;p++)c=c.replace(trim(n[p]),trim(q[p]))}else c=c.replace(e,f);"\u4e09\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)"==
b||"\u4e8c\u7ef4\u5806\u79ef\u67f1\u5f62\u56fe(100%)"==b?renderCharts("barchartContainer",d,1.1,a,h,g,m,k,c):renderCharts("barchartContainer",d,1,a,h,g,m,k,c)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Hb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",
width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlebarchart_accordingpanel",bbar:Ja,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u67f1\u5f62\u8868",autoScroll:!0,border:!1,forceFit:!0,id:"singlebarchart_panel",iconCls:"chart_bar_edit",listeners:{expand:function(a){n=0;oa(g,8);Ext.getCmp("singlebarchart_panel").remove(Ext.getCmp("singlebarchart_form"));Ext.getCmp("singlebarchart_panel").add(Ext.getCmp("singlebarchart_form"));Ext.getCmp("singlebarchart_panel").doLayout()},
afterRender:function(){n=0;oa(g,8);Ext.getCmp("singlebarchart_panel").add(Ext.getCmp("singlebarchart_form"));Ext.getCmp("singlebarchart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u67f1\u5f62\u8868",autoScroll:!0,border:!1,forceFit:!0,id:"multibarchart_panel",iconCls:"chart_bar_edit",listeners:{expand:function(a){n=.1;Va(g,8);Ext.getCmp("multibarchart_panel").remove(Ext.getCmp("multibarchart_form"));Ext.getCmp("multibarchart_panel").add(Ext.getCmp("multibarchart_form"));Ext.getCmp("multibarchart_panel").doLayout()}}}]},
{region:"center",fill:!0,layout:"fit",html:"<div id = 'barchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),cb=new Ext.Window({title:"\u67f1\u5f62\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Hb]}),Ka=new Ext.Toolbar({plain:!0,id:"columnchart_tbar"});Ka.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"columnchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",
tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"columnchart_summit",handler:function(){if(1==n){var a=Ext.getCmp("singlecolumnchart_majortitle").getValue(),d=Ext.getCmp("singlecolumnchart_charttype").getValue();Ext.getCmp("singlecolumnchart_charttype").getRawValue();var b=Ext.getCmp("singlecolumnchart_haxis").getValue();Ext.getCmp("singlecolumnchart_haxis").getRawValue();var c=Ext.getCmp("singlecolumnchart_vaxis").getValue(),e=Ext.getCmp("singlecolumnchart_vaxis").getRawValue(),f=Ext.getCmp("singlecolumnchart_subtitle").getValue(),
g=Ext.getCmp("singlecolumnchart_haxisname").getValue(),l=Ext.getCmp("singlecolumnchart_vaxisname").getValue(),m=0,k=Ext.getCmp("columnchart_label").getValue(),m=k?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"operation",rights:p},callback:function(c,b,e){b?(c=trim(e.responseText),
renderCharts("columnchartContainer",d,0,a,f,g,l,m,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else 1.1==n?(a=Ext.getCmp("multicolumnchart_majortitle").getValue(),d=Ext.getCmp("multicolumnchart_charttype").getValue(),Ext.getCmp("multicolumnchart_charttype").getRawValue(),b=Ext.getCmp("multicolumnchart_haxis").getValue(),Ext.getCmp("multicolumnchart_haxis").getRawValue(),c=Ext.getCmp("multicolumnchart_vaxis").getValue(),e=Ext.getCmp("multicolumnchart_vaxis").getRawValue(),
f=Ext.getCmp("multicolumnchart_subtitle").getValue(),g=Ext.getCmp("multicolumnchart_haxisname").getValue(),l=Ext.getCmp("multicolumnchart_vaxisname").getValue(),m=0,m=(k=Ext.getCmp("columnchart_label").getValue())?1:0,0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"operation",
rights:p},callback:function(b,k,r){if(k){b=trim(r.responseText);if(0<=e.indexOf(",")){k=e.split(",");r=c.split(",");for(var n=0;n<=k.length-1;n++)b=b.replace(trim(r[n]),trim(k[n]))}else b=b.replace(c,e);renderCharts("columnchartContainer",d,1,a,f,g,l,m,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Ib=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlecolumnchart_accordingpanel",bbar:Ka,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u6761\u5f62\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlecolumnchart_panel",iconCls:"chart_column_edit",listeners:{expand:function(a){n=1;pa(g,8);Ext.getCmp("singlecolumnchart_panel").remove(Ext.getCmp("singlecolumnchart_form"));Ext.getCmp("singlecolumnchart_panel").add(Ext.getCmp("singlecolumnchart_form"));
Ext.getCmp("singlecolumnchart_panel").doLayout()},afterRender:function(){n=1;pa(g,8);Ext.getCmp("singlecolumnchart_panel").add(Ext.getCmp("singlecolumnchart_form"));Ext.getCmp("singlecolumnchart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u6761\u5f62\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multicolumnchart_panel",iconCls:"chart_column_edit",listeners:{expand:function(a){n=1.1;Wa(g,8);Ext.getCmp("multicolumnchart_panel").remove(Ext.getCmp("multicolumnchart_form"));Ext.getCmp("multicolumnchart_panel").add(Ext.getCmp("multicolumnchart_form"));
Ext.getCmp("multicolumnchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'columnchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),gb=new Ext.Window({title:"\u6761\u5f62\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Ib]}),La=new Ext.Toolbar({plain:!0,id:"linechart_tbar"});La.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"linechart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"linechart_summit",handler:function(){if(2==n){var a=Ext.getCmp("singlelinechart_majortitle").getValue(),d=Ext.getCmp("singlelinechart_charttype").getValue();Ext.getCmp("singlelinechart_charttype").getRawValue();var b=Ext.getCmp("singlelinechart_haxis").getValue();Ext.getCmp("singlelinechart_haxis").getRawValue();var c=Ext.getCmp("singlelinechart_vaxis").getValue(),e=Ext.getCmp("singlelinechart_vaxis").getRawValue(),
f=Ext.getCmp("singlelinechart_subtitle").getValue(),g=Ext.getCmp("singlelinechart_haxisname").getValue(),l=Ext.getCmp("singlelinechart_vaxisname").getValue(),m=0,k=Ext.getCmp("linechart_label").getValue(),m=k?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"operation",rights:p},
callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("linechartContainer",d,0,a,f,g,l,m,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else 2.1==n?(a=Ext.getCmp("multilinechart_majortitle").getValue(),d=Ext.getCmp("multilinechart_charttype").getValue(),Ext.getCmp("multilinechart_charttype").getRawValue(),b=Ext.getCmp("multilinechart_haxis").getValue(),Ext.getCmp("multilinechart_haxis").getRawValue(),c=Ext.getCmp("multilinechart_vaxis").getValue(),
e=Ext.getCmp("multilinechart_vaxis").getRawValue(),f=Ext.getCmp("multilinechart_subtitle").getValue(),g=Ext.getCmp("multilinechart_haxisname").getValue(),l=Ext.getCmp("multilinechart_vaxisname").getValue(),m=0,m=(k=Ext.getCmp("linechart_label").getValue())?1:0,0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:k,
haxis:b,vaxis:c,dbname:"operation",rights:p},callback:function(b,k,n){if(k){b=trim(n.responseText);if(0<=e.indexOf(",")){k=e.split(",");n=c.split(",");for(var p=0;p<=k.length-1;p++)b=b.replace(trim(n[p]),trim(k[p]))}else b=b.replace(c,e);renderCharts("linechartContainer",d,1,a,f,g,l,m,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Jb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlelinechart_accordingpanel",bbar:La,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u6298\u7ebf\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlelinechart_panel",iconCls:"chart_line_edit",listeners:{expand:function(a){n=2;qa(g,8);Ext.getCmp("singlelinechart_panel").remove(Ext.getCmp("singlelinechart_form"));Ext.getCmp("singlelinechart_panel").add(Ext.getCmp("singlelinechart_form"));
Ext.getCmp("singlelinechart_panel").doLayout()},afterRender:function(){n=2;qa(g,8);Ext.getCmp("singlelinechart_panel").add(Ext.getCmp("singlelinechart_form"));Ext.getCmp("singlelinechart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u6298\u7ebf\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multilinechart_panel",iconCls:"chart_line_edit",listeners:{expand:function(a){n=2.1;Xa(g,8);Ext.getCmp("multilinechart_panel").remove(Ext.getCmp("multilinechart_form"));Ext.getCmp("multilinechart_panel").add(Ext.getCmp("multilinechart_form"));
Ext.getCmp("multilinechart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'linechartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),db=new Ext.Window({title:"\u6298\u7ebf\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Jb]}),Ma=new Ext.Toolbar({plain:!0,id:"areachart_tbar"});Ma.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"areachart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"areachart_summit",handler:function(){if(3==n){var a=Ext.getCmp("singleareachart_majortitle").getValue(),d=Ext.getCmp("singleareachart_charttype").getValue();Ext.getCmp("singleareachart_charttype").getRawValue();var b=Ext.getCmp("singleareachart_haxis").getValue();Ext.getCmp("singleareachart_haxis").getRawValue();var c=Ext.getCmp("singleareachart_vaxis").getValue(),e=Ext.getCmp("singleareachart_vaxis").getRawValue(),
f=Ext.getCmp("singleareachart_subtitle").getValue(),g=Ext.getCmp("singleareachart_haxisname").getValue(),l=Ext.getCmp("singleareachart_vaxisname").getValue(),m=0,k=Ext.getCmp("areachart_label").getValue(),m=k?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:k,haxis:b,vaxis:c,dbname:"operation",rights:p},
callback:function(c,b,e){b?(c=trim(e.responseText),renderCharts("areachartContainer",d,0,a,f,g,l,m,c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else 3.1==n?(a=Ext.getCmp("multiareachart_majortitle").getValue(),d=Ext.getCmp("multiareachart_charttype").getValue(),Ext.getCmp("multiareachart_charttype").getRawValue(),b=Ext.getCmp("multiareachart_haxis").getValue(),Ext.getCmp("multiareachart_haxis").getRawValue(),c=Ext.getCmp("multiareachart_vaxis").getValue(),
e=Ext.getCmp("multiareachart_vaxis").getRawValue(),f=Ext.getCmp("multiareachart_subtitle").getValue(),g=Ext.getCmp("multiareachart_haxisname").getValue(),l=Ext.getCmp("multiareachart_vaxisname").getValue(),m=0,m=(k=Ext.getCmp("areachart_label").getValue())?1:0,0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):(k=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetMultiBarChart",params:{sql:k,
haxis:b,vaxis:c,dbname:"operation",rights:p},callback:function(b,k,n){if(k){b=trim(n.responseText);if(0<=e.indexOf(",")){k=e.split(",");n=c.split(",");for(var p=0;p<=k.length-1;p++)b=b.replace(trim(n[p]),trim(k[p]))}else b=b.replace(c,e);renderCharts("areachartContainer",d,1,a,f,g,l,m,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))):Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Kb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singleareachart_accordingpanel",bbar:Ma,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u9762\u79ef\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singleareachart_panel",iconCls:"area_chart_edit",listeners:{expand:function(a){n=3;ra(g,8);Ext.getCmp("singleareachart_panel").remove(Ext.getCmp("singleareachart_form"));Ext.getCmp("singleareachart_panel").add(Ext.getCmp("singleareachart_form"));
Ext.getCmp("singleareachart_panel").doLayout()},afterRender:function(){n=3;ra(g,8);Ext.getCmp("singleareachart_panel").add(Ext.getCmp("singleareachart_form"));Ext.getCmp("singleareachart_panel").doLayout()}}},{title:"\u591a\u7ef4\u5ea6\u9762\u79ef\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multiareachart_panel",iconCls:"area_chart_edit",listeners:{expand:function(a){n=3.1;Ya(g,8);Ext.getCmp("multiareachart_panel").remove(Ext.getCmp("multiareachart_form"));Ext.getCmp("multiareachart_panel").add(Ext.getCmp("multiareachart_form"));
Ext.getCmp("multiareachart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'areachartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),hb=new Ext.Window({title:"\u9762\u79ef\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Kb]}),Na=new Ext.Toolbar({plain:!0,id:"piechart_tbar"});Na.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",
id:"piechart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"piechart_summit",handler:function(){if(4==n){var a=Ext.getCmp("singlepiechart_majortitle").getValue(),d=Ext.getCmp("singlepiechart_charttype").getValue();Ext.getCmp("singlepiechart_charttype").getRawValue();var b=Ext.getCmp("singlepiechart_haxis").getValue();Ext.getCmp("singlepiechart_haxis").getRawValue();var c=Ext.getCmp("singlepiechart_vaxis").getValue();Ext.getCmp("singlepiechart_vaxis").getRawValue();
var e=Ext.getCmp("singlepiechart_subtitle").getValue(),f=0,f=Ext.getCmp("piechart_label").getValue()?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6807\u7b7e/\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:y+"@"+z+"@"+v+"@"+w+"@"+A,haxis:b,vaxis:c,dbname:"operation",rights:p},callback:function(c,b,g){b?(c=trim(g.responseText),renderCharts("piechartContainer",d,2.1,a,e,"","",f,
c)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Lb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlepiechart_accordingpanel",bbar:Na,collapseMode:"mini",items:[{title:"\u5355\u7ef4\u5ea6\u997c\u56fe",
autoScroll:!0,border:!1,forceFit:!0,id:"singlepiechart_panel",iconCls:"pie_chart_edit",listeners:{expand:function(a){n=4;sa(g,8);Ext.getCmp("singlepiechart_panel").remove(Ext.getCmp("singlepiechart_form"));Ext.getCmp("singlepiechart_panel").add(Ext.getCmp("singlepiechart_form"));Ext.getCmp("singlepiechart_panel").doLayout()},afterRender:function(){n=4;sa(g,8);Ext.getCmp("singlepiechart_panel").add(Ext.getCmp("singlepiechart_form"));Ext.getCmp("singlepiechart_panel").doLayout()}}}]},{region:"center",
fill:!0,layout:"fit",html:"<div id = 'piechartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),eb=new Ext.Window({title:"\u997c\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Lb]}),Oa=new Ext.Toolbar({plain:!0,id:"scatterchart_tbar"});Oa.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u56de\u5f52\u7ebf",style:"margin-top:-8px;",id:"scatterchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",
tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"scatterchart_summit",handler:function(){if(5==n){var a=Ext.getCmp("singlescatterchart_majortitle").getValue(),d=Ext.getCmp("singlescatterchart_charttype").getValue();Ext.getCmp("singlescatterchart_charttype").getRawValue();var b=Ext.getCmp("singlescatterchart_label").getValue(),c=Ext.getCmp("singlescatterchart_haxis").getValue(),e=Ext.getCmp("singlescatterchart_haxis").getRawValue(),f=Ext.getCmp("singlescatterchart_vaxis").getValue(),g=Ext.getCmp("singlescatterchart_vaxis").getRawValue(),
l=Ext.getCmp("singlescatterchart_subtitle").getValue(),m=Ext.getCmp("singlescatterchart_haxisname").getValue(),k=Ext.getCmp("singlescatterchart_vaxisname").getValue(),q=0,q=Ext.getCmp("scatterchart_label").getValue()?1:0;0==trim(d).length||0==trim(c).length||0==trim(f).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/XY\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetScatterChart",params:{sql:y+"@"+z+"@"+v+"@"+w+"@"+A,label:b,haxis:c,vaxis:f,showregression:q,dbname:"operation",
rights:p},callback:function(b,n,p){n?(b=trim(p.responseText),b=replaceAll(b,f,g),b=replaceAll(b,c,e),renderCharts("scatterchartContainer",d,3,a,l,m,k,0,b)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Mb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,
fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlescatterchart_accordingpanel",bbar:Oa,collapseMode:"mini",items:[{title:"\u6563\u70b9\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlescatterchart_panel",iconCls:"scatter_chart_edit",listeners:{expand:function(a){n=5;ta(g,8);Ext.getCmp("singlescatterchart_panel").remove(Ext.getCmp("singlescatterchart_form"));Ext.getCmp("singlescatterchart_panel").add(Ext.getCmp("singlescatterchart_form"));Ext.getCmp("singlescatterchart_panel").doLayout()},
afterRender:function(){n=5;ta(g,8);Ext.getCmp("singlescatterchart_panel").add(Ext.getCmp("singlescatterchart_form"));Ext.getCmp("singlescatterchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'scatterchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),ib=new Ext.Window({title:"\u6563\u70b9\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Mb]}),Pa=
new Ext.Toolbar({plain:!0,id:"doughnutchart_tbar"});Pa.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"doughnutchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"doughnutchart_summit",handler:function(){if(6==n){var a=Ext.getCmp("singledoughnutchart_majortitle").getValue(),d=Ext.getCmp("singledoughnutchart_charttype").getValue();Ext.getCmp("singledoughnutchart_charttype").getRawValue();var b=
Ext.getCmp("singledoughnutchart_haxis").getValue();Ext.getCmp("singledoughnutchart_haxis").getRawValue();var c=Ext.getCmp("singledoughnutchart_vaxis").getValue();Ext.getCmp("singledoughnutchart_vaxis").getRawValue();var e=Ext.getCmp("singledoughnutchart_subtitle").getValue(),f=0,f=Ext.getCmp("doughnutchart_label").getValue()?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6807\u7b7e/\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):
Ext.Ajax.request({url:"GetSingleBarChart",params:{sql:y+"@"+z+"@"+v+"@"+w+"@"+A,haxis:b,vaxis:c,dbname:"operation",rights:p},callback:function(b,c,g){c?(b=trim(g.responseText),renderCharts("doughnutchartContainer",d,2.1,a,e,"","",f,b)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Nb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singledoughnutchart_accordingpanel",bbar:Pa,collapseMode:"mini",items:[{title:"\u5706\u73af\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singledoughnutchart_panel",iconCls:"round_chart_edit",listeners:{expand:function(a){n=6;ua(g,8);Ext.getCmp("singledoughnutchart_panel").remove(Ext.getCmp("singledoughnutchart_form"));Ext.getCmp("singledoughnutchart_panel").add(Ext.getCmp("singledoughnutchart_form"));
Ext.getCmp("singledoughnutchart_panel").doLayout()},afterRender:function(){n=6;ua(g,8);Ext.getCmp("singledoughnutchart_panel").add(Ext.getCmp("singledoughnutchart_form"));Ext.getCmp("singledoughnutchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'doughnutchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),lb=new Ext.Window({title:"\u5706\u73af\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},
fill:!0,layout:"fit",items:[Nb]}),Qa=new Ext.Toolbar({plain:!0,id:"bubblechart_tbar"});Qa.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u8c61\u9650",style:"margin-top:-8px;",id:"bubblechart_quadrant",checked:!1},"-",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"bubblechart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"bubblechart_summit",handler:function(){if(7==n){var a=Ext.getCmp("singlebubblechart_majortitle").getValue(),
d=Ext.getCmp("singlebubblechart_charttype").getValue();Ext.getCmp("singlebubblechart_charttype").getRawValue();var b=Ext.getCmp("singlebubblechart_label").getValue(),c=Ext.getCmp("singlebubblechart_haxis").getValue(),e=Ext.getCmp("singlebubblechart_haxis").getRawValue(),f=Ext.getCmp("singlebubblechart_vaxis").getValue(),g=Ext.getCmp("singlebubblechart_vaxis").getRawValue(),l=Ext.getCmp("singlebubblechart_zaxis").getValue();Ext.getCmp("singlebubblechart_zaxis").getRawValue();var m=Ext.getCmp("singlebubblechart_subtitle").getValue(),
k=Ext.getCmp("singlebubblechart_haxisname").getValue(),q=Ext.getCmp("singlebubblechart_vaxisname").getValue(),t=0,r=Ext.getCmp("bubblechart_label").getValue(),t=r?1:0,u=0,u=(r=Ext.getCmp("bubblechart_quadrant").getValue())?1:0;0==trim(d).length||0==trim(c).length||0==trim(f).length||0==trim(l).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/XYZ\u6307\u6807\u9879\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetBubbleChart",params:{sql:y+"@"+z+"@"+v+"@"+w+"@"+A,label:b,haxis:c,vaxis:f,
zaxis:l,dbname:"operation",rights:p},callback:function(b,l,n){l?(b=trim(n.responseText),b=replaceAll(b,f,g),b=replaceAll(b,c,e),t=t.toString()+"@"+u.toString(),renderCharts("bubblechartContainer",d,4,a,m,k,q,t,b)):Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});var Ob=new Ext.Panel({layout:"border",
border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlebubblechart_accordingpanel",bbar:Qa,collapseMode:"mini",items:[{title:"\u6c14\u6ce1\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"singlebubblechart_panel",iconCls:"bubble_chart_edit",listeners:{expand:function(a){n=7;va(g,8);Ext.getCmp("singlebubblechart_panel").remove(Ext.getCmp("singlebubblechart_form"));Ext.getCmp("singlebubblechart_panel").add(Ext.getCmp("singlebubblechart_form"));
Ext.getCmp("singlebubblechart_panel").doLayout()},afterRender:function(){n=7;va(g,8);Ext.getCmp("singlebubblechart_panel").add(Ext.getCmp("singlebubblechart_form"));Ext.getCmp("singlebubblechart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'bubblechartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),kb=new Ext.Window({title:"\u6c14\u6ce1\u56fe",width:750,height:420,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plain:!0,defaults:{border:!1},
fill:!0,layout:"fit",items:[Ob]}),Ra=new Ext.Toolbar({plain:!0,id:"radarchart_tbar"});Ra.add("->",{xtype:"checkbox",boxLabel:"\u663e\u793a\u503c",style:"margin-top:-8px;",id:"radarchart_label",checked:!1},"-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"radarchart_summit",handler:function(){if(8==n){var a=Ext.getCmp("multiradarchart_majortitle").getValue(),d=Ext.getCmp("multiradarchart_charttype").getValue();Ext.getCmp("multiradarchart_charttype").getRawValue();
var b=Ext.getCmp("multiradarchart_haxis").getValue();Ext.getCmp("multiradarchart_haxis").getRawValue();var c=Ext.getCmp("multiradarchart_vaxis").getValue(),e=Ext.getCmp("multiradarchart_vaxis").getRawValue(),f=Ext.getCmp("multiradarchart_subtitle").getValue(),g=0,g=Ext.getCmp("radarchart_label").getValue()?1:0;0==trim(d).length||0==trim(b).length||0==trim(c).length?Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):Ext.Ajax.request({url:"GetMultiBarChart",
params:{sql:y+"@"+z+"@"+v+"@"+w+"@"+A,haxis:b,vaxis:c,dbname:"operation",rights:p},callback:function(b,m,k){if(m){b=trim(k.responseText);if(0<=e.indexOf(",")){m=e.split(",");k=c.split(",");for(var n=0;n<=m.length-1;n++)b=b.replace(trim(k[n]),trim(m[n]))}else b=b.replace(c,e);renderCharts("radarchartContainer",d,5,a,f,"","",g,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Pb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:215,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singleradarchart_accordingpanel",bbar:Ra,collapseMode:"mini",items:[{title:"\u96f7\u8fbe\u56fe",autoScroll:!0,border:!1,forceFit:!0,id:"multiradarchart_panel",iconCls:"radar_chart_edit",listeners:{expand:function(a){n=8;wa(g,8);Ext.getCmp("multiradarchart_panel").remove(Ext.getCmp("multiradarchart_form"));Ext.getCmp("multiradarchart_panel").add(Ext.getCmp("multiradarchart_form"));
Ext.getCmp("multiradarchart_panel").doLayout()},afterRender:function(){n=8;wa(g,8);Ext.getCmp("multiradarchart_panel").add(Ext.getCmp("multiradarchart_form"));Ext.getCmp("multiradarchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'radarchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),jb=new Ext.Window({title:"\u96f7\u8fbe\u56fe",width:750,height:400,resizable:!0,maximizable:!0,closeAction:"hide",modal:!1,plugins:new Ext.ux.WindowAlwaysOnTop,
plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Pb]}),Sa=new Ext.Toolbar({plain:!0,id:"combinedchart_tbar"});Sa.add("->","-",{text:"\u751f\u6210\u56fe\u8868",tooltip:"\u751f\u6210\u56fe\u8868",iconCls:"chartshow",id:"combinedchart_summit",handler:function(){if(9==n){var a=Ext.getCmp("singlecombinedchart_majortitle").getValue(),d=Ext.getCmp("singlecombinedchart_charttype").getValue();Ext.getCmp("singlecombinedchart_charttype").getRawValue();var b=Ext.getCmp("singlecombinedchart_haxis").getValue();
Ext.getCmp("singlecombinedchart_haxis").getRawValue();var c=Ext.getCmp("singlecombinedchart_vaxis").getValue(),e=Ext.getCmp("singlecombinedchart_vaxis").getRawValue(),f=Ext.getCmp("singlecombinedchart_vtyle").getValue(),g=Ext.getCmp("singlecombinedchart_showlabel").getValue(),l=Ext.getCmp("singlecombinedchart_subtitle").getValue(),m=Ext.getCmp("singlecombinedchart_haxisname").getValue(),k=Ext.getCmp("singlecombinedchart_vaxisname").getValue(),q=0;if(0==trim(d).length||0==trim(b).length||0==trim(c).length)Ext.Msg.alert("\u9519\u8bef",
"\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!");else if(1==T)Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!");else{var t=y+"@"+z+"@"+v+"@"+w+"@"+A;Ext.Ajax.request({url:"GetSingleCombinedChart",params:{sql:t,haxis:b,vaxis:c,vcharttype:f,showvalue:g,dbname:"operation",rights:p},callback:function(b,f,g){if(f){b=trim(g.responseText);if(0<=e.indexOf(",")){f=e.split(",");g=c.split(",");for(var h=0;h<=f.length-
1;h++)b=b.replace(trim(g[h]),trim(f[h]))}else b=b.replace(c,e);renderCharts("combinedchartContainer",d,6,a,l,m,k,q,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}})}}else if(9.1==n){a=Ext.getCmp("multicombinedchart_majortitle").getValue();d=Ext.getCmp("multicombinedchart_charttype").getValue();Ext.getCmp("multicombinedchart_charttype").getRawValue();b=Ext.getCmp("multicombinedchart_haxis").getValue();Ext.getCmp("multicombinedchart_haxis").getRawValue();
var c=Ext.getCmp("multicombinedchart_vaxis").getValue(),e=Ext.getCmp("multicombinedchart_vaxis").getRawValue(),f=Ext.getCmp("multicombinedchart_vtyle").getValue(),g=Ext.getCmp("multicombinedchart_showlabel").getValue(),l=Ext.getCmp("multicombinedchart_subtitle").getValue(),m=Ext.getCmp("multicombinedchart_haxisname").getValue(),k=Ext.getCmp("multicombinedchart_vaxisname").getValue(),r=Ext.getCmp("multicombinedchart_secondaxis").getValue(),q=0;0==trim(d).length||0==trim(b).length||0==trim(c).length?
Ext.Msg.alert("\u9519\u8bef","\u56fe\u8868\u7c7b\u578b/\u6a2a\u8f74/\u7eb5\u8f74\u4e0d\u80fd\u4e3a\u7a7a!"):1==multi_index?Ext.Msg.alert("\u9519\u8bef","\u540c\u4e00\u4e2a\u6307\u6807\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u56fe\u8868!"):0==r.length?Ext.Msg.alert("\u9519\u8bef","\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u6b21\u8f74!"):Ext.getCmp("multicombinedchart_vaxis").getValue()==r?Ext.Msg.alert("\u9519\u8bef","\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u4e3b\u8f74!"):(t=y+"@"+z+"@"+v+"@"+w+"@"+A,Ext.Ajax.request({url:"GetMultiCombinedChart",
params:{sql:t,haxis:b,vaxis:c,vcharttype:f,showvalue:g,secondaxisvalue:r,dbname:"operation",rights:p},callback:function(b,f,g){if(f){b=trim(g.responseText);if(0<=e.indexOf(",")){f=e.split(",");g=c.split(",");for(var h=0;h<=f.length-1;h++)b=b.replace(trim(g[h]),trim(f[h]))}else b=b.replace(c,e);renderCharts("combinedchartContainer",d,6,a,l,m,k,q,b)}else Ext.MessageBox.alert("\u9519\u8bef","\u6570\u636e\u6709\u9519\u8bef,\u8bf7\u91cd\u65b0\u9009\u62e9!")}}))}else Ext.Msg.alert("\u63d0\u793a","\u8bf7\u91cd\u65b0\u5c55\u5f00\u4e0a\u9762<img src = '../EXT/extjs3.3.1/images/according_expand.png'/>\u6298\u53e0\u6309\u94ae!")}});
var Qb=new Ext.Panel({layout:"border",border:!1,items:[{region:"west",width:235,fill:!0,layout:"accordion",split:!0,layoutConfig:{animate:!0},id:"singlecombinedchart_accordingpanel",bbar:Sa,collapseMode:"mini",items:[{title:"\u7ed3\u5408\u56fe(\u53ea\u542b\u4e3b\u8f74)",autoScroll:!0,border:!1,forceFit:!0,id:"singlecombinedchart_panel",iconCls:"combined_chart_edit",listeners:{expand:function(a){n=9;xa(g,8);Ext.getCmp("singlecombinedchart_panel").remove(Ext.getCmp("singlecombinedchart_form"));Ext.getCmp("singlecombinedchart_panel").add(Ext.getCmp("singlecombinedchart_form"));
Ext.getCmp("singlecombinedchart_panel").doLayout()},afterRender:function(){n=9;xa(g,8);Ext.getCmp("singlecombinedchart_panel").add(Ext.getCmp("singlecombinedchart_form"));Ext.getCmp("singlecombinedchart_panel").doLayout()}}},{title:"\u7ed3\u5408\u56fe(\u542b\u4e3b\u6b21\u8f74)",autoScroll:!0,border:!1,forceFit:!0,id:"multicombinedchart_panel",iconCls:"combined_chart_edit",listeners:{expand:function(a){n=9.1;Za(g,8);Ext.getCmp("multicombinedchart_panel").remove(Ext.getCmp("multicombinedchart_form"));
Ext.getCmp("multicombinedchart_panel").add(Ext.getCmp("multicombinedchart_form"));Ext.getCmp("multicombinedchart_panel").doLayout()}}}]},{region:"center",fill:!0,layout:"fit",html:"<div id = 'combinedchartContainer' style='height:100%;width:100%;padding-right:5px'></div>"}]}),fb=new Ext.Window({title:"\u7ed3\u5408\u56fe",width:770,height:470,resizable:!0,maximizable:!0,closeAction:"hide",modal:!0,plain:!0,defaults:{border:!1},fill:!0,layout:"fit",items:[Qb]}),Rb=new Ext.menu.Menu({id:"rightMenu",
items:[{text:"\u5355\u5143\u683c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"cellcopy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",handler:function(){la(g,"copybutton")}},"-",{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236\u5185\u5bb9",iconCls:"copy",tooltip:"\u70b9\u51fb\u4e4b\u540e\uff0c\u70b9\u51fb\u529f\u80fd\u680f\u4e0a\u7684\u590d\u5236\u6309\u94ae\u8fdb\u884c\u5165\u804c",handler:function(){ma(g,"copybutton")}},
{text:"\u6574\u884c\u52a0\u8f7d\u590d\u5236(\u5305\u62ec\u8868\u5934)\u5185\u5bb9",iconCls:"copy_header",handler:function(){na(g,"copybutton")}}]});g.addListener("rowcontextmenu",function(a,d,b){b.preventDefault();Rb.showAt(b.getXY())});g.addListener("cellcontextmenu",function(a,d,b,c){columnindex=b});Ext.Ajax.on("requestcomplete",function(a,d,b){"timeOut"==d.getResponseHeader("sessionstatus")&&(d.getResponseHeader("loginPath")?Ext.Msg.alert("\u63d0\u793a","\u4f1a\u8bdd\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u9646!"):
Ext.Msg.alert("\u63d0\u793a","\u8bf7\u6c42\u8d85\u65f6\u8bf7\u91cd\u65b0\u767b\u9646 !"),window.top.location.href=d.getResponseHeader("loginPath"))},this);Ext.getCmp("copybutton").on("click",function(){0==t?Ext.MessageBox.alert("\u63d0\u793a","\u8bf7\u5148\u53f3\u952e\u52a0\u8f7d\u6570\u636e"):Ext.MessageBox.alert("\u63d0\u793a","\u5df2\u7ecf\u590d\u5236\u5230\u526a\u8d34\u677f",function(a){"ok"==a&&(Ext.Ajax.request({url:"SaveCopyActions",params:{rights:p,copybutton:1,copyedrows:t},callback:function(a,
b,c){}}),t=0)})});Ext.getCmp("summary_copybutton").on("click",function(){0==t?Ext.MessageBox.alert("\u63d0\u793a","\u8bf7\u5148\u53f3\u952e\u52a0\u8f7d\u6570\u636e"):Ext.MessageBox.alert("\u63d0\u793a","\u5df2\u7ecf\u590d\u5236\u5230\u526a\u8d34\u677f",function(a){"ok"==a&&(Ext.Ajax.request({url:"SaveCopyActions",params:{rights:p,copybutton:2,copyedrows:t},callback:function(a,b,c){}}),t=0)})});N.add("-","<span id = loginMTime></span>");var ka=0;(new Ext.util.TaskRunner).start({run:function(){ka+=
1;document.getElementById("loginMTime").innerHTML="<b>\u5df2\u767b\u5f55\uff08\u79d2\uff09</b>\uff1a"+ka},interval:1E3})});